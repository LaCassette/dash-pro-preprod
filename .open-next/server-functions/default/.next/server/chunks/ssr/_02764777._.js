module.exports=[405050,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={callServer:function(){return f.callServer},createServerReference:function(){return h.createServerReference},findSourceMapURL:function(){return g.findSourceMapURL}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(120611),g=a.r(1722),h=a.r(738783)},497433,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(278165),e=a.i(856696),f=a.i(413902),g=a.i(415925),h=a.i(703130),i=a.i(340695),j=a.i(205522),k=a.i(917171),l=a.i(807706),m=a.i(514727),n=a.i(621958),o=a.i(277687),p=a.i(596221),q=a.i(114548),r=a.i(546842),s=a.i(835181),t=a.i(564485),u=a.i(170106);let v=(0,u.default)("globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);var w=a.i(65341),x=a.i(470880);let y=(0,u.default)("monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);var z=a.i(58213),A=a.i(695245),B=a.i(159501),C=a.i(954714),D=a.i(595129),E=a.i(238246),F=a.i(32886),G=a.i(676504),H=a.i(405050),I=(0,H.createServerReference)("4091a86e4e012d07af9acf14f9e177bd1d84aae7dd",H.callServer,void 0,H.findSourceMapURL,"setLocale"),J=a.i(900969);function K(){let a=(0,F.useLocale)(),[d,e]=(0,c.useTransition)();return(0,b.jsxs)(G.DropdownMenu,{children:[(0,b.jsx)(G.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)(i.Button,{variant:"ghost",size:"sm",disabled:d,children:[(0,b.jsx)(v,{className:"h-4 w-4 mr-2"}),(0,b.jsx)("span",{className:"mr-1",children:J.localeFlags[a]}),(0,b.jsx)("span",{className:"hidden sm:inline",children:J.localeNames[a]})]})}),(0,b.jsx)(G.DropdownMenuContent,{align:"end",children:J.locales.map(c=>(0,b.jsxs)(G.DropdownMenuItem,{onClick:()=>{e(async()=>{await I(c),window.location.reload()})},className:a===c?"bg-accent":"",children:[(0,b.jsx)("span",{className:"mr-2",children:J.localeFlags[c]}),J.localeNames[c]]},c))})]})}let L=C.object({name:C.string().min(1,"Le nom est requis").max(100,"Le nom est trop long"),email:C.string().email("Email invalide")});function M(){let{user:a,loading:u}=(0,d.useUser)(),{getAccentColor:C}=(0,e.useOrganization)(),{theme:F,setTheme:G}=(0,f.useTheme)(),{toast:H}=(0,o.useToast)(),[I,J]=(0,c.useState)(!1),[M,N]=(0,c.useState)(!1),[O,P]=(0,c.useState)(!1),[Q,R]=(0,c.useState)(!1),S=(0,g.useTranslations)("profile"),T=(0,g.useTranslations)("common"),U=(0,g.useTranslations)("roles");(0,c.useEffect)(()=>{R(!0)},[]);let V=C("dark"===F),W=(0,A.useForm)({resolver:(0,B.zodResolver)(L),defaultValues:{name:a?.name||"",email:a?.email||""}});async function X(b){if(a){J(!0);try{let a=await fetch("/api/auth/user",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)});if(!a.ok){let b=await a.json();throw Error(b.error||"Erreur lors de la mise Ã  jour")}H({title:"SuccÃ¨s",description:"Profil mis Ã  jour avec succÃ¨s"}),N(!0),window.location.reload()}catch(a){console.error("Error updating profile:",a),H({title:"Erreur",description:a instanceof Error?a.message:"Impossible de mettre Ã  jour le profil",variant:"destructive"})}finally{J(!1),N(!1)}}}async function Y(){if(a){P(!0);try{let a=await fetch("/api/auth/setup-role",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({role:"PRO"})});if(!a.ok){let b=await a.json();throw Error(b.error||"Impossible de mettre Ã  jour votre rÃ´le")}H({title:"Demande envoyÃ©e",description:"Votre compte passe en mode PRO (en attente). Activez votre abonnement pour dÃ©bloquer toutes les fonctionnalitÃ©s."}),window.location.reload()}catch(a){console.error("Error becoming pro:",a),H({title:"Erreur",description:a instanceof Error?a.message:"Impossible de devenir PRO",variant:"destructive"})}finally{P(!1)}}}return((0,c.useEffect)(()=>{a&&W.reset({name:a.name||"",email:a.email||""})},[a,W]),u||M)?(0,b.jsx)("div",{className:"container mx-auto p-6",children:(0,b.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,b.jsx)(p.Loader2,{className:"h-8 w-8 animate-spin"})})}):a?(0,b.jsxs)("div",{className:"container mx-auto p-6",children:[(0,b.jsx)("div",{className:"flex items-center gap-2 mb-6",children:(0,b.jsx)(m.SidebarTrigger,{})}),(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",style:V?{color:V}:void 0,children:S("title")}),(0,b.jsx)("p",{className:"text-muted-foreground",children:S("personalInfo")})]}),(0,b.jsxs)(n.Tabs,{defaultValue:"personal",className:"w-full",children:[(0,b.jsxs)(n.TabsList,{className:"grid w-full grid-cols-5",children:[(0,b.jsxs)(n.TabsTrigger,{value:"personal",children:[(0,b.jsx)(r.User,{className:"mr-2 h-4 w-4"}),S("personalInfo")]}),(0,b.jsxs)(n.TabsTrigger,{value:"sport",children:[(0,b.jsx)(s.Dumbbell,{className:"mr-2 h-4 w-4"}),S("sportProfile")]}),(0,b.jsxs)(n.TabsTrigger,{value:"nutrition",children:[(0,b.jsx)(t.Apple,{className:"mr-2 h-4 w-4"}),S("nutritionProfile")]}),(0,b.jsxs)(n.TabsTrigger,{value:"medical",children:["ðŸ¥ ",S("medicalProfile")]}),(0,b.jsxs)(n.TabsTrigger,{value:"lifestyle",children:["ðŸ§˜ ",S("lifestyleProfile")]})]}),(0,b.jsx)(n.TabsContent,{value:"personal",className:"space-y-6",children:(0,b.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,b.jsxs)(h.Card,{children:[(0,b.jsxs)(h.CardHeader,{children:[(0,b.jsx)(h.CardTitle,{children:S("personalInfo")}),(0,b.jsx)(h.CardDescription,{children:S("accountDetails")})]}),(0,b.jsx)(h.CardContent,{children:(0,b.jsx)(z.Form,{...W,children:(0,b.jsxs)("form",{onSubmit:W.handleSubmit(X),className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex flex-col items-center gap-4 mb-6",children:[(0,b.jsxs)(l.Avatar,{className:"h-24 w-24",children:[(0,b.jsx)(l.AvatarImage,{src:a.picture||void 0}),(0,b.jsx)(l.AvatarFallback,{className:"text-2xl",children:a.name?.charAt(0).toUpperCase()||a.email.charAt(0).toUpperCase()})]}),(0,b.jsx)("div",{className:"text-center",children:(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:S("photoManagedByAuth")})})]}),(0,b.jsx)(z.FormField,{control:W.control,name:"name",render:({field:a})=>(0,b.jsxs)(z.FormItem,{children:[(0,b.jsx)(z.FormLabel,{children:S("fullName")}),(0,b.jsx)(z.FormControl,{children:(0,b.jsx)(j.Input,{...a,placeholder:S("name")})}),(0,b.jsx)(z.FormMessage,{})]})}),(0,b.jsx)(z.FormField,{control:W.control,name:"email",render:({field:a})=>(0,b.jsxs)(z.FormItem,{children:[(0,b.jsx)(z.FormLabel,{children:S("email")}),(0,b.jsx)(z.FormControl,{children:(0,b.jsx)(j.Input,{type:"email",...a,placeholder:"your@email.com",disabled:!0})}),(0,b.jsx)(z.FormMessage,{}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:S("emailManagedByAuth")})]})}),(0,b.jsx)(i.Button,{type:"submit",disabled:I,className:"w-full",style:V?{backgroundColor:V,color:"white"}:void 0,children:I?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(p.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),S("saving")]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(q.Save,{className:"mr-2 h-4 w-4"}),S("saveChanges")]})})]})})})]}),(0,b.jsxs)(h.Card,{children:[(0,b.jsxs)(h.CardHeader,{children:[(0,b.jsx)(h.CardTitle,{children:S("accountInfo")}),(0,b.jsx)(h.CardDescription,{children:S("accountDetails")})]}),(0,b.jsxs)(h.CardContent,{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(v,{className:"h-4 w-4 text-muted-foreground"}),(0,b.jsx)(k.Label,{className:"text-sm font-medium",children:S("language")})]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mb-2",children:S("languageDescription")}),(0,b.jsx)(K,{})]}),(0,b.jsxs)("div",{className:"pt-4 border-t",children:[(0,b.jsx)("h4",{className:"text-sm font-semibold mb-4",children:S("personalization")}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(k.Label,{className:"text-sm text-muted-foreground",children:S("theme")}),(0,b.jsx)("div",{className:"flex gap-2",children:Q&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(i.Button,{variant:"light"===F?"default":"outline",size:"sm",onClick:()=>G("light"),className:"flex-1",children:[(0,b.jsx)(w.Sun,{className:"mr-2 h-4 w-4"}),S("light")]}),(0,b.jsxs)(i.Button,{variant:"dark"===F?"default":"outline",size:"sm",onClick:()=>G("dark"),className:"flex-1",children:[(0,b.jsx)(x.Moon,{className:"mr-2 h-4 w-4"}),S("dark")]}),(0,b.jsxs)(i.Button,{variant:"system"===F?"default":"outline",size:"sm",onClick:()=>G("system"),className:"flex-1",children:[(0,b.jsx)(y,{className:"mr-2 h-4 w-4"}),S("system")]})]})})]})]}),(0,b.jsxs)("div",{className:"pt-4 border-t",children:[(0,b.jsx)(k.Label,{className:"text-sm text-muted-foreground",children:"User"===U("user")?"Role":"RÃ´le"}),(0,b.jsx)("div",{className:"mt-1",children:(0,b.jsx)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium",style:V?{backgroundColor:`${V}15`,color:V}:void 0,children:a.role})})]}),"PRO"===a.role&&(0,b.jsxs)("div",{children:[(0,b.jsx)(k.Label,{className:"text-sm text-muted-foreground",children:S("proStatus")}),(0,b.jsx)("p",{className:"mt-1 text-sm font-medium",children:a.proStatus||"â€”"}),"PENDING"===a.proStatus&&(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:S("pendingProStatus")})]}),"USER"===a.role&&(0,b.jsxs)("div",{className:"rounded-lg border border-dashed border-primary/30 bg-primary/5 p-4 space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"text-sm font-semibold",children:S("becomePro")}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:S("becomeProDescription")})]}),(0,b.jsx)(i.Button,{onClick:Y,disabled:O,className:"w-full",children:O?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(p.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),T("loading")]}):S("becomePro")})]}),"PRO"===a.role&&"PENDING"===a.proStatus&&(0,b.jsxs)("div",{className:"rounded-lg border border-yellow-500/30 bg-yellow-500/10 p-4 space-y-3",children:[(0,b.jsx)("p",{className:"text-sm text-yellow-900 dark:text-yellow-200",children:S("pendingProStatus")}),(0,b.jsx)(i.Button,{variant:"outline",asChild:!0,size:"sm",className:"w-full",children:(0,b.jsx)(E.default,{href:"/dashboard/subscription",children:S("goToSubscription")})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(k.Label,{className:"text-sm text-muted-foreground",children:S("userId")}),(0,b.jsx)("p",{className:"mt-1 text-sm font-mono text-muted-foreground",children:a.id})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(k.Label,{className:"text-sm text-muted-foreground",children:"User"===U("user")?"Organizations":"Organisations"}),(0,b.jsxs)("p",{className:"mt-1 text-sm text-muted-foreground",children:[a.organizationMemberships?.length||0," ",S("organizationsCount")]})]})]})]})]})}),(0,b.jsx)(n.TabsContent,{value:"sport",children:(0,b.jsxs)(h.Card,{children:[(0,b.jsxs)(h.CardHeader,{children:[(0,b.jsx)(h.CardTitle,{children:S("sportProfile")}),(0,b.jsx)(h.CardDescription,{children:S("sportProfileDescription")||"Manage your sport and training information"})]}),(0,b.jsx)(h.CardContent,{className:"p-0",children:(0,b.jsx)(D.UserProfileForm,{open:!0,onOpenChange:()=>{},userId:a.id,type:"SPORT",embedded:!0,onSuccess:()=>{H({title:T("success"),description:S("sportProfileSuccess")||"Sport profile updated successfully"})}})})]})}),(0,b.jsx)(n.TabsContent,{value:"nutrition",children:(0,b.jsxs)(h.Card,{children:[(0,b.jsxs)(h.CardHeader,{children:[(0,b.jsx)(h.CardTitle,{children:S("nutritionProfile")}),(0,b.jsx)(h.CardDescription,{children:S("nutritionProfileDescription")||"Manage your nutrition information"})]}),(0,b.jsx)(h.CardContent,{className:"p-0",children:(0,b.jsx)(D.UserProfileForm,{open:!0,onOpenChange:()=>{},userId:a.id,type:"NUTRITION",embedded:!0,onSuccess:()=>{H({title:T("success"),description:S("nutritionProfileSuccess")||"Nutrition profile updated successfully"})}})})]})}),(0,b.jsx)(n.TabsContent,{value:"medical",children:(0,b.jsxs)(h.Card,{children:[(0,b.jsxs)(h.CardHeader,{children:[(0,b.jsx)(h.CardTitle,{children:S("medicalProfile")}),(0,b.jsx)(h.CardDescription,{children:S("medicalProfileDescription")||"Manage your medical information (encrypted data)"})]}),(0,b.jsx)(h.CardContent,{className:"p-0",children:(0,b.jsx)(D.UserProfileForm,{open:!0,onOpenChange:()=>{},userId:a.id,type:"MEDICAL",embedded:!0,onSuccess:()=>{H({title:T("success"),description:S("medicalProfileSuccess")||"Medical profile updated successfully"})}})})]})}),(0,b.jsx)(n.TabsContent,{value:"lifestyle",children:(0,b.jsxs)(h.Card,{children:[(0,b.jsxs)(h.CardHeader,{children:[(0,b.jsx)(h.CardTitle,{children:S("lifestyleProfile")}),(0,b.jsx)(h.CardDescription,{children:S("lifestyleProfileDescription")||"Manage your lifestyle information"})]}),(0,b.jsx)(h.CardContent,{className:"p-0",children:(0,b.jsx)(D.UserProfileForm,{open:!0,onOpenChange:()=>{},userId:a.id,type:"LIFESTYLE",embedded:!0,onSuccess:()=>{H({title:T("success"),description:S("lifestyleProfileSuccess")||"Lifestyle profile updated successfully"})}})})]})})]})]}):null}a.s(["default",()=>M],497433)}];

//# sourceMappingURL=_02764777._.js.map