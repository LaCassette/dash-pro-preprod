module.exports=[965733,a=>{"use strict";var b=a.i(187924),c=a.i(897942),d=a.i(422262),e=a.i(497895);function f({...a}){return(0,b.jsx)(c.Root,{"data-slot":"dialog",...a})}function g({...a}){return(0,b.jsx)(c.Trigger,{"data-slot":"dialog-trigger",...a})}function h({...a}){return(0,b.jsx)(c.Portal,{"data-slot":"dialog-portal",...a})}function i({className:a,...d}){return(0,b.jsx)(c.Overlay,{"data-slot":"dialog-overlay",className:(0,e.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",a),...d})}function j({className:a,children:f,showCloseButton:g=!0,...j}){return(0,b.jsxs)(h,{"data-slot":"dialog-portal",children:[(0,b.jsx)(i,{}),(0,b.jsxs)(c.Content,{"data-slot":"dialog-content",className:(0,e.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",a),...j,children:[f,g&&(0,b.jsxs)(c.Close,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,b.jsx)(d.XIcon,{}),(0,b.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function k({className:a,...c}){return(0,b.jsx)("div",{"data-slot":"dialog-header",className:(0,e.cn)("flex flex-col gap-2 text-center sm:text-left",a),...c})}function l({className:a,...c}){return(0,b.jsx)("div",{"data-slot":"dialog-footer",className:(0,e.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",a),...c})}function m({className:a,...d}){return(0,b.jsx)(c.Title,{"data-slot":"dialog-title",className:(0,e.cn)("text-lg leading-none font-semibold",a),...d})}function n({className:a,...d}){return(0,b.jsx)(c.Description,{"data-slot":"dialog-description",className:(0,e.cn)("text-muted-foreground text-sm",a),...d})}a.s(["Dialog",()=>f,"DialogContent",()=>j,"DialogDescription",()=>n,"DialogFooter",()=>l,"DialogHeader",()=>k,"DialogTitle",()=>m,"DialogTrigger",()=>g])},587532,a=>{"use strict";let b=(0,a.i(170106).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);a.s(["Search",()=>b],587532)},533441,a=>{"use strict";var b=a.i(234157);a.s(["Check",()=>b.default])},992258,a=>{"use strict";let b=(0,a.i(170106).default)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]);a.s(["Mail",()=>b],992258)},717371,a=>{"use strict";let b=(0,a.i(170106).default)("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);a.s(["UserPlus",()=>b],717371)},98687,a=>{"use strict";function b(a){return!function(a){if(!a||"string"!=typeof a||!a.startsWith("data:image/"))return!1;let b=a.indexOf(",");if(-1===b)return!1;let c=a.substring(b+1);if(0===c.length)return!1;try{c.length>0&&atob(c.substring(0,Math.min(100,c.length)))}catch(a){return!1}return!0}(a)?null:a}a.s(["getValidImageUrl",()=>b])},834392,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(278165),e=a.i(703130),f=a.i(340695),g=a.i(254161),h=a.i(965733),i=a.i(277687),j=a.i(267900),k=a.i(992258),l=a.i(717371),m=a.i(533441),n=a.i(587532),o=a.i(205522),p=a.i(98687);function q(){let{user:a}=(0,d.useUser)(),[q,r]=(0,c.useState)([]),[s,t]=(0,c.useState)([]),[u,v]=(0,c.useState)([]),[w,x]=(0,c.useState)(!0),[y,z]=(0,c.useState)(""),[A,B]=(0,c.useState)(null),{toast:C}=(0,i.useToast)();async function D(){try{let[a,b,c]=await Promise.all([fetch("/api/organizations/public"),fetch("/api/invitations"),fetch("/api/requests")]);if(a.ok){let b=await a.json();r(b)}if(b.ok){let a=await b.json();t(a)}if(c.ok){let a=await c.json();v(a)}}catch(a){C({title:"Erreur",description:"Impossible de charger les données",variant:"destructive"})}finally{x(!1)}}async function E(a,b){try{let c=await fetch(`/api/organizations/${a}/invitations/${b}`,{method:"POST"});if(!c.ok){let a=await c.json();throw Error(a.error||"Failed to accept")}C({title:"Succès",description:"Invitation acceptée avec succès"}),D()}catch(a){C({title:"Erreur",description:a instanceof Error?a.message:"Impossible d'accepter l'invitation",variant:"destructive"})}}async function F(a){try{let b=await fetch(`/api/organizations/${a}/request`,{method:"POST"});if(!b.ok){let a=await b.json();throw Error(a.error||"Failed to request")}C({title:"Succès",description:"Demande envoyée avec succès"}),B(null),D()}catch(a){C({title:"Erreur",description:a instanceof Error?a.message:"Impossible d'envoyer la demande",variant:"destructive"})}}(0,c.useEffect)(()=>{a?.role==="USER"&&D()},[a]);let G=(0,c.useMemo)(()=>a?q.filter(b=>b.owner.id===a.id||b.members.some(b=>b.user?.id?b.user.id===a.id:!!b.userId&&b.userId===a.id)):[],[q,a]),H=(0,c.useMemo)(()=>a?s.filter(b=>"PENDING"===b.status&&(b.email===a.email||b.user?.id===a.id)):[],[s,a]),I=(0,c.useMemo)(()=>a?u.filter(a=>"PENDING"===a.status):[],[u,a]),J=(0,c.useMemo)(()=>a?q.filter(b=>!(b.owner.id===a.id||b.members.some(b=>b.user?.id?b.user.id===a.id:!!b.userId&&b.userId===a.id)||I.some(a=>a.organization.id===b.id&&"PENDING"===a.status)||H.some(a=>a.organization.id===b.id&&"PENDING"===a.status))&&b.name.toLowerCase().includes(y.toLowerCase())):[],[q,a,I,H,y]);return a?.role!=="USER"?(0,b.jsx)("div",{className:"container mx-auto p-6",children:(0,b.jsx)(e.Card,{children:(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsx)(e.CardTitle,{children:"Accès refusé"}),(0,b.jsx)(e.CardDescription,{children:"Cette page est réservée aux utilisateurs."})]})})}):(0,b.jsxs)("div",{className:"container mx-auto p-6",children:[(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Mes Organisations"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Gérez vos organisations, invitations et demandes d'adhésion"})]}),w?(0,b.jsx)("div",{children:"Chargement..."}):(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsxs)(e.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(j.Building2,{className:"h-5 w-5"}),"Mes Organisations (",G.length,")"]}),(0,b.jsx)(e.CardDescription,{children:"Organisations dont vous êtes membre"})]}),(0,b.jsx)(e.CardContent,{children:G.length>0?(0,b.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:G.map(a=>(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsx)(e.CardTitle,{children:a.name}),(0,b.jsxs)(e.CardDescription,{children:["Propriétaire: ",a.owner.name||a.owner.email]})]}),(0,b.jsx)(e.CardContent,{children:(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,b.jsx)(l.UserPlus,{className:"h-4 w-4"}),a.members.length>0?`${a.members.length} membre${a.members.length>1?"s":""}`:"Aucun membre"]})})]},a.id))}):(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Vous n'êtes membre d'aucune organisation pour le moment."})})]}),H.length>0&&(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsxs)(e.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(k.Mail,{className:"h-5 w-5"}),"Invitations en attente (",H.length,")"]}),(0,b.jsx)(e.CardDescription,{children:"Invitations que vous avez reçues"})]}),(0,b.jsx)(e.CardContent,{children:(0,b.jsx)("div",{className:"space-y-3",children:H.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,p.getValidImageUrl)(a.organization.logo)&&(0,b.jsx)("img",{src:(0,p.getValidImageUrl)(a.organization.logo),alt:a.organization.name,className:"w-12 h-12 rounded object-contain",onError:a=>{a.target.style.display="none"}}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium",children:a.organization.name}),(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Invité par ",a.invitedBy.name||a.invitedBy.email]})]})]}),(0,b.jsxs)(f.Button,{onClick:()=>E(a.organization.id,a.id),children:[(0,b.jsx)(m.Check,{className:"mr-2 h-4 w-4"}),"Accepter"]})]},a.id))})})]}),I.length>0&&(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsxs)(e.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(l.UserPlus,{className:"h-5 w-5"}),"Demandes en attente (",I.length,")"]}),(0,b.jsx)(e.CardDescription,{children:"Demandes d'adhésion en attente de validation"})]}),(0,b.jsx)(e.CardContent,{children:(0,b.jsx)("div",{className:"space-y-3",children:I.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,p.getValidImageUrl)(a.organization.logo)&&(0,b.jsx)("img",{src:(0,p.getValidImageUrl)(a.organization.logo),alt:a.organization.name,className:"w-12 h-12 rounded object-contain",onError:a=>{a.target.style.display="none"}}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium",children:a.organization.name}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"En attente de validation"})]})]}),(0,b.jsx)(g.Badge,{variant:"outline",children:"En attente"})]},a.id))})})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsxs)(e.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(n.Search,{className:"h-5 w-5"}),"Organisations disponibles"]}),(0,b.jsx)(e.CardDescription,{children:"Recherchez et demandez à rejoindre une organisation"})]}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsx)("div",{className:"mb-4",children:(0,b.jsx)(o.Input,{placeholder:"Rechercher une organisation...",value:y,onChange:a=>z(a.target.value)})}),J.length>0?(0,b.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:J.map(a=>{let c=I.some(b=>b.organization.id===a.id&&"PENDING"===b.status),d=G.some(b=>b.id===a.id);return(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,p.getValidImageUrl)(a.logo)&&(0,b.jsx)("img",{src:(0,p.getValidImageUrl)(a.logo),alt:a.name,className:"w-10 h-10 rounded object-contain",onError:a=>{a.target.style.display="none"}}),(0,b.jsx)(e.CardTitle,{className:"flex-1",children:a.name})]}),(0,b.jsxs)(e.CardDescription,{children:["Propriétaire: ",a.owner.name||a.owner.email]})]}),(0,b.jsx)(e.CardContent,{children:(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,b.jsx)(l.UserPlus,{className:"h-4 w-4"}),a.members.length," membre",a.members.length>1?"s":""]}),d?(0,b.jsx)(g.Badge,{children:"Membre"}):c?(0,b.jsx)(g.Badge,{variant:"outline",children:"Demande envoyée"}):(0,b.jsxs)(h.Dialog,{open:A===a.id,onOpenChange:b=>B(b?a.id:null),children:[(0,b.jsx)(h.DialogTrigger,{asChild:!0,children:(0,b.jsxs)(f.Button,{variant:"outline",className:"w-full",children:[(0,b.jsx)(l.UserPlus,{className:"mr-2 h-4 w-4"}),"Demander à rejoindre"]})}),(0,b.jsxs)(h.DialogContent,{children:[(0,b.jsxs)(h.DialogHeader,{children:[(0,b.jsx)(h.DialogTitle,{children:"Demander à rejoindre"}),(0,b.jsxs)(h.DialogDescription,{children:['Voulez-vous demander à rejoindre "',a.name,'" ?']})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,b.jsx)(f.Button,{variant:"outline",onClick:()=>B(null),children:"Annuler"}),(0,b.jsx)(f.Button,{onClick:()=>F(a.id),children:"Envoyer la demande"})]})]})]})]})})]},a.id)})}):(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:y?"Aucune organisation trouvée":"Aucune organisation disponible"})]})]})]})]})}a.s(["default",()=>q])}];

//# sourceMappingURL=_d753207c._.js.map