module.exports=[660935,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(50944),e=a.i(278165),f=a.i(856696),g=a.i(413902),h=a.i(35636),i=a.i(703130),j=a.i(340695),k=a.i(205522),l=a.i(514727),m=a.i(46470),n=a.i(277687),o=a.i(182434),p=a.i(692759),q=a.i(596221),r=a.i(400210),s=a.i(808406),t=a.i(587532),u=a.i(591965),v=a.i(915618),w=a.i(284505),x=a.i(807706),y=a.i(762180),z=a.i(558348),A=a.i(736598);function B(){let a=(0,d.useParams)(),B=(0,d.useRouter)(),{user:C}=(0,e.useUser)(),{getAccentColor:D}=(0,f.useOrganization)(),{theme:E}=(0,g.useTheme)(),{generate:F,loading:G,error:H}=(0,h.useBaseten)(),{toast:I}=(0,n.useToast)(),[J,K]=(0,c.useState)(null),[L,M]=(0,c.useState)([]),[N,O]=(0,c.useState)(""),[P,Q]=(0,c.useState)(!0),[R,S]=(0,c.useState)(""),[T,U]=(0,c.useState)(null),V=(0,c.useRef)(null),W=(0,c.useRef)(null),X=D("dark"===E),Y=a.id,Z=(0,d.useSearchParams)();async function $(){try{let a=await fetch(`/api/agents/${Y}`);if(!a.ok)throw Error("Failed to fetch agent");let b=await a.json();K(b),b.prompt&&M([{role:"system",content:b.prompt}])}catch(a){I({title:"Erreur",description:"Impossible de charger l'assistant",variant:"destructive"}),B.push("/dashboard/assistants")}finally{Q(!1)}}async function _(){if(!N.trim()||G||!J)return;let a={role:"user",content:N.trim()};M(b=>[...b,a]),O("");let b=L.filter(a=>"system"!==a.role).map(a=>({role:a.role,content:a.content}));b.unshift({role:"system",content:J.prompt}),b.push({role:"user",content:a.content});let c=L.length;M(a=>[...a,{role:"assistant",content:""}]);try{let d="";await F(b,{max_tokens:1e4,temperature:.7},a=>{d+=a,M(a=>{let b=[...a];return b[c+1]={role:"assistant",content:d},b})}),await aa([...L,a,{role:"assistant",content:d}])}catch(a){I({title:"Erreur",description:a instanceof Error?a.message:"Impossible d'envoyer le message",variant:"destructive"}),M(a=>a.slice(0,-1))}}async function aa(a){try{await fetch(`/api/agents/${Y}/sessions`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:a.filter(a=>"system"!==a.role)})})}catch(a){console.error("Error saving session:",a)}}async function ab(a){try{let b=await fetch(`/api/agents/${Y}/sessions`);if(!b.ok)throw Error("Failed to fetch sessions");let c=(await b.json()).find(b=>b.id===a);if(c){let a=JSON.parse(c.messages);M([{role:"system",content:J?.prompt||""},...a])}}catch(a){console.error("Error loading session:",a),I({title:"Erreur",description:"Impossible de charger la session",variant:"destructive"})}}if((0,c.useEffect)(()=>{if(C&&Y){$();let a=Z?.get("sessionId");a&&J&&ab(a)}},[C,Y]),(0,c.useEffect)(()=>{let a=Z?.get("sessionId");a&&J&&ab(a)},[J]),(0,c.useEffect)(()=>{V.current&&V.current.scrollIntoView({behavior:"smooth"})},[L]),P)return(0,b.jsx)("div",{className:"container mx-auto p-6",children:(0,b.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,b.jsx)(q.Loader2,{className:"h-8 w-8 animate-spin"})})});if(!J)return null;let ac=(a=>{let b=(0,A.getAgentByName)(a);if(b)return b.suggestedQuestions;let c=a.toLowerCase();return c.includes("sportif")||c.includes("coach")?["Comment crÃ©er un programme d'entraÃ®nement personnalisÃ© pour un client dÃ©butant de [Ã¢ge] ans, [poids] kg, [taille] cm ?","Quel programme d'entraÃ®nement recommander pour un objectif de perte de poids de [X] kg en [Y] mois ?","Comment structurer un programme de prise de masse pour un client de niveau intermÃ©diaire ?","Quelle est la meilleure rÃ©partition hebdomadaire pour un programme full-body vs split ?","Comment adapter un programme d'entraÃ®nement pour un client avec [blessure spÃ©cifique] ?","Quels sont les meilleurs exercices pour dÃ©velopper les [groupe musculaire] chez un dÃ©butant ?","Comment progresser sur les exercices polyarticulaires (squat, deadlift, bench press) ?","Quelle est la technique correcte pour exÃ©cuter [exercice spÃ©cifique] ?","Comment varier les exercices pour Ã©viter la stagnation ?","Quels exercices recommander pour un client avec des limitations articulaires aux [articulation] ?","Comment structurer une pÃ©riodisation sur [X] semaines pour un objectif de [objectif] ?","Quelle est la diffÃ©rence entre pÃ©riodisation linÃ©aire, ondulatoire et en bloc ?","Comment gÃ©rer les phases de rÃ©cupÃ©ration et de deload ?","Comment planifier les pics de performance pour une compÃ©tition dans [X] mois ?","Quel volume d'entraÃ®nement recommander pour un client de niveau [niveau] ?","Comment dÃ©terminer les charges optimales pour un client de [force actuelle] ?","Quelle est la relation entre intensitÃ©, volume et frÃ©quence d'entraÃ®nement ?","Comment progresser en force vs en hypertrophie ?","Comment optimiser la rÃ©cupÃ©ration entre les sÃ©ances pour un client qui s'entraÃ®ne [X] fois par semaine ?","Quels sont les signes de surentraÃ®nement et comment les prÃ©venir ?","Comment adapter l'entraÃ®nement selon le niveau de fatigue du client ?","Quelle est l'importance du sommeil dans la rÃ©cupÃ©ration ?","Comment crÃ©er un programme pour amÃ©liorer l'endurance cardiovasculaire ?","Quel programme recommander pour amÃ©liorer la mobilitÃ© et la flexibilitÃ© ?","Comment intÃ©grer l'entraÃ®nement fonctionnel dans un programme classique ?","Quelle approche pour un client souhaitant amÃ©liorer sa composition corporelle ?","Comment adapter un programme pour un client senior de [Ã¢ge] ans ?","Quel programme recommander pour une femme enceinte au [trimestre] trimestre ?","Comment crÃ©er un programme pour un adolescent de [Ã¢ge] ans en croissance ?","Quelle approche pour un client avec des problÃ¨mes de dos chroniques ?","Comment maintenir la motivation d'un client sur le long terme ?","Quels indicateurs suivre pour mesurer les progrÃ¨s d'un client ?","Comment adapter un programme quand un client stagne ?","Quelle stratÃ©gie pour gÃ©rer les plateaux de progression ?","Comment utiliser les mÃ©thodes d'intensification (drop sets, rest-pause, etc.) ?","Quelle est l'importance de la technique vs la charge dans l'entraÃ®nement ?","Comment intÃ©grer l'entraÃ®nement pliomÃ©trique dans un programme ?","Quelle approche pour dÃ©velopper la puissance et l'explosivitÃ© ?"]:c.includes("nutrition")||c.includes("nutritionniste")?["Comment crÃ©er un plan nutritionnel personnalisÃ© pour un client de [Ã¢ge] ans, [poids] kg, [taille] cm, [niveau d'activitÃ©] ?","Quel plan nutritionnel recommander pour un objectif de perte de poids de [X] kg en [Y] mois ?","Comment calculer les besoins caloriques prÃ©cis pour un client avec un mÃ©tabolisme de base de [BMR] kcal ?","Quelle rÃ©partition des macronutriments (protÃ©ines, glucides, lipides) pour un objectif de [objectif] ?","Comment adapter un plan nutritionnel selon le type d'entraÃ®nement (force, endurance, mixte) ?","Quelle quantitÃ© de protÃ©ines recommander pour un client de [poids] kg avec un objectif de [objectif] ?","Comment rÃ©partir les glucides autour de l'entraÃ®nement pour optimiser les performances ?","Quels sont les meilleurs types de lipides Ã  inclure dans un plan nutritionnel ?","Comment gÃ©rer l'apport en glucides pour un client en sÃ¨che vs en prise de masse ?","Quelle stratÃ©gie pour atteindre [X] g de protÃ©ines par jour de maniÃ¨re pratique ?","Comment structurer les repas pour un client qui s'entraÃ®ne [moment de la journÃ©e] ?","Quoi manger avant, pendant et aprÃ¨s un entraÃ®nement de [type d'entraÃ®nement] ?","Comment gÃ©rer la nutrition pour un client qui s'entraÃ®ne Ã  jeun ?","Quelle stratÃ©gie nutritionnelle pour un client avec des horaires de travail irrÃ©guliers ?","Comment rÃ©partir les calories sur [X] repas par jour ?","Quel plan nutritionnel recommander pour un client vÃ©gÃ©tarien/vÃ©gÃ©talien ?","Comment adapter la nutrition pour un client intolÃ©rant au lactose/gluten ?","Quelle approche pour un client suivant un rÃ©gime cÃ©togÃ¨ne ?","Comment crÃ©er un plan nutritionnel pour un client avec des allergies alimentaires ([allergÃ¨nes]) ?","Quelle stratÃ©gie pour un client souhaitant suivre un rÃ©gime intermittent fasting ?","Comment crÃ©er un dÃ©ficit calorique optimal pour une perte de poids durable ?","Quelle vitesse de perte de poids est saine et rÃ©aliste ?","Comment gÃ©rer les fringales et les envies de sucre pendant une perte de poids ?","Quelle stratÃ©gie pour Ã©viter la perte de masse musculaire pendant une sÃ¨che ?","Comment adapter la nutrition pendant un plateau de perte de poids ?","Comment crÃ©er un surplus calorique optimal pour une prise de masse propre ?","Quelle stratÃ©gie nutritionnelle pour maximiser la synthÃ¨se protÃ©ique ?","Comment gÃ©rer l'appÃ©tit pour un client qui a du mal Ã  manger suffisamment ?","Quels aliments recommander pour un client souhaitant prendre de la masse sans trop de gras ?","Comment rÃ©partir les calories pour une prise de masse efficace ?","Quels complÃ©ments alimentaires recommander pour un client avec un objectif de [objectif] ?","Comment intÃ©grer la crÃ©atine dans un plan nutritionnel ?","Quelle est l'utilitÃ© des BCAA et quand les recommander ?","Comment utiliser les protÃ©ines en poudre de maniÃ¨re optimale ?","Quels complÃ©ments pour amÃ©liorer la rÃ©cupÃ©ration ?","Quelle quantitÃ© d'eau recommander pour un client de [poids] kg qui s'entraÃ®ne [X] fois par semaine ?","Comment gÃ©rer l'hydratation pendant l'entraÃ®nement de longue durÃ©e ?","Quelle stratÃ©gie d'hydratation pour un client en sÃ¨che ?","Comment reconnaÃ®tre et prÃ©venir la dÃ©shydratation ?","Comment adapter la nutrition pour une femme enceinte ou allaitante ?","Quel plan nutritionnel pour un client senior de [Ã¢ge] ans ?","Comment crÃ©er un plan nutritionnel pour un adolescent en croissance ?","Quelle approche nutritionnelle pour un client avec des problÃ¨mes de santÃ© ([condition]) ?","Comment amÃ©liorer la composition corporelle (ratio muscle/gras) ?","Quelle stratÃ©gie pour rÃ©duire le pourcentage de masse grasse de [X]% Ã  [Y]% ?","Comment maintenir la masse musculaire pendant une perte de poids ?","Quelle approche pour un client avec un mÃ©tabolisme lent ?","Comment prÃ©parer des repas en batch pour la semaine ?","Quels sont les meilleurs aliments Ã  avoir toujours dans sa cuisine ?","Comment lire et comprendre les Ã©tiquettes nutritionnelles ?","Quelle stratÃ©gie pour manger sainement au restaurant ?","Comment gÃ©rer les Ã©carts et les repas de triche ?","Quels indicateurs suivre pour mesurer les progrÃ¨s nutritionnels ?","Comment ajuster un plan nutritionnel quand un client stagne ?","Quelle frÃ©quence de pesÃ©e et de mesures recommandÃ©e ?","Comment adapter la nutrition selon les rÃ©sultats et les retours du client ?","Comment aider un client avec une relation compliquÃ©e Ã  la nourriture ?","Quelle approche pour un client avec des antÃ©cÃ©dents de troubles alimentaires ?","Comment crÃ©er un environnement nutritionnel sain et non restrictif ?"]:["Comment puis-je vous aider aujourd'hui ?","Quels sont vos conseils principaux ?","Par oÃ¹ commencer ?","Quelle est votre approche ?"]})(J.name),ad=L.filter(a=>"system"!==a.role);return(0,b.jsxs)("div",{className:"flex flex-col h-screen",children:[(0,b.jsx)("div",{className:"flex-shrink-0 border-b bg-background",children:(0,b.jsx)("div",{className:"container mx-auto p-4",children:(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)(l.SidebarTrigger,{}),(0,b.jsxs)(j.Button,{variant:"ghost",size:"sm",onClick:()=>B.push("/dashboard/assistants"),children:[(0,b.jsx)(r.ArrowLeft,{className:"mr-2 h-4 w-4"}),"Retour"]}),(0,b.jsxs)(j.Button,{variant:"ghost",size:"sm",onClick:()=>B.push(`/dashboard/assistants/${Y}/history`),children:[(0,b.jsx)(u.History,{className:"mr-2 h-4 w-4"}),"Historique"]}),ad.length>0&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(j.Button,{variant:"ghost",size:"sm",onClick:function(){J&&(M([{role:"system",content:J.prompt}]),O(""),I({title:"Nouvelle conversation",description:"La conversation a Ã©tÃ© rÃ©initialisÃ©e"}))},children:[(0,b.jsx)(v.Plus,{className:"mr-2 h-4 w-4"}),"Nouveau"]}),(0,b.jsxs)(j.Button,{variant:"ghost",size:"sm",onClick:function(){let a=L.filter(a=>"system"!==a.role),b=`# Conversation avec ${J?.name}

`;b+=`*Export\xe9 le ${new Date().toLocaleDateString("fr-FR")} \xe0 ${new Date().toLocaleTimeString("fr-FR")}*

---

`,a.forEach(a=>{let c="user"===a.role?"ðŸ‘¤ **Vous**":`ðŸ¤– **${J?.name}**`;b+=`${c}

${a.content}

---

`});let c=new Blob([b],{type:"text/markdown"}),d=URL.createObjectURL(c),e=document.createElement("a");e.href=d,e.download=`conversation-${J?.name}-${new Date().toISOString().split("T")[0]}.md`,e.click(),URL.revokeObjectURL(d),I({title:"Export rÃ©ussi",description:"La conversation a Ã©tÃ© exportÃ©e en Markdown"})},children:[(0,b.jsx)(w.Download,{className:"mr-2 h-4 w-4"}),"Exporter"]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(x.Avatar,{children:(0,b.jsx)(x.AvatarFallback,{children:(0,b.jsx)(o.Bot,{className:"h-5 w-5"})})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-xl font-bold",style:X?{color:X}:void 0,children:J.name}),J.context&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:J.context})]})]})]})})}),(0,b.jsxs)("div",{className:"flex-1 flex flex-col min-h-0",children:[(0,b.jsx)(m.ScrollArea,{className:"flex-1",ref:W,children:(0,b.jsx)("div",{className:"container mx-auto p-6 max-w-4xl",children:0===ad.length?(0,b.jsx)("div",{className:"space-y-4",children:(0,b.jsxs)(i.Card,{children:[(0,b.jsxs)(i.CardHeader,{children:[(0,b.jsxs)(i.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(s.Sparkles,{className:"h-5 w-5"}),"Questions suggÃ©rÃ©es (",ac.length," questions)"]}),(0,b.jsx)(i.CardDescription,{children:"Cliquez sur une question pour commencer la conversation. Utilisez les variables [Ã¢ge], [poids], [taille], [X], [Y], etc. pour personnaliser."})]}),(0,b.jsxs)(i.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(t.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(k.Input,{placeholder:"Rechercher une question...",value:R,onChange:a=>S(a.target.value),className:"pl-10"})]}),(0,b.jsx)(m.ScrollArea,{className:"h-[500px]",children:(0,b.jsxs)("div",{className:"grid gap-2 pr-4",children:[ac.filter(a=>a.toLowerCase().includes(R.toLowerCase())).map((a,c)=>(0,b.jsx)(j.Button,{variant:"outline",className:"justify-start text-left h-auto py-3 px-4 whitespace-normal",onClick:()=>{O(a)},children:(0,b.jsx)("span",{className:"text-sm",children:a})},c)),0===ac.filter(a=>a.toLowerCase().includes(R.toLowerCase())).length&&(0,b.jsxs)("p",{className:"text-sm text-muted-foreground text-center py-4",children:['Aucune question trouvÃ©e pour "',R,'"']})]})})]})]})}):(0,b.jsxs)("div",{className:"space-y-4",children:[ad.map((a,c)=>(0,b.jsxs)("div",{className:`flex gap-3 ${"user"===a.role?"justify-end":"justify-start"}`,children:["assistant"===a.role&&(0,b.jsx)(x.Avatar,{className:"h-8 w-8",children:(0,b.jsx)(x.AvatarFallback,{children:(0,b.jsx)(o.Bot,{className:"h-4 w-4"})})}),(0,b.jsx)("div",{className:`rounded-lg px-4 py-2 max-w-[80%] ${"user"===a.role?"bg-primary text-primary-foreground":"bg-muted"}`,style:"user"===a.role&&X?{backgroundColor:X,color:"white"}:void 0,children:"assistant"===a.role?(0,b.jsx)("div",{className:"prose prose-sm dark:prose-invert max-w-none",children:(0,b.jsx)(y.default,{remarkPlugins:[z.default],components:{table:({node:a,...c})=>(0,b.jsx)("div",{className:"overflow-x-auto my-2",children:(0,b.jsx)("table",{className:"min-w-full divide-y divide-border",...c})}),th:({node:a,...c})=>(0,b.jsx)("th",{className:"px-4 py-2 bg-muted text-left font-semibold whitespace-nowrap",...c}),td:({node:a,...c})=>(0,b.jsx)("td",{className:"px-4 py-2 border-t border-border whitespace-nowrap",...c})},children:a.content})}):(0,b.jsx)("p",{className:"whitespace-pre-wrap",children:a.content})}),"user"===a.role&&(0,b.jsx)(x.Avatar,{className:"h-8 w-8",children:(0,b.jsx)(x.AvatarFallback,{children:C?.name?.charAt(0).toUpperCase()||C?.email.charAt(0).toUpperCase()})})]},c)),G&&(0,b.jsxs)("div",{className:"flex gap-3 justify-start",children:[(0,b.jsx)(x.Avatar,{className:"h-8 w-8",children:(0,b.jsx)(x.AvatarFallback,{children:(0,b.jsx)(o.Bot,{className:"h-4 w-4"})})}),(0,b.jsx)("div",{className:"bg-muted rounded-lg px-4 py-2",children:(0,b.jsx)(q.Loader2,{className:"h-4 w-4 animate-spin"})})]}),(0,b.jsx)("div",{ref:V})]})})}),(0,b.jsx)("div",{className:"flex-shrink-0 border-t bg-background p-4",children:(0,b.jsxs)("div",{className:"container mx-auto max-w-4xl",children:[(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(k.Input,{value:N,onChange:a=>O(a.target.value),onKeyPress:function(a){"Enter"!==a.key||a.shiftKey||(a.preventDefault(),_())},placeholder:"Tapez votre message...",disabled:G,className:"flex-1"}),(0,b.jsx)(j.Button,{onClick:_,disabled:G||!N.trim(),style:X?{backgroundColor:X,color:"white"}:void 0,children:G?(0,b.jsx)(q.Loader2,{className:"h-4 w-4 animate-spin"}):(0,b.jsx)(p.Send,{className:"h-4 w-4"})})]}),H&&(0,b.jsx)("p",{className:"text-sm text-destructive mt-2",children:H})]})})]})]})}a.s(["default",()=>B])}];

//# sourceMappingURL=app_dashboard_assistants_%5Bid%5D_chat_page_tsx_d4758241._.js.map