module.exports=[570396,a=>{"use strict";a.i(673727),a.s([])},292603,(a,b,c)=>{"use strict";function d(a,b,c){if(a){for(let d of(c&&(c=c.toLowerCase()),a))if(b===d.domain?.split(":",1)[0].toLowerCase()||c===d.defaultLocale.toLowerCase()||d.locales?.some(a=>a.toLowerCase()===c))return d}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"detectDomainLocale",{enumerable:!0,get:function(){return d}})},971442,(a,b,c)=>{"use strict";function d(a){let b=a.indexOf("#"),c=a.indexOf("?"),d=c>-1&&(b<0||c<b);return d||b>-1?{pathname:a.substring(0,d?c:b),query:d?a.substring(c,b>-1?b:void 0):"",hash:b>-1?a.slice(b):""}:{pathname:a,query:"",hash:""}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"parsePath",{enumerable:!0,get:function(){return d}})},791150,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"addPathPrefix",{enumerable:!0,get:function(){return e}});let d=a.r(971442);function e(a,b){if(!a.startsWith("/")||!b)return a;let{pathname:c,query:e,hash:f}=(0,d.parsePath)(a);return`${b}${c}${e}${f}`}},347074,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"addPathSuffix",{enumerable:!0,get:function(){return e}});let d=a.r(971442);function e(a,b){if(!a.startsWith("/")||!b)return a;let{pathname:c,query:e,hash:f}=(0,d.parsePath)(a);return`${c}${b}${e}${f}`}},139481,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"pathHasPrefix",{enumerable:!0,get:function(){return e}});let d=a.r(971442);function e(a,b){if("string"!=typeof a)return!1;let{pathname:c}=(0,d.parsePath)(a);return c===b||c.startsWith(b+"/")}},507700,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"addLocale",{enumerable:!0,get:function(){return f}});let d=a.r(791150),e=a.r(139481);function f(a,b,c,f){if(!b||b===c)return a;let g=a.toLowerCase();return!f&&((0,e.pathHasPrefix)(g,"/api")||(0,e.pathHasPrefix)(g,`/${b.toLowerCase()}`))?a:(0,d.addPathPrefix)(a,`/${b}`)}},97642,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"formatNextPathnameInfo",{enumerable:!0,get:function(){return h}});let d=a.r(374993),e=a.r(791150),f=a.r(347074),g=a.r(507700);function h(a){let b=(0,g.addLocale)(a.pathname,a.locale,a.buildId?void 0:a.defaultLocale,a.ignorePrefix);return(a.buildId||!a.trailingSlash)&&(b=(0,d.removeTrailingSlash)(b)),a.buildId&&(b=(0,f.addPathSuffix)((0,e.addPathPrefix)(b,`/_next/data/${a.buildId}`),"/"===a.pathname?"index.json":".json")),b=(0,e.addPathPrefix)(b,a.basePath),!a.buildId&&a.trailingSlash?b.endsWith("/")?b:(0,f.addPathSuffix)(b,"/"):(0,d.removeTrailingSlash)(b)}},64239,(a,b,c)=>{"use strict";function d(a,b){let c;if(b?.host&&!Array.isArray(b.host))c=b.host.toString().split(":",1)[0];else{if(!a.hostname)return;c=a.hostname}return c.toLowerCase()}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"getHostname",{enumerable:!0,get:function(){return d}})},361601,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"removePathPrefix",{enumerable:!0,get:function(){return e}});let d=a.r(139481);function e(a,b){if(!(0,d.pathHasPrefix)(a,b))return a;let c=a.slice(b.length);return c.startsWith("/")?c:`/${c}`}},294971,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"getNextPathnameInfo",{enumerable:!0,get:function(){return g}});let d=a.r(603885),e=a.r(361601),f=a.r(139481);function g(a,b){let{basePath:c,i18n:g,trailingSlash:h}=b.nextConfig??{},i={pathname:a,trailingSlash:"/"!==a?a.endsWith("/"):h};c&&(0,f.pathHasPrefix)(i.pathname,c)&&(i.pathname=(0,e.removePathPrefix)(i.pathname,c),i.basePath=c);let j=i.pathname;if(i.pathname.startsWith("/_next/data/")&&i.pathname.endsWith(".json")){let a=i.pathname.replace(/^\/_next\/data\//,"").replace(/\.json$/,"").split("/");i.buildId=a[0],j="index"!==a[1]?`/${a.slice(1).join("/")}`:"/",!0===b.parseData&&(i.pathname=j)}if(g){let a=b.i18nProvider?b.i18nProvider.analyze(i.pathname):(0,d.normalizeLocalePath)(i.pathname,g.locales);i.locale=a.detectedLocale,i.pathname=a.pathname??i.pathname,!a.detectedLocale&&i.buildId&&(a=b.i18nProvider?b.i18nProvider.analyze(j):(0,d.normalizeLocalePath)(j,g.locales)).detectedLocale&&(i.locale=a.detectedLocale)}return i}},522670,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"NextURL",{enumerable:!0,get:function(){return k}});let d=a.r(292603),e=a.r(97642),f=a.r(64239),g=a.r(294971),h=/(?!^https?:\/\/)(127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}|\[::1\]|localhost)/;function i(a,b){return new URL(String(a).replace(h,"localhost"),b&&String(b).replace(h,"localhost"))}let j=Symbol("NextURLInternal");class k{constructor(a,b,c){let d,e;"object"==typeof b&&"pathname"in b||"string"==typeof b?(d=b,e=c||{}):e=c||b||{},this[j]={url:i(a,d??e.base),options:e,basePath:""},this.analyze()}analyze(){var a,b,c,e,h;let i=(0,g.getNextPathnameInfo)(this[j].url.pathname,{nextConfig:this[j].options.nextConfig,parseData:!0,i18nProvider:this[j].options.i18nProvider}),k=(0,f.getHostname)(this[j].url,this[j].options.headers);this[j].domainLocale=this[j].options.i18nProvider?this[j].options.i18nProvider.detectDomainLocale(k):(0,d.detectDomainLocale)(null==(b=this[j].options.nextConfig)||null==(a=b.i18n)?void 0:a.domains,k);let l=(null==(c=this[j].domainLocale)?void 0:c.defaultLocale)||(null==(h=this[j].options.nextConfig)||null==(e=h.i18n)?void 0:e.defaultLocale);this[j].url.pathname=i.pathname,this[j].defaultLocale=l,this[j].basePath=i.basePath??"",this[j].buildId=i.buildId,this[j].locale=i.locale??l,this[j].trailingSlash=i.trailingSlash}formatPathname(){return(0,e.formatNextPathnameInfo)({basePath:this[j].basePath,buildId:this[j].buildId,defaultLocale:this[j].options.forceLocale?void 0:this[j].defaultLocale,locale:this[j].locale,pathname:this[j].url.pathname,trailingSlash:this[j].trailingSlash})}formatSearch(){return this[j].url.search}get buildId(){return this[j].buildId}set buildId(a){this[j].buildId=a}get locale(){return this[j].locale??""}set locale(a){var b,c;if(!this[j].locale||!(null==(c=this[j].options.nextConfig)||null==(b=c.i18n)?void 0:b.locales.includes(a)))throw Object.defineProperty(TypeError(`The NextURL configuration includes no locale "${a}"`),"__NEXT_ERROR_CODE",{value:"E597",enumerable:!1,configurable:!0});this[j].locale=a}get defaultLocale(){return this[j].defaultLocale}get domainLocale(){return this[j].domainLocale}get searchParams(){return this[j].url.searchParams}get host(){return this[j].url.host}set host(a){this[j].url.host=a}get hostname(){return this[j].url.hostname}set hostname(a){this[j].url.hostname=a}get port(){return this[j].url.port}set port(a){this[j].url.port=a}get protocol(){return this[j].url.protocol}set protocol(a){this[j].url.protocol=a}get href(){let a=this.formatPathname(),b=this.formatSearch();return`${this.protocol}//${this.host}${a}${b}${this.hash}`}set href(a){this[j].url=i(a),this.analyze()}get origin(){return this[j].url.origin}get pathname(){return this[j].url.pathname}set pathname(a){this[j].url.pathname=a}get hash(){return this[j].url.hash}set hash(a){this[j].url.hash=a}get search(){return this[j].url.search}set search(a){this[j].url.search=a}get password(){return this[j].url.password}set password(a){this[j].url.password=a}get username(){return this[j].url.username}set username(a){this[j].url.username=a}get basePath(){return this[j].basePath}set basePath(a){this[j].basePath=a.startsWith("/")?a:`/${a}`}toString(){return this.href}toJSON(){return this.href}[Symbol.for("edge-runtime.inspect.custom")](){return{href:this.href,origin:this.origin,protocol:this.protocol,username:this.username,password:this.password,host:this.host,hostname:this.hostname,port:this.port,pathname:this.pathname,search:this.search,searchParams:this.searchParams,hash:this.hash}}clone(){return new k(String(this),this[j].options)}}},989753,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={PageSignatureError:function(){return f},RemovedPageError:function(){return g},RemovedUAError:function(){return h}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});class f extends Error{constructor({page:a}){super(`The middleware "${a}" accepts an async API directly with the form:
  
  export function middleware(request, event) {
    return NextResponse.redirect('/new-location')
  }
  
  Read more: https://nextjs.org/docs/messages/middleware-new-signature
  `)}}class g extends Error{constructor(){super(`The request.page has been deprecated in favour of \`URLPattern\`.
  Read more: https://nextjs.org/docs/messages/middleware-request-page
  `)}}class h extends Error{constructor(){super(`The request.ua has been removed in favour of \`userAgent\` function.
  Read more: https://nextjs.org/docs/messages/middleware-parse-user-agent
  `)}}},488491,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={INTERNALS:function(){return j},NextRequest:function(){return k}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(522670),g=a.r(392273),h=a.r(989753),i=a.r(563681),j=Symbol("internal request");class k extends Request{constructor(a,b={}){const c="string"!=typeof a&&"url"in a?a.url:String(a);(0,g.validateURL)(c),b.body&&"half"!==b.duplex&&(b.duplex="half"),a instanceof Request?super(a,b):super(c,b);const d=new f.NextURL(c,{headers:(0,g.toNodeOutgoingHttpHeaders)(this.headers),nextConfig:b.nextConfig});this[j]={cookies:new i.RequestCookies(this.headers),nextUrl:d,url:d.toString()}}[Symbol.for("edge-runtime.inspect.custom")](){return{cookies:this.cookies,nextUrl:this.nextUrl,url:this.url,bodyUsed:this.bodyUsed,cache:this.cache,credentials:this.credentials,destination:this.destination,headers:Object.fromEntries(this.headers),integrity:this.integrity,keepalive:this.keepalive,method:this.method,mode:this.mode,redirect:this.redirect,referrer:this.referrer,referrerPolicy:this.referrerPolicy,signal:this.signal}}get cookies(){return this[j].cookies}get nextUrl(){return this[j].nextUrl}get page(){throw new h.RemovedPageError}get ua(){throw new h.RemovedUAError}get url(){return this[j].url}}},651978,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"NextResponse",{enumerable:!0,get:function(){return l}});let d=a.r(563681),e=a.r(522670),f=a.r(392273),g=a.r(751409),h=a.r(563681),i=Symbol("internal response"),j=new Set([301,302,303,307,308]);function k(a,b){var c;if(null==a||null==(c=a.request)?void 0:c.headers){if(!(a.request.headers instanceof Headers))throw Object.defineProperty(Error("request.headers must be an instance of Headers"),"__NEXT_ERROR_CODE",{value:"E119",enumerable:!1,configurable:!0});let c=[];for(let[d,e]of a.request.headers)b.set("x-middleware-request-"+d,e),c.push(d);b.set("x-middleware-override-headers",c.join(","))}}class l extends Response{constructor(a,b={}){super(a,b);const c=this.headers,j=new Proxy(new h.ResponseCookies(c),{get(a,e,f){switch(e){case"delete":case"set":return(...f)=>{let g=Reflect.apply(a[e],a,f),i=new Headers(c);return g instanceof h.ResponseCookies&&c.set("x-middleware-set-cookie",g.getAll().map(a=>(0,d.stringifyCookie)(a)).join(",")),k(b,i),g};default:return g.ReflectAdapter.get(a,e,f)}}});this[i]={cookies:j,url:b.url?new e.NextURL(b.url,{headers:(0,f.toNodeOutgoingHttpHeaders)(c),nextConfig:b.nextConfig}):void 0}}[Symbol.for("edge-runtime.inspect.custom")](){return{cookies:this.cookies,url:this.url,body:this.body,bodyUsed:this.bodyUsed,headers:Object.fromEntries(this.headers),ok:this.ok,redirected:this.redirected,status:this.status,statusText:this.statusText,type:this.type}}get cookies(){return this[i].cookies}static json(a,b){let c=Response.json(a,b);return new l(c.body,c)}static redirect(a,b){let c="number"==typeof b?b:(null==b?void 0:b.status)??307;if(!j.has(c))throw Object.defineProperty(RangeError('Failed to execute "redirect" on "response": Invalid status code'),"__NEXT_ERROR_CODE",{value:"E529",enumerable:!1,configurable:!0});let d="object"==typeof b?b:{},e=new Headers(null==d?void 0:d.headers);return e.set("Location",(0,f.validateURL)(a)),new l(null,{...d,headers:e,status:c})}static rewrite(a,b){let c=new Headers(null==b?void 0:b.headers);return c.set("x-middleware-rewrite",(0,f.validateURL)(a)),k(b,c),new l(null,{...b,headers:c})}static next(a){let b=new Headers(null==a?void 0:a.headers);return b.set("x-middleware-next","1"),k(a,b),new l(null,{...a,headers:b})}}},58176,(a,b,c)=>{"use strict";function d(){throw Object.defineProperty(Error('ImageResponse moved from "next/server" to "next/og" since Next.js 14, please import from "next/og" instead'),"__NEXT_ERROR_CODE",{value:"E183",enumerable:!1,configurable:!0})}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"ImageResponse",{enumerable:!0,get:function(){return d}})},506431,(a,b,c)=>{var d={226:function(b,c){!function(d,e){"use strict";var f="function",g="undefined",h="object",i="string",j="major",k="model",l="name",m="type",n="vendor",o="version",p="architecture",q="console",r="mobile",s="tablet",t="smarttv",u="wearable",v="embedded",w="Amazon",x="Apple",y="ASUS",z="BlackBerry",A="Browser",B="Chrome",C="Firefox",D="Google",E="Huawei",F="Microsoft",G="Motorola",H="Opera",I="Samsung",J="Sharp",K="Sony",L="Xiaomi",M="Zebra",N="Facebook",O="Chromium OS",P="Mac OS",Q=function(a,b){var c={};for(var d in a)b[d]&&b[d].length%2==0?c[d]=b[d].concat(a[d]):c[d]=a[d];return c},R=function(a){for(var b={},c=0;c<a.length;c++)b[a[c].toUpperCase()]=a[c];return b},S=function(a,b){return typeof a===i&&-1!==T(b).indexOf(T(a))},T=function(a){return a.toLowerCase()},U=function(a,b){if(typeof a===i)return a=a.replace(/^\s\s*/,""),typeof b===g?a:a.substring(0,350)},V=function(a,b){for(var c,d,e,g,i,j,k=0;k<b.length&&!i;){var l=b[k],m=b[k+1];for(c=d=0;c<l.length&&!i&&l[c];)if(i=l[c++].exec(a))for(e=0;e<m.length;e++)j=i[++d],typeof(g=m[e])===h&&g.length>0?2===g.length?typeof g[1]==f?this[g[0]]=g[1].call(this,j):this[g[0]]=g[1]:3===g.length?typeof g[1]!==f||g[1].exec&&g[1].test?this[g[0]]=j?j.replace(g[1],g[2]):void 0:this[g[0]]=j?g[1].call(this,j,g[2]):void 0:4===g.length&&(this[g[0]]=j?g[3].call(this,j.replace(g[1],g[2])):void 0):this[g]=j||void 0;k+=2}},W=function(a,b){for(var c in b)if(typeof b[c]===h&&b[c].length>0){for(var d=0;d<b[c].length;d++)if(S(b[c][d],a))return"?"===c?void 0:c}else if(S(b[c],a))return"?"===c?void 0:c;return a},X={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},Y={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[o,[l,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[o,[l,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[l,o],[/opios[\/ ]+([\w\.]+)/i],[o,[l,H+" Mini"]],[/\bopr\/([\w\.]+)/i],[o,[l,H]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[l,o],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[o,[l,"UC"+A]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[o,[l,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[o,[l,"WeChat"]],[/konqueror\/([\w\.]+)/i],[o,[l,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[o,[l,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[o,[l,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[l,/(.+)/,"$1 Secure "+A],o],[/\bfocus\/([\w\.]+)/i],[o,[l,C+" Focus"]],[/\bopt\/([\w\.]+)/i],[o,[l,H+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[o,[l,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[o,[l,"Dolphin"]],[/coast\/([\w\.]+)/i],[o,[l,H+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[o,[l,"MIUI "+A]],[/fxios\/([-\w\.]+)/i],[o,[l,C]],[/\bqihu|(qi?ho?o?|360)browser/i],[[l,"360 "+A]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[l,/(.+)/,"$1 "+A],o],[/(comodo_dragon)\/([\w\.]+)/i],[[l,/_/g," "],o],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[l,o],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[l],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[l,N],o],[/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[l,o],[/\bgsa\/([\w\.]+) .*safari\//i],[o,[l,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[o,[l,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[o,[l,B+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[l,B+" WebView"],o],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[o,[l,"Android "+A]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[l,o],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[o,[l,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[o,l],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[l,[o,W,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[l,o],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[l,"Netscape"],o],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[o,[l,C+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[l,o],[/(cobalt)\/([\w\.]+)/i],[l,[o,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[p,"amd64"]],[/(ia32(?=;))/i],[[p,T]],[/((?:i[346]|x)86)[;\)]/i],[[p,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[p,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[p,"armhf"]],[/windows (ce|mobile); ppc;/i],[[p,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[p,/ower/,"",T]],[/(sun4\w)[;\)]/i],[[p,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[p,T]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[k,[n,I],[m,s]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[k,[n,I],[m,r]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[k,[n,x],[m,r]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[k,[n,x],[m,s]],[/(macintosh);/i],[k,[n,x]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[k,[n,J],[m,r]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[k,[n,E],[m,s]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[k,[n,E],[m,r]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[k,/_/g," "],[n,L],[m,r]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[k,/_/g," "],[n,L],[m,s]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[k,[n,"OPPO"],[m,r]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[k,[n,"Vivo"],[m,r]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[k,[n,"Realme"],[m,r]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[k,[n,G],[m,r]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[k,[n,G],[m,s]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[k,[n,"LG"],[m,s]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[k,[n,"LG"],[m,r]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[k,[n,"Lenovo"],[m,s]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[k,/_/g," "],[n,"Nokia"],[m,r]],[/(pixel c)\b/i],[k,[n,D],[m,s]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[k,[n,D],[m,r]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[k,[n,K],[m,r]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[k,"Xperia Tablet"],[n,K],[m,s]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[k,[n,"OnePlus"],[m,r]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[k,[n,w],[m,s]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[k,/(.+)/g,"Fire Phone $1"],[n,w],[m,r]],[/(playbook);[-\w\),; ]+(rim)/i],[k,n,[m,s]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[k,[n,z],[m,r]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[k,[n,y],[m,s]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[k,[n,y],[m,r]],[/(nexus 9)/i],[k,[n,"HTC"],[m,s]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[n,[k,/_/g," "],[m,r]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[k,[n,"Acer"],[m,s]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[k,[n,"Meizu"],[m,r]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[n,k,[m,r]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[n,k,[m,s]],[/(surface duo)/i],[k,[n,F],[m,s]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[k,[n,"Fairphone"],[m,r]],[/(u304aa)/i],[k,[n,"AT&T"],[m,r]],[/\bsie-(\w*)/i],[k,[n,"Siemens"],[m,r]],[/\b(rct\w+) b/i],[k,[n,"RCA"],[m,s]],[/\b(venue[\d ]{2,7}) b/i],[k,[n,"Dell"],[m,s]],[/\b(q(?:mv|ta)\w+) b/i],[k,[n,"Verizon"],[m,s]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[k,[n,"Barnes & Noble"],[m,s]],[/\b(tm\d{3}\w+) b/i],[k,[n,"NuVision"],[m,s]],[/\b(k88) b/i],[k,[n,"ZTE"],[m,s]],[/\b(nx\d{3}j) b/i],[k,[n,"ZTE"],[m,r]],[/\b(gen\d{3}) b.+49h/i],[k,[n,"Swiss"],[m,r]],[/\b(zur\d{3}) b/i],[k,[n,"Swiss"],[m,s]],[/\b((zeki)?tb.*\b) b/i],[k,[n,"Zeki"],[m,s]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[n,"Dragon Touch"],k,[m,s]],[/\b(ns-?\w{0,9}) b/i],[k,[n,"Insignia"],[m,s]],[/\b((nxa|next)-?\w{0,9}) b/i],[k,[n,"NextBook"],[m,s]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[n,"Voice"],k,[m,r]],[/\b(lvtel\-)?(v1[12]) b/i],[[n,"LvTel"],k,[m,r]],[/\b(ph-1) /i],[k,[n,"Essential"],[m,r]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[k,[n,"Envizen"],[m,s]],[/\b(trio[-\w\. ]+) b/i],[k,[n,"MachSpeed"],[m,s]],[/\btu_(1491) b/i],[k,[n,"Rotor"],[m,s]],[/(shield[\w ]+) b/i],[k,[n,"Nvidia"],[m,s]],[/(sprint) (\w+)/i],[n,k,[m,r]],[/(kin\.[onetw]{3})/i],[[k,/\./g," "],[n,F],[m,r]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[k,[n,M],[m,s]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[k,[n,M],[m,r]],[/smart-tv.+(samsung)/i],[n,[m,t]],[/hbbtv.+maple;(\d+)/i],[[k,/^/,"SmartTV"],[n,I],[m,t]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[n,"LG"],[m,t]],[/(apple) ?tv/i],[n,[k,x+" TV"],[m,t]],[/crkey/i],[[k,B+"cast"],[n,D],[m,t]],[/droid.+aft(\w)( bui|\))/i],[k,[n,w],[m,t]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[k,[n,J],[m,t]],[/(bravia[\w ]+)( bui|\))/i],[k,[n,K],[m,t]],[/(mitv-\w{5}) bui/i],[k,[n,L],[m,t]],[/Hbbtv.*(technisat) (.*);/i],[n,k,[m,t]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[n,U],[k,U],[m,t]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[m,t]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[n,k,[m,q]],[/droid.+; (shield) bui/i],[k,[n,"Nvidia"],[m,q]],[/(playstation [345portablevi]+)/i],[k,[n,K],[m,q]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[k,[n,F],[m,q]],[/((pebble))app/i],[n,k,[m,u]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[k,[n,x],[m,u]],[/droid.+; (glass) \d/i],[k,[n,D],[m,u]],[/droid.+; (wt63?0{2,3})\)/i],[k,[n,M],[m,u]],[/(quest( 2| pro)?)/i],[k,[n,N],[m,u]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[n,[m,v]],[/(aeobc)\b/i],[k,[n,w],[m,v]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[k,[m,r]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[k,[m,s]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[m,s]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[m,r]],[/(android[-\w\. ]{0,9});.+buil/i],[k,[n,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[o,[l,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[o,[l,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[l,o],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[o,l]],os:[[/microsoft (windows) (vista|xp)/i],[l,o],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[l,[o,W,X]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[l,"Windows"],[o,W,X]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/ios;fbsv\/([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[o,/_/g,"."],[l,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[l,P],[o,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[o,l],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[l,o],[/\(bb(10);/i],[o,[l,z]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[o,[l,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[o,[l,C+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[o,[l,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[o,[l,"watchOS"]],[/crkey\/([\d\.]+)/i],[o,[l,B+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[l,O],o],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[l,o],[/(sunos) ?([\w\.\d]*)/i],[[l,"Solaris"],o],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[l,o]]},Z=function(a,b){if(typeof a===h&&(b=a,a=void 0),!(this instanceof Z))return new Z(a,b).getResult();var c=typeof d!==g&&d.navigator?d.navigator:void 0,e=a||(c&&c.userAgent?c.userAgent:""),q=c&&c.userAgentData?c.userAgentData:void 0,t=b?Q(Y,b):Y,u=c&&c.userAgent==e;return this.getBrowser=function(){var a,b={};return b[l]=void 0,b[o]=void 0,V.call(b,e,t.browser),b[j]=typeof(a=b[o])===i?a.replace(/[^\d\.]/g,"").split(".")[0]:void 0,u&&c&&c.brave&&typeof c.brave.isBrave==f&&(b[l]="Brave"),b},this.getCPU=function(){var a={};return a[p]=void 0,V.call(a,e,t.cpu),a},this.getDevice=function(){var a={};return a[n]=void 0,a[k]=void 0,a[m]=void 0,V.call(a,e,t.device),u&&!a[m]&&q&&q.mobile&&(a[m]=r),u&&"Macintosh"==a[k]&&c&&typeof c.standalone!==g&&c.maxTouchPoints&&c.maxTouchPoints>2&&(a[k]="iPad",a[m]=s),a},this.getEngine=function(){var a={};return a[l]=void 0,a[o]=void 0,V.call(a,e,t.engine),a},this.getOS=function(){var a={};return a[l]=void 0,a[o]=void 0,V.call(a,e,t.os),u&&!a[l]&&q&&"Unknown"!=q.platform&&(a[l]=q.platform.replace(/chrome os/i,O).replace(/macos/i,P)),a},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return e},this.setUA=function(a){return e=typeof a===i&&a.length>350?U(a,350):a,this},this.setUA(e),this};if(Z.VERSION="1.0.35",Z.BROWSER=R([l,o,j]),Z.CPU=R([p]),Z.DEVICE=R([k,n,m,q,r,t,s,u,v]),Z.ENGINE=Z.OS=R([l,o]),typeof c!==g)b.exports&&(c=b.exports=Z),c.UAParser=Z;else if(typeof define===f&&define.amd)a.r,void 0!==Z&&a.v(Z);else typeof d!==g&&(d.UAParser=Z);var $=typeof d!==g&&(d.jQuery||d.Zepto);if($&&!$.ua){var _=new Z;$.ua=_.getResult(),$.ua.get=function(){return _.getUA()},$.ua.set=function(a){_.setUA(a);var b=_.getResult();for(var c in b)$.ua[c]=b[c]}}}(this)}},e={};function f(a){var b=e[a];if(void 0!==b)return b.exports;var c=e[a]={exports:{}},g=!0;try{d[a].call(c.exports,c,c.exports,f),g=!1}finally{g&&delete e[a]}return c.exports}f.ab="/ROOT/node_modules/next/dist/compiled/ua-parser-js/",b.exports=f(226)},240881,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d,e={isBot:function(){return h},userAgent:function(){return j},userAgentFromString:function(){return i}};for(var f in e)Object.defineProperty(c,f,{enumerable:!0,get:e[f]});let g=(d=a.r(506431))&&d.__esModule?d:{default:d};function h(a){return/Googlebot|Mediapartners-Google|AdsBot-Google|googleweblight|Storebot-Google|Google-PageRenderer|Google-InspectionTool|Bingbot|BingPreview|Slurp|DuckDuckBot|baiduspider|yandex|sogou|LinkedInBot|bitlybot|tumblr|vkShare|quora link preview|facebookexternalhit|facebookcatalog|Twitterbot|applebot|redditbot|Slackbot|Discordbot|WhatsApp|SkypeUriPreview|ia_archiver/i.test(a)}function i(a){return{...(0,g.default)(a),isBot:void 0!==a&&h(a)}}function j({headers:a}){return i(a.get("user-agent")||void 0)}},750792,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"URLPattern",{enumerable:!0,get:function(){return d}});let d="undefined"==typeof URLPattern?void 0:URLPattern},951455,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"after",{enumerable:!0,get:function(){return e}});let d=a.r(556704);function e(a){let b=d.workAsyncStorage.getStore();if(!b)throw Object.defineProperty(Error("`after` was called outside a request scope. Read more: https://nextjs.org/docs/messages/next-dynamic-api-wrong-context"),"__NEXT_ERROR_CODE",{value:"E468",enumerable:!1,configurable:!0});let{afterContext:c}=b;return c.after(a)}},389969,(a,b,c)=>{"use strict";var d,e;Object.defineProperty(c,"__esModule",{value:!0}),d=a.r(951455),e=c,Object.keys(d).forEach(function(a){"default"===a||Object.prototype.hasOwnProperty.call(e,a)||Object.defineProperty(e,a,{enumerable:!0,get:function(){return d[a]}})})},929574,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"connection",{enumerable:!0,get:function(){return j}});let d=a.r(556704),e=a.r(832319),f=a.r(660384),g=a.r(760312),h=a.r(13091),i=a.r(786309);function j(){let a=d.workAsyncStorage.getStore(),b=e.workUnitAsyncStorage.getStore();if(a){if(b&&"after"===b.phase&&!(0,i.isRequestAPICallableInsideAfter)())throw Object.defineProperty(Error(`Route ${a.route} used \`connection()\` inside \`after()\`. The \`connection()\` function is used to indicate the subsequent code must only run when there is an actual Request, but \`after()\` executes after the request, so this function is not allowed in this scope. See more info here: https://nextjs.org/docs/canary/app/api-reference/functions/after`),"__NEXT_ERROR_CODE",{value:"E827",enumerable:!1,configurable:!0});if(a.forceStatic)return Promise.resolve(void 0);if(a.dynamicShouldError)throw Object.defineProperty(new g.StaticGenBailoutError(`Route ${a.route} with \`dynamic = "error"\` couldn't be rendered statically because it used \`connection()\`. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E847",enumerable:!1,configurable:!0});if(b)switch(b.type){case"cache":{let b=Object.defineProperty(Error(`Route ${a.route} used \`connection()\` inside "use cache". The \`connection()\` function is used to indicate the subsequent code must only run when there is an actual request, but caches must be able to be produced before a request, so this function is not allowed in this scope. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`),"__NEXT_ERROR_CODE",{value:"E841",enumerable:!1,configurable:!0});throw Error.captureStackTrace(b,j),a.invalidDynamicUsageError??=b,b}case"private-cache":{let b=Object.defineProperty(Error(`Route ${a.route} used \`connection()\` inside "use cache: private". The \`connection()\` function is used to indicate the subsequent code must only run when there is an actual navigation request, but caches must be able to be produced before a navigation request, so this function is not allowed in this scope. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`),"__NEXT_ERROR_CODE",{value:"E837",enumerable:!1,configurable:!0});throw Error.captureStackTrace(b,j),a.invalidDynamicUsageError??=b,b}case"unstable-cache":throw Object.defineProperty(Error(`Route ${a.route} used \`connection()\` inside a function cached with \`unstable_cache()\`. The \`connection()\` function is used to indicate the subsequent code must only run when there is an actual Request, but caches must be able to be produced before a Request so this function is not allowed in this scope. See more info here: https://nextjs.org/docs/app/api-reference/functions/unstable_cache`),"__NEXT_ERROR_CODE",{value:"E840",enumerable:!1,configurable:!0});case"prerender":case"prerender-client":case"prerender-runtime":return(0,h.makeHangingPromise)(b.renderSignal,a.route,"`connection()`");case"prerender-ppr":return(0,f.postponeWithTracking)(a.route,"connection",b.dynamicTracking);case"prerender-legacy":return(0,f.throwToInterruptStaticGeneration)("connection",a,b);case"request":return(0,f.trackDynamicDataInDynamicRender)(b),Promise.resolve(void 0)}}(0,e.throwForMissingRequestStore)("connection")}a.r(531382)},843405,(a,b,c)=>{let d={NextRequest:a.r(488491).NextRequest,NextResponse:a.r(651978).NextResponse,ImageResponse:a.r(58176).ImageResponse,userAgentFromString:a.r(240881).userAgentFromString,userAgent:a.r(240881).userAgent,URLPattern:a.r(750792).URLPattern,after:a.r(389969).after,connection:a.r(929574).connection};b.exports=d,c.NextRequest=d.NextRequest,c.NextResponse=d.NextResponse,c.ImageResponse=d.ImageResponse,c.userAgentFromString=d.userAgentFromString,c.userAgent=d.userAgent,c.URLPattern=d.URLPattern,c.after=d.after,c.connection=d.connection},157377,a=>{"use strict";let b,c,d,e,f,g,h,i,j,k;var l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=a.i(905246),F=a.i(843405);class G extends Error{}class H extends G{constructor({code:a,message:b}){super(b??"An error occurred while interacting with the authorization server."),this.name="OAuth2Error",this.code=a}}class I extends G{constructor(a){super(a??"Discovery failed for the OpenID Connect configuration."),this.code="discovery_error",this.name="DiscoveryError"}}class J extends G{constructor(a){super(a??"The state parameter is missing."),this.code="missing_state",this.name="MissingStateError"}}class K extends G{constructor(a){super(a??"The state parameter is invalid."),this.code="invalid_state",this.name="InvalidStateError"}}class L extends G{constructor(a){super(a??"The configuration is invalid."),this.code="invalid_configuration",this.name="InvalidConfigurationError"}}class M extends G{constructor({cause:a,message:b}){super(b??"An error occurred during the authorization flow."),this.code="authorization_error",this.cause=a,this.name="AuthorizationError"}}class N extends G{constructor(a){super(a??"An error occurred while preparing or performing the authorization code grant request."),this.code="authorization_code_grant_request_error",this.name="AuthorizationCodeGrantRequestError"}}class O extends G{constructor({cause:a,message:b}){super(b??"An error occurred while trying to exchange the authorization code."),this.code="authorization_code_grant_error",this.cause=a,this.name="AuthorizationCodeGrantError"}}class P extends G{constructor(a){super(a??"An error occurred while completing the backchannel logout request."),this.code="backchannel_logout_error",this.name="BackchannelLogoutError"}}class Q extends G{constructor(){super("The authorization server does not support backchannel authentication. Learn how to enable it here: https://auth0.com/docs/get-started/applications/configure-client-initiated-backchannel-authentication"),this.code="backchannel_authentication_not_supported_error",this.name="BackchannelAuthenticationNotSupportedError"}}class R extends G{constructor({cause:a}){super("There was an error when trying to use Client-Initiated Backchannel Authentication."),this.code="backchannel_authentication_error",this.cause=a,this.name="BackchannelAuthenticationError"}}(l=r||(r={})).MISSING_SESSION="missing_session",l.MISSING_REFRESH_TOKEN="missing_refresh_token",l.FAILED_TO_REFRESH_TOKEN="failed_to_refresh_token";class S extends G{constructor(a,b,c){super(b),this.name="AccessTokenError",this.code=a,this.cause=c}}(m=s||(s={})).MISSING_SESSION="missing_session",m.MISSING_REFRESH_TOKEN="missing_refresh_token",m.FAILED_TO_EXCHANGE="failed_to_exchange_refresh_token";class T extends G{constructor(a,b,c){super(b),this.name="AccessTokenForConnectionError",this.code=a,this.cause=c}}(n=t||(t={})).DPOP_JKT_CALCULATION_FAILED="dpop_jkt_calculation_failed",n.DPOP_KEY_EXPORT_FAILED="dpop_key_export_failed",n.DPOP_CONFIGURATION_ERROR="dpop_configuration_error";class U extends G{constructor(a,b,c){super(b),this.name="DPoPError",this.code=a,this.cause=c}}class V extends G{constructor({type:a,title:b,detail:c,status:d,validationErrors:e}){super(`${b}: ${c}`),this.name="MyAccountApiError",this.code="my_account_api_error",this.type=a,this.title=b,this.detail=c,this.status=d,this.validationErrors=e}}(o=u||(u={})).MISSING_SESSION="missing_session",o.FAILED_TO_INITIATE="failed_to_initiate",o.FAILED_TO_COMPLETE="failed_to_complete";class W extends G{constructor({code:a,message:b,cause:c}){super(b),this.name="ConnectAccountError",this.code=a,this.cause=c}}let X="openid profile email offline_access";var Y=a.i(254799);function Z(a,b){if(null==a)return!1;try{return a instanceof b||Object.getPrototypeOf(a)[Symbol.toStringTag]===b.prototype[Symbol.toStringTag]}catch{return!1}}"undefined"!=typeof navigator&&navigator.userAgent?.startsWith?.("Mozilla/5.0 ")||(b="oauth4webapi/v3.8.2");let $="ERR_INVALID_ARG_VALUE",_="ERR_INVALID_ARG_TYPE";function aa(a,b,c){let d=TypeError(a,{cause:c});return Object.assign(d,{code:b}),d}let ab=Symbol(),ac=Symbol(),ad=Symbol(),ae=Symbol(),af=Symbol(),ag=Symbol();Symbol();let ah=new TextEncoder,ai=new TextDecoder;function aj(a){return"string"==typeof a?ah.encode(a):ai.decode(a)}function ak(a){return"string"==typeof a?d(a):c(a)}c=Uint8Array.prototype.toBase64?a=>(a instanceof ArrayBuffer&&(a=new Uint8Array(a)),a.toBase64({alphabet:"base64url",omitPadding:!0})):a=>{a instanceof ArrayBuffer&&(a=new Uint8Array(a));let b=[];for(let c=0;c<a.byteLength;c+=32768)b.push(String.fromCharCode.apply(null,a.subarray(c,c+32768)));return btoa(b.join("")).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},d=Uint8Array.fromBase64?a=>{try{return Uint8Array.fromBase64(a,{alphabet:"base64url"})}catch(a){throw aa("The input to be decoded is not correctly encoded.",$,a)}}:a=>{try{let b=atob(a.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,"")),c=new Uint8Array(b.length);for(let a=0;a<b.length;a++)c[a]=b.charCodeAt(a);return c}catch(a){throw aa("The input to be decoded is not correctly encoded.",$,a)}};class al extends Error{code;constructor(a,b){super(a,b),this.name=this.constructor.name,this.code=bu,Error.captureStackTrace?.(this,this.constructor)}}class am extends Error{code;constructor(a,b){super(a,b),this.name=this.constructor.name,b?.code&&(this.code=b?.code),Error.captureStackTrace?.(this,this.constructor)}}function an(a,b,c){return new am(a,{code:b,cause:c})}async function ao(a){let b;switch(a.kty){case"EC":b={crv:a.crv,kty:a.kty,x:a.x,y:a.y};break;case"OKP":b={crv:a.crv,kty:a.kty,x:a.x};break;case"AKP":b={alg:a.alg,kty:a.kty,pub:a.pub};break;case"RSA":b={e:a.e,kty:a.kty,n:a.n};break;default:throw new al("unsupported JWK key type",{cause:a})}return ak(await crypto.subtle.digest("SHA-256",aj(JSON.stringify(b))))}function ap(a,b){if(!(a instanceof CryptoKey))throw aa(`${b} must be a CryptoKey`,_)}function aq(a,b){if(ap(a,b),"private"!==a.type)throw aa(`${b} must be a private CryptoKey`,$)}function ar(a){return!(null===a||"object"!=typeof a||Array.isArray(a))}function as(a){Z(a,Headers)&&(a=Object.fromEntries(a.entries()));let c=new Headers(a??{});if(b&&!c.has("user-agent")&&c.set("user-agent",b),c.has("authorization"))throw aa('"options.headers" must not include the "authorization" header name',$);return c}function at(a,b){if(void 0!==b){if("function"==typeof b&&(b=b(a.href)),!(b instanceof AbortSignal))throw aa('"options.signal" must return or be an instance of AbortSignal',_);return b}}function au(a){return a.includes("//")?a.replace("//","/"):a}async function av(a,b,c,d){if(!(a instanceof URL))throw aa(`"${b}" must be an instance of URL`,_);aO(a,d?.[ab]!==!0);let e=c(new URL(a.href)),f=as(d?.headers);return f.set("accept","application/json"),(d?.[ae]||fetch)(e.href,{body:void 0,headers:Object.fromEntries(f.entries()),method:"GET",redirect:"manual",signal:at(e,d?.signal)})}async function aw(a,b){return av(a,"issuerIdentifier",a=>{switch(b?.algorithm){case void 0:case"oidc":a.pathname=au(`${a.pathname}/.well-known/openid-configuration`);break;case"oauth2":!function(a,b,c=!1){"/"===a.pathname?a.pathname=b:a.pathname=au(`${b}/${c?a.pathname:a.pathname.replace(/(\/)$/,"")}`)}(a,".well-known/oauth-authorization-server");break;default:throw aa('"options.algorithm" must be "oidc" (default), or "oauth2"',$)}return a},b)}function ax(a,b,c,d,e){try{if("number"!=typeof a||!Number.isFinite(a))throw aa(`${c} must be a number`,_,e);if(a>0)return;if(b){if(0!==a)throw aa(`${c} must be a non-negative number`,$,e);return}throw aa(`${c} must be a positive number`,$,e)}catch(a){if(d)throw an(a.message,d,e);throw a}}function ay(a,b,c,d){try{if("string"!=typeof a)throw aa(`${b} must be a string`,_,d);if(0===a.length)throw aa(`${b} must not be empty`,$,d)}catch(a){if(c)throw an(a.message,c,d);throw a}}async function az(a,b){if(!(a instanceof URL)&&a!==bV)throw aa('"expectedIssuerIdentifier" must be an instance of URL',_);if(!Z(b,Response))throw aa('"response" must be an instance of Response',_);if(200!==b.status)throw an('"response" is not a conform Authorization Server Metadata response (unexpected HTTP status code)',bz,b);bJ(b);let c=await bU(b);if(ay(c.issuer,'"response" body "issuer" property',bx,{body:c}),a!==bV&&new URL(c.issuer).href!==a.href)throw an('"response" body "issuer" property does not match the expected value',bE,{expected:a.href,body:c,attribute:"issuer"});return c}function aA(a){var b,c=a,d="application/json";if(b=c,b.headers.get("content-type")?.split(";")[0]!==d)throw function(a,...b){let c='"response" content-type must be ';if(b.length>2){let a=b.pop();c+=`${b.join(", ")}, or ${a}`}else 2===b.length?c+=`${b[0]} or ${b[1]}`:c+=b[0];return an(c,by,a)}(c,d)}function aB(){return ak(crypto.getRandomValues(new Uint8Array(32)))}async function aC(a){return ay(a,"codeVerifier"),ak(await crypto.subtle.digest("SHA-256",aj(a)))}function aD(a){switch(a.algorithm.name){case"RSA-PSS":switch(a.algorithm.hash.name){case"SHA-256":return"PS256";case"SHA-384":return"PS384";case"SHA-512":return"PS512";default:throw new al("unsupported RsaHashedKeyAlgorithm hash name",{cause:a})}case"RSASSA-PKCS1-v1_5":switch(a.algorithm.hash.name){case"SHA-256":return"RS256";case"SHA-384":return"RS384";case"SHA-512":return"RS512";default:throw new al("unsupported RsaHashedKeyAlgorithm hash name",{cause:a})}case"ECDSA":switch(a.algorithm.namedCurve){case"P-256":return"ES256";case"P-384":return"ES384";case"P-521":return"ES512";default:throw new al("unsupported EcKeyAlgorithm namedCurve",{cause:a})}case"Ed25519":case"ML-DSA-44":case"ML-DSA-65":case"ML-DSA-87":return a.algorithm.name;case"EdDSA":return"Ed25519";default:throw new al("unsupported CryptoKey algorithm name",{cause:a})}}function aE(a){let b=a?.[ac];return"number"==typeof b&&Number.isFinite(b)?b:0}function aF(a){let b=a?.[ad];return"number"==typeof b&&Number.isFinite(b)&&-1!==Math.sign(b)?b:30}function aG(){return Math.floor(Date.now()/1e3)}function aH(a){if("object"!=typeof a||null===a)throw aa('"as" must be an object',_);ay(a.issuer,'"as.issuer"')}function aI(a){if("object"!=typeof a||null===a)throw aa('"client" must be an object',_);ay(a.client_id,'"client.client_id"')}function aJ(a){return ay(a,'"clientSecret"'),(b,c,d,e)=>{d.set("client_id",c.client_id),d.set("client_secret",a)}}async function aK(a,b,c){if(!c.usages.includes("sign"))throw aa('CryptoKey instances used for signing assertions must include "sign" in their "usages"',$);let d=`${ak(aj(JSON.stringify(a)))}.${ak(aj(JSON.stringify(b)))}`,e=ak(await crypto.subtle.sign(function(a){switch(a.algorithm.name){case"ECDSA":return{name:a.algorithm.name,hash:function(a){let{algorithm:b}=a;switch(b.namedCurve){case"P-256":return"SHA-256";case"P-384":return"SHA-384";case"P-521":return"SHA-512";default:throw new al("unsupported ECDSA namedCurve",{cause:a})}}(a)};case"RSA-PSS":switch(bK(a),a.algorithm.hash.name){case"SHA-256":case"SHA-384":case"SHA-512":return{name:a.algorithm.name,saltLength:parseInt(a.algorithm.hash.name.slice(-3),10)>>3};default:throw new al("unsupported RSA-PSS hash name",{cause:a})}case"RSASSA-PKCS1-v1_5":return bK(a),a.algorithm.name;case"ML-DSA-44":case"ML-DSA-65":case"ML-DSA-87":case"Ed25519":return a.algorithm.name}throw new al("unsupported CryptoKey algorithm name",{cause:a})}(c),c,aj(d)));return`${d}.${e}`}async function aL(a,b){let{kty:c,e:d,n:f,x:g,y:h,crv:i,pub:j}=await crypto.subtle.exportKey("jwk",a),k={kty:c,e:d,n:f,x:g,y:h,crv:i,pub:j};return"AKP"===c&&(k.alg=b),e.set(a,k),k}async function aM(a,b){return(e||=new WeakMap).get(a)||aL(a,b)}let aN=URL.parse?(a,b)=>URL.parse(a,b):(a,b)=>{try{return new URL(a,b)}catch{return null}};function aO(a,b){if(b&&"https:"!==a.protocol)throw an("only requests to HTTPS are allowed",bA,a);if("https:"!==a.protocol&&"http:"!==a.protocol)throw an("only HTTP and HTTPS requests are allowed",bB,a)}function aP(a,b,c,d){let e;if("string"!=typeof a||!(e=aN(a)))throw an(`authorization server metadata does not contain a valid ${c?`"as.mtls_endpoint_aliases.${b}"`:`"as.${b}"`}`,void 0===a?bF:bG,{attribute:c?`mtls_endpoint_aliases.${b}`:b});return aO(e,d),e}function aQ(a,b,c,d){return c&&a.mtls_endpoint_aliases&&b in a.mtls_endpoint_aliases?aP(a.mtls_endpoint_aliases[b],b,c,d):aP(a[b],b,c,d)}async function aR(a,b,c,d,e){aH(a),aI(b);let f=aQ(a,"pushed_authorization_request_endpoint",b.use_mtls_endpoint_aliases,e?.[ab]!==!0),g=new URLSearchParams(d);g.set("client_id",b.client_id);let h=as(e?.headers);h.set("accept","application/json"),e?.DPoP!==void 0&&(a4(e.DPoP),await e.DPoP.addProof(f,h,"POST"));let i=await a7(a,b,c,f,g,h,e);return e?.DPoP?.cacheNonce(i,f),i}class aS{#a;#b;#c;#d;#e;#f;#g;constructor(a,b,c){if(aq(b?.privateKey,'"DPoP.privateKey"'),!function(a,b){if(ap(a,b),"public"!==a.type)throw aa(`${b} must be a public CryptoKey`,$)}(b?.publicKey,'"DPoP.publicKey"'),!b.publicKey.extractable)throw aa('"DPoP.publicKey.extractable" must be true',$);this.#e=c?.[af],this.#d=aE(a),this.#b=b.privateKey,this.#c=b.publicKey,bi.add(this)}#h(a){this.#f||=new Map;let b=this.#f.get(a);return b&&(this.#f.delete(a),this.#f.set(a,b)),b}#i(a,b){this.#f||=new Map,this.#f.delete(a),100===this.#f.size&&this.#f.delete(this.#f.keys().next().value),this.#f.set(a,b)}async calculateThumbprint(){if(!this.#g){let a=await crypto.subtle.exportKey("jwk",this.#c);this.#g||=await ao(a)}return this.#g}async addProof(a,b,c,d){let e=aD(this.#b);this.#a||={alg:e,typ:"dpop+jwt",jwk:await aM(this.#c,e)};let f=this.#h(a.origin),g={iat:aG()+this.#d,jti:aB(),htm:c,nonce:f,htu:`${a.origin}${a.pathname}`,ath:d?ak(await crypto.subtle.digest("SHA-256",aj(d))):void 0};this.#e?.(this.#a,g),b.set("dpop",await aK(this.#a,g,this.#b))}cacheNonce(a,b){try{let c=a.headers.get("dpop-nonce");c&&this.#i(b.origin,c)}catch{}}}function aT(a){if(a instanceof aX){let{0:b,length:c}=a.cause;return 1===c&&"dpop"===b.scheme&&"use_dpop_nonce"===b.parameters.error}return a instanceof aV&&"use_dpop_nonce"===a.error}function aU(a,b,c){return new aS(a,b,c)}class aV extends Error{cause;code;error;status;error_description;response;constructor(a,b){super(a,b),this.name=this.constructor.name,this.code=bt,this.cause=b.cause,this.error=b.cause.error,this.status=b.response.status,this.error_description=b.cause.error_description,Object.defineProperty(this,"response",{enumerable:!1,value:b.response}),Error.captureStackTrace?.(this,this.constructor)}}class aW extends Error{cause;code;error;error_description;constructor(a,b){super(a,b),this.name=this.constructor.name,this.code=bv,this.cause=b.cause,this.error=b.cause.get("error"),this.error_description=b.cause.get("error_description")??void 0,Error.captureStackTrace?.(this,this.constructor)}}class aX extends Error{cause;code;response;status;constructor(a,b){super(a,b),this.name=this.constructor.name,this.code=bs,this.cause=b.cause,this.status=b.response.status,this.response=b.response,Object.defineProperty(this,"response",{enumerable:!1}),Error.captureStackTrace?.(this,this.constructor)}}let aY="[a-zA-Z0-9!#$%&\\'\\*\\+\\-\\.\\^_`\\|~]+",aZ=RegExp("^[,\\s]*("+aY+")\\s(.*)"),a$=RegExp("^[,\\s]*("+aY+')\\s*=\\s*"((?:[^"\\\\]|\\\\.)*)"[,\\s]*(.*)'),a_=RegExp("^[,\\s]*"+("("+aY+")\\s*=\\s*(")+aY+")[,\\s]*(.*)"),a0=RegExp("^([a-zA-Z0-9\\-\\._\\~\\+\\/]+[=]{0,2})(?:$|[,\\s])(.*)");async function a1(a,b,c){if(aH(a),aI(b),!Z(c,Response))throw aa('"response" must be an instance of Response',_);await a3(c,201,"Pushed Authorization Request Endpoint"),bJ(c);let d=await bU(c);ay(d.request_uri,'"response" body "request_uri" property',bx,{body:d});let e="number"!=typeof d.expires_in?parseFloat(d.expires_in):d.expires_in;return ax(e,!0,'"response" body "expires_in" property',bx,{body:d}),d.expires_in=e,d}async function a2(a){if(a.status>399&&a.status<500){bJ(a),aA(a);try{let b=await a.clone().json();if(ar(b)&&"string"==typeof b.error&&b.error.length)return b}catch{}}}async function a3(a,b,c){if(a.status!==b){let b;if(be(a),b=await a2(a))throw await a.body?.cancel(),new aV("server responded with an error in the response body",{cause:b,response:a});throw an(`"response" is not a conform ${c} response (unexpected HTTP status code)`,bz,a)}}function a4(a){if(!bi.has(a))throw aa('"options.DPoP" is not a valid DPoPHandle',$)}async function a5(a,b,c,d,e,f){if(ay(a,'"accessToken"'),!(c instanceof URL))throw aa('"url" must be an instance of URL',_);aO(c,f?.[ab]!==!0),d=as(d),f?.DPoP&&(a4(f.DPoP),await f.DPoP.addProof(c,d,b.toUpperCase(),a)),d.set("authorization",`${d.has("dpop")?"DPoP":"Bearer"} ${a}`);let g=await (f?.[ae]||fetch)(c.href,{body:e,headers:Object.fromEntries(d.entries()),method:b,redirect:"manual",signal:at(c,f?.signal)});return f?.DPoP?.cacheNonce(g,c),g}async function a6(a,b,c,d,e,f){let g=await a5(a,b,c,d,e,f);return be(g),g}async function a7(a,b,c,d,e,f,g){return await c(a,b,e,f),f.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"),(g?.[ae]||fetch)(d.href,{body:e,headers:Object.fromEntries(f.entries()),method:"POST",redirect:"manual",signal:at(d,g?.signal)})}async function a8(a,b,c,d,e,f){let g=aQ(a,"token_endpoint",b.use_mtls_endpoint_aliases,f?.[ab]!==!0);e.set("grant_type",d);let h=as(f?.headers);h.set("accept","application/json"),f?.DPoP!==void 0&&(a4(f.DPoP),await f.DPoP.addProof(g,h,"POST"));let i=await a7(a,b,c,g,e,h,f);return f?.DPoP?.cacheNonce(i,g),i}async function a9(a,b,c,d,e){aH(a),aI(b),ay(d,'"refreshToken"');let f=new URLSearchParams(e?.additionalParameters);return f.set("refresh_token",d),a8(a,b,c,"refresh_token",f,e)}Symbol();let ba=new WeakMap,bb=new WeakMap;function bc(a){if(!a.id_token)return;let b=ba.get(a);if(!b)throw aa('"ref" was already garbage collected or did not resolve from the proper sources',$);return b}async function bd(a,b,c,d,e,f){if(aH(a),aI(b),!Z(c,Response))throw aa('"response" must be an instance of Response',_);await a3(c,200,"Token Endpoint"),bJ(c);let g=await bU(c);if(ay(g.access_token,'"response" body "access_token" property',bx,{body:g}),ay(g.token_type,'"response" body "token_type" property',bx,{body:g}),g.token_type=g.token_type.toLowerCase(),void 0!==g.expires_in){let a="number"!=typeof g.expires_in?parseFloat(g.expires_in):g.expires_in;ax(a,!0,'"response" body "expires_in" property',bx,{body:g}),g.expires_in=a}if(void 0!==g.refresh_token&&ay(g.refresh_token,'"response" body "refresh_token" property',bx,{body:g}),void 0!==g.scope&&"string"!=typeof g.scope)throw an('"response" body "scope" property must be a string',bx,{body:g});if(void 0!==g.id_token){ay(g.id_token,'"response" body "id_token" property',bx,{body:g});let f=["aud","exp","iat","iss","sub"];!0===b.require_auth_time&&f.push("auth_time"),void 0!==b.default_max_age&&(ax(b.default_max_age,!0,'"client.default_max_age"'),f.push("auth_time")),d?.length&&f.push(...d);let{claims:h,jwt:i}=await bL(g.id_token,bM.bind(void 0,b.id_token_signed_response_alg,a.id_token_signing_alg_values_supported,"RS256"),aE(b),aF(b),e).then(bm.bind(void 0,f)).then(bh.bind(void 0,a)).then(bg.bind(void 0,b.client_id));if(Array.isArray(h.aud)&&1!==h.aud.length){if(void 0===h.azp)throw an('ID Token "aud" (audience) claim includes additional untrusted audiences',bD,{claims:h,claim:"aud"});if(h.azp!==b.client_id)throw an('unexpected ID Token "azp" (authorized party) claim value',bD,{expected:b.client_id,claims:h,claim:"azp"})}void 0!==h.auth_time&&ax(h.auth_time,!0,'ID Token "auth_time" (authentication time)',bx,{claims:h}),bb.set(c,i),ba.set(g,h)}if(f?.[g.token_type]!==void 0)f[g.token_type](c,g);else if("dpop"!==g.token_type&&"bearer"!==g.token_type)throw new al("unsupported `token_type` value",{cause:{body:g}});return g}function be(a){let b;if(b=function(a){if(!Z(a,Response))throw aa('"response" must be an instance of Response',_);let b=a.headers.get("www-authenticate");if(null===b)return;let c=[],d=b;for(;d;){let a,b=d.match(aZ),e=b?.["1"].toLowerCase();if(d=b?.["2"],!e)return;let f={};for(;d;){let c,e;if(b=d.match(a$)){if([,c,e,d]=b,e.includes("\\"))try{e=JSON.parse(`"${e}"`)}catch{}f[c.toLowerCase()]=e;continue}if(b=d.match(a_)){[,c,e,d]=b,f[c.toLowerCase()]=e;continue}if(b=d.match(a0)){if(Object.keys(f).length)break;[,a,d]=b;break}return}let g={scheme:e,parameters:f};a&&(g.token68=a),c.push(g)}if(c.length)return c}(a))throw new aX("server responded with a challenge in the WWW-Authenticate HTTP Header",{cause:b,response:a})}async function bf(a,b,c,d){return bd(a,b,c,void 0,d?.[ag],d?.recognizedTokenTypes)}function bg(a,b){if(Array.isArray(b.claims.aud)){if(!b.claims.aud.includes(a))throw an('unexpected JWT "aud" (audience) claim value',bD,{expected:a,claims:b.claims,claim:"aud"})}else if(b.claims.aud!==a)throw an('unexpected JWT "aud" (audience) claim value',bD,{expected:a,claims:b.claims,claim:"aud"});return b}function bh(a,b){let c=a[bW]?.(b)??a.issuer;if(b.claims.iss!==c)throw an('unexpected JWT "iss" (issuer) claim value',bD,{expected:c,claims:b.claims,claim:"iss"});return b}let bi=new WeakSet,bj=Symbol();async function bk(a,b,c,d,e,f,g){if(aH(a),aI(b),!bi.has(d))throw aa('"callbackParameters" must be an instance of URLSearchParams obtained from "validateAuthResponse()", or "validateJwtAuthResponse()',$);ay(e,'"redirectUri"');let h=bN(d,"code");if(!h)throw an('no authorization code in "callbackParameters"',bx);let i=new URLSearchParams(g?.additionalParameters);return i.set("redirect_uri",e),i.set("code",h),f!==bj&&(ay(f,'"codeVerifier"'),i.set("code_verifier",f)),a8(a,b,c,"authorization_code",i,g)}let bl={aud:"audience",c_hash:"code hash",client_id:"client id",exp:"expiration time",iat:"issued at",iss:"issuer",jti:"jwt id",nonce:"nonce",s_hash:"state hash",sub:"subject",ath:"access token hash",htm:"http method",htu:"http uri",cnf:"confirmation",auth_time:"authentication time"};function bm(a,b){for(let c of a)if(void 0===b.claims[c])throw an(`JWT "${c}" (${bl[c]}) claim missing`,bx,{claims:b.claims});return b}let bn=Symbol(),bo=Symbol();async function bp(a,b,c,d){return"string"==typeof d?.expectedNonce||"number"==typeof d?.maxAge||d?.requireIdToken?bq(a,b,c,d.expectedNonce,d.maxAge,d[ag],d.recognizedTokenTypes):br(a,b,c,d?.[ag],d?.recognizedTokenTypes)}async function bq(a,b,c,d,e,f,g){let h=[];switch(d){case void 0:d=bn;break;case bn:break;default:ay(d,'"expectedNonce" argument'),h.push("nonce")}switch(e??=b.default_max_age){case void 0:e=bo;break;case bo:break;default:ax(e,!0,'"maxAge" argument'),h.push("auth_time")}let i=await bd(a,b,c,h,f,g);ay(i.id_token,'"response" body "id_token" property',bx,{body:i});let j=bc(i);if(e!==bo){let a=aG()+aE(b),c=aF(b);if(j.auth_time+e<a-c)throw an("too much time has elapsed since the last End-User authentication",bC,{claims:j,now:a,tolerance:c,claim:"auth_time"})}if(d===bn){if(void 0!==j.nonce)throw an('unexpected ID Token "nonce" claim value',bD,{expected:void 0,claims:j,claim:"nonce"})}else if(j.nonce!==d)throw an('unexpected ID Token "nonce" claim value',bD,{expected:d,claims:j,claim:"nonce"});return i}async function br(a,b,c,d,e){let f=await bd(a,b,c,void 0,d,e),g=bc(f);if(g){if(void 0!==b.default_max_age){ax(b.default_max_age,!0,'"client.default_max_age"');let a=aG()+aE(b),c=aF(b);if(g.auth_time+b.default_max_age<a-c)throw an("too much time has elapsed since the last End-User authentication",bC,{claims:g,now:a,tolerance:c,claim:"auth_time"})}if(void 0!==g.nonce)throw an('unexpected ID Token "nonce" claim value',bD,{expected:void 0,claims:g,claim:"nonce"})}return f}let bs="OAUTH_WWW_AUTHENTICATE_CHALLENGE",bt="OAUTH_RESPONSE_BODY_ERROR",bu="OAUTH_UNSUPPORTED_OPERATION",bv="OAUTH_AUTHORIZATION_RESPONSE_ERROR",bw="OAUTH_PARSE_ERROR",bx="OAUTH_INVALID_RESPONSE",by="OAUTH_RESPONSE_IS_NOT_JSON",bz="OAUTH_RESPONSE_IS_NOT_CONFORM",bA="OAUTH_HTTP_REQUEST_FORBIDDEN",bB="OAUTH_REQUEST_PROTOCOL_FORBIDDEN",bC="OAUTH_JWT_TIMESTAMP_CHECK_FAILED",bD="OAUTH_JWT_CLAIM_COMPARISON_FAILED",bE="OAUTH_JSON_ATTRIBUTE_COMPARISON_FAILED",bF="OAUTH_MISSING_SERVER_METADATA",bG="OAUTH_INVALID_SERVER_METADATA";async function bH(a,b,c,d,e,f){return aH(a),aI(b),ay(d,'"grantType"'),a8(a,b,c,d,new URLSearchParams(e),f)}async function bI(a,b,c,d){return bd(a,b,c,void 0,d?.[ag],d?.recognizedTokenTypes)}function bJ(a){if(a.bodyUsed)throw aa('"response" body has been used already',$)}function bK(a){let{algorithm:b}=a;if("number"!=typeof b.modulusLength||b.modulusLength<2048)throw new al(`unsupported ${b.name} modulusLength`,{cause:a})}async function bL(a,b,c,d,e){let f,g,{0:h,1:i,length:j}=a.split(".");if(5===j)if(void 0!==e)a=await e(a),{0:h,1:i,length:j}=a.split(".");else throw new al("JWE decryption is not configured",{cause:a});if(3!==j)throw an("Invalid JWT",bx,a);try{f=JSON.parse(aj(ak(h)))}catch(a){throw an("failed to parse JWT Header body as base64url encoded JSON",bw,a)}if(!ar(f))throw an("JWT Header must be a top level object",bx,a);if(b(f),void 0!==f.crit)throw new al('no JWT "crit" header parameter extensions are supported',{cause:{header:f}});try{g=JSON.parse(aj(ak(i)))}catch(a){throw an("failed to parse JWT Payload body as base64url encoded JSON",bw,a)}if(!ar(g))throw an("JWT Payload must be a top level object",bx,a);let k=aG()+c;if(void 0!==g.exp){if("number"!=typeof g.exp)throw an('unexpected JWT "exp" (expiration time) claim type',bx,{claims:g});if(g.exp<=k-d)throw an('unexpected JWT "exp" (expiration time) claim value, expiration is past current timestamp',bC,{claims:g,now:k,tolerance:d,claim:"exp"})}if(void 0!==g.iat&&"number"!=typeof g.iat)throw an('unexpected JWT "iat" (issued at) claim type',bx,{claims:g});if(void 0!==g.iss&&"string"!=typeof g.iss)throw an('unexpected JWT "iss" (issuer) claim type',bx,{claims:g});if(void 0!==g.nbf){if("number"!=typeof g.nbf)throw an('unexpected JWT "nbf" (not before) claim type',bx,{claims:g});if(g.nbf>k+d)throw an('unexpected JWT "nbf" (not before) claim value',bC,{claims:g,now:k,tolerance:d,claim:"nbf"})}if(void 0!==g.aud&&"string"!=typeof g.aud&&!Array.isArray(g.aud))throw an('unexpected JWT "aud" (audience) claim type',bx,{claims:g});return{header:f,claims:g,jwt:a}}function bM(a,b,c,d){if(void 0!==a){if("string"==typeof a?d.alg!==a:!a.includes(d.alg))throw an('unexpected JWT "alg" header parameter',bx,{header:d,expected:a,reason:"client configuration"});return}if(Array.isArray(b)){if(!b.includes(d.alg))throw an('unexpected JWT "alg" header parameter',bx,{header:d,expected:b,reason:"authorization server metadata"});return}if(void 0!==c){if("string"==typeof c?d.alg!==c:"function"==typeof c?!c(d.alg):!c.includes(d.alg))throw an('unexpected JWT "alg" header parameter',bx,{header:d,expected:c,reason:"default value"});return}throw an('missing client or server configuration to verify used JWT "alg" header parameter',void 0,{client:a,issuer:b,fallback:c})}function bN(a,b){let{0:c,length:d}=a.getAll(b);if(d>1)throw an(`"${b}" parameter must be provided only once`,bx);return c}let bO=Symbol(),bP=Symbol();async function bQ(a,b,c,d,e){aH(a),aI(b);let f=aQ(a,"backchannel_authentication_endpoint",b.use_mtls_endpoint_aliases,e?.[ab]!==!0),g=new URLSearchParams(d);g.set("client_id",b.client_id);let h=as(e?.headers);return h.set("accept","application/json"),a7(a,b,c,f,g,h,e)}async function bR(a,b,c){if(aH(a),aI(b),!Z(c,Response))throw aa('"response" must be an instance of Response',_);await a3(c,200,"Backchannel Authentication Endpoint"),bJ(c);let d=await bU(c);ay(d.auth_req_id,'"response" body "auth_req_id" property',bx,{body:d});let e="number"!=typeof d.expires_in?parseFloat(d.expires_in):d.expires_in;return ax(e,!0,'"response" body "expires_in" property',bx,{body:d}),d.expires_in=e,void 0!==d.interval&&ax(d.interval,!1,'"response" body "interval" property',bx,{body:d}),d}async function bS(a,b,c,d,e){aH(a),aI(b),ay(d,'"authReqId"');let f=new URLSearchParams(e?.additionalParameters);return f.set("auth_req_id",d),a8(a,b,c,"urn:openid:params:grant-type:ciba",f,e)}async function bT(a,b,c,d){return bd(a,b,c,void 0,d?.[ag],d?.recognizedTokenTypes)}async function bU(a,b=aA){let c;try{c=await a.json()}catch(c){throw b(a),an('failed to parse "response" body as JSON',bw,c)}if(!ar(c))throw an('"response" body must be a top level object',bx,{body:c});return c}let bV=Symbol(),bW=Symbol();function bX(){return"string"==typeof globalThis.EdgeRuntime}let bY=async a=>{let b=a?.delay??100,c=a?.jitter??!0,d=b;c&&(d=b*(.5+.5*Math.random())),await new Promise(a=>setTimeout(a,d))};async function bZ(a,b){if(!b?.isDPoPEnabled)return await a();try{let c=await a();if(c instanceof Response&&400===c.status)try{let d=await c.clone().json();if("use_dpop_nonce"===d.error)return await bY(b),await a()}catch{}return c}catch(c){if(aT(c))return await bY(b),await a();throw c}}function b$(a,b){if(a){if("string"==typeof a)return a;if(!b)throw new L("When defining scope as a Map, an audience is required to look up the correct scope.");return a[b]}}function b_(a,b){return{accessToken:a.accessToken,expiresAt:a.expiresAt,audience:b.audience,scope:a.scope,requestedScope:a.requestedScope,...a.token_type&&{token_type:a.token_type}}}function b0(a){return a?a.trim().split(" ").filter(Boolean):[]}let b1=(a,b,c={})=>{if(a===b)return!0;if(!a||!b)return!1;let d=new Set(b0(a)),e=new Set(b0(b)),f=Array.from(e).every(a=>d.has(a));return c.strict?f&&d.size===e.size:f};function b2(a,b){return Array.from(new Set([...a?b0(a):[],...b?b0(b):[]])).join(" ")}function b3(a,b){let c=b.matchMode??"requestedScope",d=a?.accessTokens;if(!d||0===d.length)return;let e=d.filter(a=>a.audience===b.audience&&b1("scope"===c?a.scope:a.requestedScope??a.scope,b.scope,{strict:"scope"===c}));if(0!==e.length)return e.sort((a,b)=>{let c=new Set(b0(a.scope)),d=new Set(b0(b.scope));return c.size-d.size}),e[0]}function b4(a,b,c){if(c)return{accessTokens:c.accessTokens,tokenSet:{...a.tokenSet,idToken:b.idToken,refreshToken:b.refreshToken}}}function b5(a,b,c){let d,e,f=b$(c.scope,b.audience??c.audience);if(d=!b.audience||b.audience===(a.tokenSet.audience??c.audience),e=!b.requestedScope||b1(a.tokenSet.requestedScope??f,b.requestedScope),d&&e)return b.accessToken!==a.tokenSet.accessToken||b.expiresAt!==a.tokenSet.expiresAt||b.refreshToken!==a.tokenSet.refreshToken?{tokenSet:b}:void 0;let g=b.audience??c.audience,h=b.requestedScope??f??void 0;if(g)return function(a,b,c,d){var e;let f=b3(a,{scope:d,audience:c,matchMode:"requestedScope"});if(f){let d=function(a,b,c,d){if(b.accessToken!==c.accessToken)return{accessTokens:a.accessTokens?.map(a=>a===c?b_(b,{audience:d}):a)}}(a,b,f,c);return b4(a,b,d)}if(f=b3(a,{scope:b.scope,audience:c,matchMode:"scope"})){let d=(e=f,{accessTokens:a.accessTokens?.map(a=>a===e?b_({...b,requestedScope:b2(a.requestedScope,b.requestedScope),scope:b.scope},{audience:c}):a)});return b4(a,b,d)}{let d={accessTokens:[...a.accessTokens||[],b_(b,{audience:c})]};return b4(a,b,d)}}(a,b,g,h)}function b6(a,b,...c){if((c=c.filter(Boolean)).length>2){let b=c.pop();a+=`one of type ${c.join(", ")}, or ${b}.`}else 2===c.length?a+=`one of type ${c[0]} or ${c[1]}.`:a+=`of type ${c[0]}.`;return null==b?a+=` Received ${b}`:"function"==typeof b&&b.name?a+=` Received function ${b.name}`:"object"==typeof b&&null!=b&&b.constructor?.name&&(a+=` Received an instance of ${b.constructor.name}`),a}let b7=(a,...b)=>b6("Key must be ",a,...b),b8=(a,b,...c)=>b6(`Key for the ${a} algorithm must be `,b,...c);function b9(a){if(Uint8Array.fromBase64)return Uint8Array.fromBase64(a);let b=atob(a),c=new Uint8Array(b.length);for(let a=0;a<b.length;a++)c[a]=b.charCodeAt(a);return c}class ca extends Error{static code="ERR_JOSE_GENERIC";code="ERR_JOSE_GENERIC";constructor(a,b){super(a,b),this.name=this.constructor.name,Error.captureStackTrace?.(this,this.constructor)}}class cb extends ca{static code="ERR_JWT_CLAIM_VALIDATION_FAILED";code="ERR_JWT_CLAIM_VALIDATION_FAILED";claim;reason;payload;constructor(a,b,c="unspecified",d="unspecified"){super(a,{cause:{claim:c,reason:d,payload:b}}),this.claim=c,this.reason=d,this.payload=b}}class cc extends ca{static code="ERR_JWT_EXPIRED";code="ERR_JWT_EXPIRED";claim;reason;payload;constructor(a,b,c="unspecified",d="unspecified"){super(a,{cause:{claim:c,reason:d,payload:b}}),this.claim=c,this.reason=d,this.payload=b}}class cd extends ca{static code="ERR_JOSE_ALG_NOT_ALLOWED";code="ERR_JOSE_ALG_NOT_ALLOWED"}class ce extends ca{static code="ERR_JOSE_NOT_SUPPORTED";code="ERR_JOSE_NOT_SUPPORTED"}class cf extends ca{static code="ERR_JWE_DECRYPTION_FAILED";code="ERR_JWE_DECRYPTION_FAILED";constructor(a="decryption operation failed",b){super(a,b)}}class cg extends ca{static code="ERR_JWE_INVALID";code="ERR_JWE_INVALID"}class ch extends ca{static code="ERR_JWS_INVALID";code="ERR_JWS_INVALID"}class ci extends ca{static code="ERR_JWT_INVALID";code="ERR_JWT_INVALID"}class cj extends ca{static code="ERR_JWK_INVALID";code="ERR_JWK_INVALID"}class ck extends ca{static code="ERR_JWKS_INVALID";code="ERR_JWKS_INVALID"}class cl extends ca{static code="ERR_JWKS_NO_MATCHING_KEY";code="ERR_JWKS_NO_MATCHING_KEY";constructor(a="no applicable key found in the JSON Web Key Set",b){super(a,b)}}class cm extends ca{[Symbol.asyncIterator];static code="ERR_JWKS_MULTIPLE_MATCHING_KEYS";code="ERR_JWKS_MULTIPLE_MATCHING_KEYS";constructor(a="multiple matching keys found in the JSON Web Key Set",b){super(a,b)}}class cn extends ca{static code="ERR_JWKS_TIMEOUT";code="ERR_JWKS_TIMEOUT";constructor(a="request timed out",b){super(a,b)}}class co extends ca{static code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED";code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED";constructor(a="signature verification failed",b){super(a,b)}}function cp(a){if(!cq(a))throw Error("CryptoKey instance expected")}let cq=a=>{if(a?.[Symbol.toStringTag]==="CryptoKey")return!0;try{return a instanceof CryptoKey}catch{return!1}},cr=a=>a?.[Symbol.toStringTag]==="KeyObject",cs=a=>cq(a)||cr(a),ct=(a,b)=>{if(a.byteLength!==b.length)return!1;for(let c=0;c<a.byteLength;c++)if(a[c]!==b[c])return!1;return!0},cu=a=>{let b=a.data[a.pos++];if(128&b){let c=127&b,d=0;for(let b=0;b<c;b++)d=d<<8|a.data[a.pos++];return d}return b},cv=(a,b,c)=>{if(a.data[a.pos++]!==b)throw Error(c)},cw=(a,b)=>{let c=a.data.subarray(a.pos,a.pos+b);return a.pos+=b,c},cx=async(a,b,c,d)=>{let e,f,g="spki"===a,h=()=>g?["verify"]:["sign"];switch(c){case"PS256":case"PS384":case"PS512":e={name:"RSA-PSS",hash:`SHA-${c.slice(-3)}`},f=h();break;case"RS256":case"RS384":case"RS512":e={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${c.slice(-3)}`},f=h();break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":e={name:"RSA-OAEP",hash:`SHA-${parseInt(c.slice(-3),10)||1}`},f=g?["encrypt","wrapKey"]:["decrypt","unwrapKey"];break;case"ES256":case"ES384":case"ES512":e={name:"ECDSA",namedCurve:({ES256:"P-256",ES384:"P-384",ES512:"P-521"})[c]},f=h();break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":try{let a=d.getNamedCurve(b);e="X25519"===a?{name:"X25519"}:{name:"ECDH",namedCurve:a}}catch(a){throw new ce("Invalid or unsupported key format")}f=g?[]:["deriveBits"];break;case"Ed25519":case"EdDSA":e={name:"Ed25519"},f=h();break;case"ML-DSA-44":case"ML-DSA-65":case"ML-DSA-87":e={name:c},f=h();break;default:throw new ce('Invalid or unsupported "alg" (Algorithm) value')}return crypto.subtle.importKey(a,b,e,d?.extractable??!!g,f)},cy=new TextEncoder,cz=new TextDecoder;function cA(...a){let b=new Uint8Array(a.reduce((a,{length:b})=>a+b,0)),c=0;for(let d of a)b.set(d,c),c+=d.length;return b}function cB(a,b,c){if(b<0||b>=0x100000000)throw RangeError(`value must be >= 0 and <= ${0x100000000-1}. Received ${b}`);a.set([b>>>24,b>>>16,b>>>8,255&b],c)}function cC(a){let b=Math.floor(a/0x100000000),c=new Uint8Array(8);return cB(c,b,0),cB(c,a%0x100000000,4),c}function cD(a){let b=new Uint8Array(4);return cB(b,a),b}function cE(a){let b=new Uint8Array(a.length);for(let c=0;c<a.length;c++){let d=a.charCodeAt(c);if(d>127)throw TypeError("non-ASCII string encountered in encode()");b[c]=d}return b}function cF(a){if(Uint8Array.fromBase64)return Uint8Array.fromBase64("string"==typeof a?a:cz.decode(a),{alphabet:"base64url"});let b=a;b instanceof Uint8Array&&(b=cz.decode(b)),b=b.replace(/-/g,"+").replace(/_/g,"/");try{return b9(b)}catch{throw TypeError("The input to be decoded is not correctly encoded.")}}function cG(a){let b=a;return("string"==typeof b&&(b=cy.encode(b)),Uint8Array.prototype.toBase64)?b.toBase64({alphabet:"base64url",omitPadding:!0}):(function(a){if(Uint8Array.prototype.toBase64)return a.toBase64();let b=[];for(let c=0;c<a.length;c+=32768)b.push(String.fromCharCode.apply(null,a.subarray(c,c+32768)));return btoa(b.join(""))})(b).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}async function cH(a){if(cr(a))if("secret"!==a.type)return a.export({format:"jwk"});else a=a.export();if(a instanceof Uint8Array)return{kty:"oct",k:cG(a)};if(!cq(a))throw TypeError(b7(a,"CryptoKey","KeyObject","Uint8Array"));if(!a.extractable)throw TypeError("non-extractable CryptoKey cannot be exported as a JWK");let{ext:b,key_ops:c,alg:d,use:e,...f}=await crypto.subtle.exportKey("jwk",a);return"AKP"===f.kty&&(f.alg=d),f}async function cI(a){return cH(a)}async function cJ(a,b){let c=`SHA-${a.slice(-3)}`;return new Uint8Array(await crypto.subtle.digest(c,b))}function cK(a){if("object"!=typeof a||null===a||"[object Object]"!==Object.prototype.toString.call(a))return!1;if(null===Object.getPrototypeOf(a))return!0;let b=a;for(;null!==Object.getPrototypeOf(b);)b=Object.getPrototypeOf(b);return Object.getPrototypeOf(a)===b}a.s(["decode",()=>cF,"encode",()=>cG],509634);let cL=a=>cK(a)&&"string"==typeof a.kty,cM=(a,b)=>{if("string"!=typeof a||!a)throw new cj(`${b} missing or invalid`)};async function cN(a,b){let c,d;if(cL(a))c=a;else if(cs(a))c=await cI(a);else throw TypeError(b7(a,"CryptoKey","KeyObject","JSON Web Key"));if("sha256"!==(b??="sha256")&&"sha384"!==b&&"sha512"!==b)throw TypeError('digestAlgorithm must one of "sha256", "sha384", or "sha512"');switch(c.kty){case"AKP":cM(c.alg,'"alg" (Algorithm) Parameter'),cM(c.pub,'"pub" (Public key) Parameter'),d={alg:c.alg,kty:c.kty,pub:c.pub};break;case"EC":cM(c.crv,'"crv" (Curve) Parameter'),cM(c.x,'"x" (X Coordinate) Parameter'),cM(c.y,'"y" (Y Coordinate) Parameter'),d={crv:c.crv,kty:c.kty,x:c.x,y:c.y};break;case"OKP":cM(c.crv,'"crv" (Subtype of Key Pair) Parameter'),cM(c.x,'"x" (Public Key) Parameter'),d={crv:c.crv,kty:c.kty,x:c.x};break;case"RSA":cM(c.e,'"e" (Exponent) Parameter'),cM(c.n,'"n" (Modulus) Parameter'),d={e:c.e,kty:c.kty,n:c.n};break;case"oct":cM(c.k,'"k" (Key Value) Parameter'),d={k:c.k,kty:c.kty};break;default:throw new ce('"kty" (Key Type) Parameter missing or unsupported')}let e=cE(JSON.stringify(d));return cG(await cJ(b,e))}async function cO(a){if(!a.alg)throw TypeError('"alg" argument is required when "jwk.alg" is not present');let{algorithm:b,keyUsages:c}=function(a){let b,c;switch(a.kty){case"AKP":switch(a.alg){case"ML-DSA-44":case"ML-DSA-65":case"ML-DSA-87":b={name:a.alg},c=a.priv?["sign"]:["verify"];break;default:throw new ce('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;case"RSA":switch(a.alg){case"PS256":case"PS384":case"PS512":b={name:"RSA-PSS",hash:`SHA-${a.alg.slice(-3)}`},c=a.d?["sign"]:["verify"];break;case"RS256":case"RS384":case"RS512":b={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${a.alg.slice(-3)}`},c=a.d?["sign"]:["verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":b={name:"RSA-OAEP",hash:`SHA-${parseInt(a.alg.slice(-3),10)||1}`},c=a.d?["decrypt","unwrapKey"]:["encrypt","wrapKey"];break;default:throw new ce('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;case"EC":switch(a.alg){case"ES256":b={name:"ECDSA",namedCurve:"P-256"},c=a.d?["sign"]:["verify"];break;case"ES384":b={name:"ECDSA",namedCurve:"P-384"},c=a.d?["sign"]:["verify"];break;case"ES512":b={name:"ECDSA",namedCurve:"P-521"},c=a.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":b={name:"ECDH",namedCurve:a.crv},c=a.d?["deriveBits"]:[];break;default:throw new ce('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;case"OKP":switch(a.alg){case"Ed25519":case"EdDSA":b={name:"Ed25519"},c=a.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":b={name:a.crv},c=a.d?["deriveBits"]:[];break;default:throw new ce('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;default:throw new ce('Invalid or unsupported JWK "kty" (Key Type) Parameter value')}return{algorithm:b,keyUsages:c}}(a),d={...a};return"AKP"!==d.kty&&delete d.alg,delete d.use,crypto.subtle.importKey("jwk",d,b,a.ext??(!a.d&&!a.priv),a.key_ops??c)}async function cP(a,b,c){let d,e,f;if("string"!=typeof a||0!==a.indexOf("-----BEGIN PRIVATE KEY-----"))throw TypeError('"pkcs8" must be PKCS#8 formatted string');return d=/(?:-----(?:BEGIN|END) PRIVATE KEY-----|\s)/g,e=b9(a.replace(d,"")),f=c,b?.startsWith?.("ECDH-ES")&&((f||={}).getNamedCurve=a=>{let b,c={data:a,pos:0};return cv(c,48,"Invalid PKCS#8 structure"),cu(c),cv(c,2,"Expected version field"),b=cu(c),c.pos+=b,cv(c,48,"Expected algorithm identifier"),cu(c),c.pos,(a=>{let b,c=(cv(a,6,"Expected algorithm OID"),b=cu(a),cw(a,b));if(ct(c,[43,101,110]))return"X25519";if(!ct(c,[42,134,72,206,61,2,1]))throw Error("Unsupported key algorithm");cv(a,6,"Expected curve OID");let d=cu(a),e=cw(a,d);for(let{name:a,oid:b}of[{name:"P-256",oid:[42,134,72,206,61,3,1,7]},{name:"P-384",oid:[43,129,4,0,34]},{name:"P-521",oid:[43,129,4,0,35]}])if(ct(e,b))return a;throw Error("Unsupported named curve")})(c)}),cx("pkcs8",e,b,f)}async function cQ(a,b,c){let d;if(!cK(a))throw TypeError("JWK must be an object");switch(b??=a.alg,d??=c?.extractable??a.ext,a.kty){case"oct":if("string"!=typeof a.k||!a.k)throw TypeError('missing "k" (Key Value) Parameter value');return cF(a.k);case"RSA":if("oth"in a&&void 0!==a.oth)throw new ce('RSA JWK "oth" (Other Primes Info) Parameter value is not supported');return cO({...a,alg:b,ext:d});case"AKP":if("string"!=typeof a.alg||!a.alg)throw TypeError('missing "alg" (Algorithm) Parameter value');if(void 0!==b&&b!==a.alg)throw TypeError("JWK alg and alg option value mismatch");return cO({...a,ext:d});case"EC":case"OKP":return cO({...a,alg:b,ext:d});default:throw new ce('Unsupported "kty" (Key Type) Parameter value')}}function cR(a){return cK(a)}class cS{#j;#k=new WeakMap;constructor(a){if(!function(a){return a&&"object"==typeof a&&Array.isArray(a.keys)&&a.keys.every(cR)}(a))throw new ck("JSON Web Key Set malformed");this.#j=structuredClone(a)}jwks(){return this.#j}async getKey(a,b){let{alg:c,kid:d}={...a,...b?.header},e=function(a){switch("string"==typeof a&&a.slice(0,2)){case"RS":case"PS":return"RSA";case"ES":return"EC";case"Ed":return"OKP";case"ML":return"AKP";default:throw new ce('Unsupported "alg" value for a JSON Web Key Set')}}(c),f=this.#j.keys.filter(a=>{let b=e===a.kty;if(b&&"string"==typeof d&&(b=d===a.kid),b&&("string"==typeof a.alg||"AKP"===e)&&(b=c===a.alg),b&&"string"==typeof a.use&&(b="sig"===a.use),b&&Array.isArray(a.key_ops)&&(b=a.key_ops.includes("verify")),b)switch(c){case"ES256":b="P-256"===a.crv;break;case"ES384":b="P-384"===a.crv;break;case"ES512":b="P-521"===a.crv;break;case"Ed25519":case"EdDSA":b="Ed25519"===a.crv}return b}),{0:g,length:h}=f;if(0===h)throw new cl;if(1!==h){let a=new cm,b=this.#k;throw a[Symbol.asyncIterator]=async function*(){for(let a of f)try{yield await cT(b,a,c)}catch{}},a}return cT(this.#k,g,c)}}async function cT(a,b,c){let d=a.get(b)||a.set(b,{}).get(b);if(void 0===d[c]){let a=await cQ({...b,ext:!0},c);if(a instanceof Uint8Array||"public"!==a.type)throw new ck("JSON Web Key Set members must be public keys");d[c]=a}return d[c]}function cU(a){let b=new cS(a),c=async(a,c)=>b.getKey(a,c);return Object.defineProperties(c,{jwks:{value:()=>structuredClone(b.jwks()),enumerable:!1,configurable:!1,writable:!1}}),c}"undefined"!=typeof navigator&&navigator.userAgent?.startsWith?.("Mozilla/5.0 ")||(f="jose/v6.1.2");let cV=Symbol();async function cW(a,b,c,d=fetch){let e=await d(a,{method:"GET",signal:c,redirect:"manual",headers:b}).catch(a=>{if("TimeoutError"===a.name)throw new cn;throw a});if(200!==e.status)throw new ca("Expected 200 OK from the JSON Web Key Set HTTP response");try{return await e.json()}catch{throw new ca("Failed to parse the JSON Web Key Set HTTP response as JSON")}}let cX=Symbol();class cY{#l;#m;#n;#o;#p;#q;#r;#s;#t;#u;constructor(a,b){if(!(a instanceof URL))throw TypeError("url must be an instance of URL");this.#l=new URL(a.href),this.#m="number"==typeof b?.timeoutDuration?b?.timeoutDuration:5e3,this.#n="number"==typeof b?.cooldownDuration?b?.cooldownDuration:3e4,this.#o="number"==typeof b?.cacheMaxAge?b?.cacheMaxAge:6e5,this.#r=new Headers(b?.headers),f&&!this.#r.has("User-Agent")&&this.#r.set("User-Agent",f),this.#r.has("accept")||(this.#r.set("accept","application/json"),this.#r.append("accept","application/jwk-set+json")),this.#s=b?.[cV],b?.[cX]!==void 0&&(this.#u=b?.[cX],function(a,b){return!("object"!=typeof a||null===a||!("uat"in a)||"number"!=typeof a.uat||Date.now()-a.uat>=b)&&"jwks"in a&&!!cK(a.jwks)&&!!Array.isArray(a.jwks.keys)&&!!Array.prototype.every.call(a.jwks.keys,cK)}(b?.[cX],this.#o)&&(this.#p=this.#u.uat,this.#t=cU(this.#u.jwks)))}pendingFetch(){return!!this.#q}coolingDown(){return"number"==typeof this.#p&&Date.now()<this.#p+this.#n}fresh(){return"number"==typeof this.#p&&Date.now()<this.#p+this.#o}jwks(){return this.#t?.jwks()}async getKey(a,b){this.#t&&this.fresh()||await this.reload();try{return await this.#t(a,b)}catch(c){if(c instanceof cl&&!1===this.coolingDown())return await this.reload(),this.#t(a,b);throw c}}async reload(){this.#q&&("undefined"!=typeof WebSocketPair||"undefined"!=typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||"undefined"!=typeof EdgeRuntime&&"vercel"===EdgeRuntime)&&(this.#q=void 0),this.#q||=cW(this.#l.href,this.#r,AbortSignal.timeout(this.#m),this.#s).then(a=>{this.#t=cU(a),this.#u&&(this.#u.uat=Date.now(),this.#u.jwks=a),this.#p=Date.now(),this.#q=void 0}).catch(a=>{throw this.#q=void 0,a}),await this.#q}}function cZ(a,b){if(a.startsWith("RS")||a.startsWith("PS")){let{modulusLength:c}=b.algorithm;if("number"!=typeof c||c<2048)throw TypeError(`${a} requires key modulusLength to be 2048 bits or larger`)}}let c$=(a,b="algorithm.name")=>TypeError(`CryptoKey does not support this operation, its ${b} must be ${a}`);function c_(a){return parseInt(a.name.slice(4),10)}function c0(a,b){if(b&&!a.usages.includes(b))throw TypeError(`CryptoKey does not support this operation, its usages must include ${b}.`)}function c1(a,b,c){switch(b){case"A128GCM":case"A192GCM":case"A256GCM":{if("AES-GCM"!==a.algorithm.name)throw c$("AES-GCM");let c=parseInt(b.slice(1,4),10);if(a.algorithm.length!==c)throw c$(c,"algorithm.length");break}case"A128KW":case"A192KW":case"A256KW":{if("AES-KW"!==a.algorithm.name)throw c$("AES-KW");let c=parseInt(b.slice(1,4),10);if(a.algorithm.length!==c)throw c$(c,"algorithm.length");break}case"ECDH":switch(a.algorithm.name){case"ECDH":case"X25519":break;default:throw c$("ECDH or X25519")}break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":if("PBKDF2"!==a.algorithm.name)throw c$("PBKDF2");break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":{if("RSA-OAEP"!==a.algorithm.name)throw c$("RSA-OAEP");let c=parseInt(b.slice(9),10)||1;if(c_(a.algorithm.hash)!==c)throw c$(`SHA-${c}`,"algorithm.hash");break}default:throw TypeError("CryptoKey does not support this operation")}c0(a,c)}async function c2(a,b,c){if(b instanceof Uint8Array){if(!a.startsWith("HS"))throw TypeError(b7(b,"CryptoKey","KeyObject","JSON Web Key"));return crypto.subtle.importKey("raw",b,{hash:`SHA-${a.slice(-3)}`,name:"HMAC"},!1,[c])}return!function(a,b,c){switch(b){case"HS256":case"HS384":case"HS512":{if("HMAC"!==a.algorithm.name)throw c$("HMAC");let c=parseInt(b.slice(2),10);if(c_(a.algorithm.hash)!==c)throw c$(`SHA-${c}`,"algorithm.hash");break}case"RS256":case"RS384":case"RS512":{if("RSASSA-PKCS1-v1_5"!==a.algorithm.name)throw c$("RSASSA-PKCS1-v1_5");let c=parseInt(b.slice(2),10);if(c_(a.algorithm.hash)!==c)throw c$(`SHA-${c}`,"algorithm.hash");break}case"PS256":case"PS384":case"PS512":{if("RSA-PSS"!==a.algorithm.name)throw c$("RSA-PSS");let c=parseInt(b.slice(2),10);if(c_(a.algorithm.hash)!==c)throw c$(`SHA-${c}`,"algorithm.hash");break}case"Ed25519":case"EdDSA":if("Ed25519"!==a.algorithm.name)throw c$("Ed25519");break;case"ML-DSA-44":case"ML-DSA-65":case"ML-DSA-87":let d;if(d=a.algorithm,d.name!==b)throw c$(b);break;case"ES256":case"ES384":case"ES512":{if("ECDSA"!==a.algorithm.name)throw c$("ECDSA");let c=function(a){switch(a){case"ES256":return"P-256";case"ES384":return"P-384";case"ES512":return"P-521";default:throw Error("unreachable")}}(b);if(a.algorithm.namedCurve!==c)throw c$(c,"algorithm.namedCurve");break}default:throw TypeError("CryptoKey does not support this operation")}c0(a,c)}(b,a,c),b}async function c3(a,b,c,d){let e=await c2(a,b,"verify");cZ(a,e);let f=function(a,b){let c=`SHA-${a.slice(-3)}`;switch(a){case"HS256":case"HS384":case"HS512":return{hash:c,name:"HMAC"};case"PS256":case"PS384":case"PS512":return{hash:c,name:"RSA-PSS",saltLength:parseInt(a.slice(-3),10)>>3};case"RS256":case"RS384":case"RS512":return{hash:c,name:"RSASSA-PKCS1-v1_5"};case"ES256":case"ES384":case"ES512":return{hash:c,name:"ECDSA",namedCurve:b.namedCurve};case"Ed25519":case"EdDSA":return{name:"Ed25519"};case"ML-DSA-44":case"ML-DSA-65":case"ML-DSA-87":return{name:a};default:throw new ce(`alg ${a} is not supported either by JOSE or your javascript runtime`)}}(a,e.algorithm);try{return await crypto.subtle.verify(f,e,c,d)}catch{return!1}}function c4(...a){let b,c=a.filter(Boolean);if(0===c.length||1===c.length)return!0;for(let a of c){let c=Object.keys(a);if(!b||0===b.size){b=new Set(c);continue}for(let a of c){if(b.has(a))return!1;b.add(a)}}return!0}let c5=a=>a?.[Symbol.toStringTag],c6=(a,b,c)=>{if(void 0!==b.use){let a;switch(c){case"sign":case"verify":a="sig";break;case"encrypt":case"decrypt":a="enc"}if(b.use!==a)throw TypeError(`Invalid key for this operation, its "use" must be "${a}" when present`)}if(void 0!==b.alg&&b.alg!==a)throw TypeError(`Invalid key for this operation, its "alg" must be "${a}" when present`);if(Array.isArray(b.key_ops)){let d;switch(!0){case"sign"===c||"verify"===c:case"dir"===a:case a.includes("CBC-HS"):d=c;break;case a.startsWith("PBES2"):d="deriveBits";break;case/^A\d{3}(?:GCM)?(?:KW)?$/.test(a):d=!a.includes("GCM")&&a.endsWith("KW")?"encrypt"===c?"wrapKey":"unwrapKey":c;break;case"encrypt"===c&&a.startsWith("RSA"):d="wrapKey";break;case"decrypt"===c:d=a.startsWith("RSA")?"unwrapKey":"deriveBits"}if(d&&b.key_ops?.includes?.(d)===!1)throw TypeError(`Invalid key for this operation, its "key_ops" must include "${d}" when present`)}return!0};function c7(a,b,c){switch(a.substring(0,2)){case"A1":case"A2":case"di":case"HS":case"PB":((a,b,c)=>{if(!(b instanceof Uint8Array)){if(cL(b)){if("oct"===b.kty&&"string"==typeof b.k&&c6(a,b,c))return;throw TypeError('JSON Web Key for symmetric algorithms must have JWK "kty" (Key Type) equal to "oct" and the JWK "k" (Key Value) present')}if(!cs(b))throw TypeError(b8(a,b,"CryptoKey","KeyObject","JSON Web Key","Uint8Array"));if("secret"!==b.type)throw TypeError(`${c5(b)} instances for symmetric algorithms must be of type "secret"`)}})(a,b,c);break;default:((a,b,c)=>{if(cL(b))switch(c){case"decrypt":case"sign":if("oct"!==b.kty&&("AKP"===b.kty&&"string"==typeof b.priv||"string"==typeof b.d)&&c6(a,b,c))return;throw TypeError("JSON Web Key for this operation be a private JWK");case"encrypt":case"verify":if("oct"!==b.kty&&void 0===b.d&&void 0===b.priv&&c6(a,b,c))return;throw TypeError("JSON Web Key for this operation be a public JWK")}if(!cs(b))throw TypeError(b8(a,b,"CryptoKey","KeyObject","JSON Web Key"));if("secret"===b.type)throw TypeError(`${c5(b)} instances for asymmetric algorithms must not be of type "secret"`);if("public"===b.type)switch(c){case"sign":throw TypeError(`${c5(b)} instances for asymmetric algorithm signing must be of type "private"`);case"decrypt":throw TypeError(`${c5(b)} instances for asymmetric algorithm decryption must be of type "private"`)}if("private"===b.type)switch(c){case"verify":throw TypeError(`${c5(b)} instances for asymmetric algorithm verifying must be of type "public"`);case"encrypt":throw TypeError(`${c5(b)} instances for asymmetric algorithm encryption must be of type "public"`)}})(a,b,c)}}function c8(a,b,c,d,e){let f;if(void 0!==e.crit&&d?.crit===void 0)throw new a('"crit" (Critical) Header Parameter MUST be integrity protected');if(!d||void 0===d.crit)return new Set;if(!Array.isArray(d.crit)||0===d.crit.length||d.crit.some(a=>"string"!=typeof a||0===a.length))throw new a('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');for(let g of(f=void 0!==c?new Map([...Object.entries(c),...b.entries()]):b,d.crit)){if(!f.has(g))throw new ce(`Extension Header Parameter "${g}" is not recognized`);if(void 0===e[g])throw new a(`Extension Header Parameter "${g}" is missing`);if(f.get(g)&&void 0===d[g])throw new a(`Extension Header Parameter "${g}" MUST be integrity protected`)}return new Set(d.crit)}function c9(a,b){if(void 0!==b&&(!Array.isArray(b)||b.some(a=>"string"!=typeof a)))throw TypeError(`"${a}" option must be an array of strings`);if(b)return new Set(b)}let da=async(a,b,c,d=!1)=>{let e=(g||=new WeakMap).get(a);if(e?.[c])return e[c];let f=await cO({...b,alg:c});return d&&Object.freeze(a),e?e[c]=f:g.set(a,{[c]:f}),f};async function db(a,b){if(a instanceof Uint8Array||cq(a))return a;if(cr(a)){if("secret"===a.type)return a.export();if("toCryptoKey"in a&&"function"==typeof a.toCryptoKey)try{return((a,b)=>{let c,d=(g||=new WeakMap).get(a);if(d?.[b])return d[b];let e="public"===a.type,f=!!e;if("x25519"===a.asymmetricKeyType){switch(b){case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":break;default:throw TypeError("given KeyObject instance cannot be used for this algorithm")}c=a.toCryptoKey(a.asymmetricKeyType,f,e?[]:["deriveBits"])}if("ed25519"===a.asymmetricKeyType){if("EdDSA"!==b&&"Ed25519"!==b)throw TypeError("given KeyObject instance cannot be used for this algorithm");c=a.toCryptoKey(a.asymmetricKeyType,f,[e?"verify":"sign"])}switch(a.asymmetricKeyType){case"ml-dsa-44":case"ml-dsa-65":case"ml-dsa-87":if(b!==a.asymmetricKeyType.toUpperCase())throw TypeError("given KeyObject instance cannot be used for this algorithm");c=a.toCryptoKey(a.asymmetricKeyType,f,[e?"verify":"sign"])}if("rsa"===a.asymmetricKeyType){let d;switch(b){case"RSA-OAEP":d="SHA-1";break;case"RS256":case"PS256":case"RSA-OAEP-256":d="SHA-256";break;case"RS384":case"PS384":case"RSA-OAEP-384":d="SHA-384";break;case"RS512":case"PS512":case"RSA-OAEP-512":d="SHA-512";break;default:throw TypeError("given KeyObject instance cannot be used for this algorithm")}if(b.startsWith("RSA-OAEP"))return a.toCryptoKey({name:"RSA-OAEP",hash:d},f,e?["encrypt"]:["decrypt"]);c=a.toCryptoKey({name:b.startsWith("PS")?"RSA-PSS":"RSASSA-PKCS1-v1_5",hash:d},f,[e?"verify":"sign"])}if("ec"===a.asymmetricKeyType){let d=new Map([["prime256v1","P-256"],["secp384r1","P-384"],["secp521r1","P-521"]]).get(a.asymmetricKeyDetails?.namedCurve);if(!d)throw TypeError("given KeyObject instance cannot be used for this algorithm");"ES256"===b&&"P-256"===d&&(c=a.toCryptoKey({name:"ECDSA",namedCurve:d},f,[e?"verify":"sign"])),"ES384"===b&&"P-384"===d&&(c=a.toCryptoKey({name:"ECDSA",namedCurve:d},f,[e?"verify":"sign"])),"ES512"===b&&"P-521"===d&&(c=a.toCryptoKey({name:"ECDSA",namedCurve:d},f,[e?"verify":"sign"])),b.startsWith("ECDH-ES")&&(c=a.toCryptoKey({name:"ECDH",namedCurve:d},f,e?[]:["deriveBits"]))}if(!c)throw TypeError("given KeyObject instance cannot be used for this algorithm");return d?d[b]=c:g.set(a,{[b]:c}),c})(a,b)}catch(a){if(a instanceof TypeError)throw a}let c=a.export({format:"jwk"});return da(a,c,b)}if(cL(a))return a.k?cF(a.k):da(a,a,b,!0);throw Error("unreachable")}async function dc(a,b,c){let d,e;if(!cK(a))throw new ch("Flattened JWS must be an object");if(void 0===a.protected&&void 0===a.header)throw new ch('Flattened JWS must have either of the "protected" or "header" members');if(void 0!==a.protected&&"string"!=typeof a.protected)throw new ch("JWS Protected Header incorrect type");if(void 0===a.payload)throw new ch("JWS Payload missing");if("string"!=typeof a.signature)throw new ch("JWS Signature missing or incorrect type");if(void 0!==a.header&&!cK(a.header))throw new ch("JWS Unprotected Header incorrect type");let f={};if(a.protected)try{let b=cF(a.protected);f=JSON.parse(cz.decode(b))}catch{throw new ch("JWS Protected Header is invalid")}if(!c4(f,a.header))throw new ch("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let g={...f,...a.header},h=c8(ch,new Map([["b64",!0]]),c?.crit,f,g),i=!0;if(h.has("b64")&&"boolean"!=typeof(i=f.b64))throw new ch('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:j}=g;if("string"!=typeof j||!j)throw new ch('JWS "alg" (Algorithm) Header Parameter missing or invalid');let k=c&&c9("algorithms",c.algorithms);if(k&&!k.has(j))throw new cd('"alg" (Algorithm) Header Parameter value not allowed');if(i){if("string"!=typeof a.payload)throw new ch("JWS Payload must be a string")}else if("string"!=typeof a.payload&&!(a.payload instanceof Uint8Array))throw new ch("JWS Payload must be a string or an Uint8Array instance");let l=!1;"function"==typeof b&&(b=await b(f,a),l=!0),c7(j,b,"verify");let m=cA(void 0!==a.protected?cE(a.protected):new Uint8Array,cE("."),"string"==typeof a.payload?i?cE(a.payload):cy.encode(a.payload):a.payload);try{d=cF(a.signature)}catch{throw new ch("Failed to base64url decode the signature")}let n=await db(b,j);if(!await c3(j,n,d,m))throw new co;if(i)try{e=cF(a.payload)}catch{throw new ch("Failed to base64url decode the payload")}else e="string"==typeof a.payload?cy.encode(a.payload):a.payload;let o={payload:e};return(void 0!==a.protected&&(o.protectedHeader=f),void 0!==a.header&&(o.unprotectedHeader=a.header),l)?{...o,key:n}:o}async function dd(a,b,c){if(a instanceof Uint8Array&&(a=cz.decode(a)),"string"!=typeof a)throw new ch("Compact JWS must be a string or Uint8Array");let{0:d,1:e,2:f,length:g}=a.split(".");if(3!==g)throw new ch("Invalid Compact JWS");let h=await dc({payload:e,protected:d,signature:f},b,c),i={payload:h.payload,protectedHeader:h.protectedHeader};return"function"==typeof b?{...i,key:h.key}:i}let de=a=>Math.floor(a.getTime()/1e3),df=/^(\+|\-)? ?(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)(?: (ago|from now))?$/i;function dg(a){let b,c=df.exec(a);if(!c||c[4]&&c[1])throw TypeError("Invalid time period format");let d=parseFloat(c[2]);switch(c[3].toLowerCase()){case"sec":case"secs":case"second":case"seconds":case"s":b=Math.round(d);break;case"minute":case"minutes":case"min":case"mins":case"m":b=Math.round(60*d);break;case"hour":case"hours":case"hr":case"hrs":case"h":b=Math.round(3600*d);break;case"day":case"days":case"d":b=Math.round(86400*d);break;case"week":case"weeks":case"w":b=Math.round(604800*d);break;default:b=Math.round(0x1e187e0*d)}return"-"===c[1]||"ago"===c[4]?-b:b}function dh(a,b){if(!Number.isFinite(b))throw TypeError(`Invalid ${a} input`);return b}let di=a=>a.includes("/")?a.toLowerCase():`application/${a.toLowerCase()}`;function dj(a,b,c={}){var d,e;let f,g;try{f=JSON.parse(cz.decode(b))}catch{}if(!cK(f))throw new ci("JWT Claims Set must be a top-level JSON object");let{typ:h}=c;if(h&&("string"!=typeof a.typ||di(a.typ)!==di(h)))throw new cb('unexpected "typ" JWT header value',f,"typ","check_failed");let{requiredClaims:i=[],issuer:j,subject:k,audience:l,maxTokenAge:m}=c,n=[...i];for(let a of(void 0!==m&&n.push("iat"),void 0!==l&&n.push("aud"),void 0!==k&&n.push("sub"),void 0!==j&&n.push("iss"),new Set(n.reverse())))if(!(a in f))throw new cb(`missing required "${a}" claim`,f,a,"missing");if(j&&!(Array.isArray(j)?j:[j]).includes(f.iss))throw new cb('unexpected "iss" claim value',f,"iss","check_failed");if(k&&f.sub!==k)throw new cb('unexpected "sub" claim value',f,"sub","check_failed");if(l&&(d=f.aud,e="string"==typeof l?[l]:l,"string"==typeof d?!e.includes(d):!(Array.isArray(d)&&e.some(Set.prototype.has.bind(new Set(d))))))throw new cb('unexpected "aud" claim value',f,"aud","check_failed");switch(typeof c.clockTolerance){case"string":g=dg(c.clockTolerance);break;case"number":g=c.clockTolerance;break;case"undefined":g=0;break;default:throw TypeError("Invalid clockTolerance option type")}let{currentDate:o}=c,p=de(o||new Date);if((void 0!==f.iat||m)&&"number"!=typeof f.iat)throw new cb('"iat" claim must be a number',f,"iat","invalid");if(void 0!==f.nbf){if("number"!=typeof f.nbf)throw new cb('"nbf" claim must be a number',f,"nbf","invalid");if(f.nbf>p+g)throw new cb('"nbf" claim timestamp check failed',f,"nbf","check_failed")}if(void 0!==f.exp){if("number"!=typeof f.exp)throw new cb('"exp" claim must be a number',f,"exp","invalid");if(f.exp<=p-g)throw new cc('"exp" claim timestamp check failed',f,"exp","check_failed")}if(m){let a=p-f.iat;if(a-g>("number"==typeof m?m:dg(m)))throw new cc('"iat" claim timestamp check failed (too far in the past)',f,"iat","check_failed");if(a<0-g)throw new cb('"iat" claim timestamp check failed (it should be in the past)',f,"iat","check_failed")}return f}class dk{#v;constructor(a){if(!cK(a))throw TypeError("JWT Claims Set MUST be an object");this.#v=structuredClone(a)}data(){return cy.encode(JSON.stringify(this.#v))}get iss(){return this.#v.iss}set iss(a){this.#v.iss=a}get sub(){return this.#v.sub}set sub(a){this.#v.sub=a}get aud(){return this.#v.aud}set aud(a){this.#v.aud=a}set jti(a){this.#v.jti=a}set nbf(a){"number"==typeof a?this.#v.nbf=dh("setNotBefore",a):a instanceof Date?this.#v.nbf=dh("setNotBefore",de(a)):this.#v.nbf=de(new Date)+dg(a)}set exp(a){"number"==typeof a?this.#v.exp=dh("setExpirationTime",a):a instanceof Date?this.#v.exp=dh("setExpirationTime",de(a)):this.#v.exp=de(new Date)+dg(a)}set iat(a){void 0===a?this.#v.iat=de(new Date):a instanceof Date?this.#v.iat=dh("setIssuedAt",de(a)):"string"==typeof a?this.#v.iat=dh("setIssuedAt",de(new Date)+dg(a)):this.#v.iat=dh("setIssuedAt",a)}}async function dl(a,b,c){let d=await dd(a,b,c);if(d.protectedHeader.crit?.includes("b64")&&!1===d.protectedHeader.b64)throw new ci("JWTs MUST NOT use unencoded payload");let e={payload:dj(d.protectedHeader,d.payload,c),protectedHeader:d.protectedHeader};return"function"==typeof b?{...e,key:d.key}:e}function dm(a){switch(a){case"A128GCM":case"A128GCMKW":case"A192GCM":case"A192GCMKW":case"A256GCM":case"A256GCMKW":return 96;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return 128;default:throw new ce(`Unsupported JWE Algorithm: ${a}`)}}function dn(a,b){if(b.length<<3!==dm(a))throw new cg("Invalid Initialization Vector length")}function dp(a,b){let c=a.byteLength<<3;if(c!==b)throw new cg(`Invalid Content Encryption Key length. Expected ${b} bits, got ${c} bits`)}async function dq(a,b){if(!(a instanceof Uint8Array))throw TypeError("First argument must be a buffer");if(!(b instanceof Uint8Array))throw TypeError("Second argument must be a buffer");let c={name:"HMAC",hash:"SHA-256"},d=await crypto.subtle.generateKey(c,!1,["sign"]),e=new Uint8Array(await crypto.subtle.sign(c,d,a)),f=new Uint8Array(await crypto.subtle.sign(c,d,b)),g=0,h=-1;for(;++h<32;)g|=e[h]^f[h];return 0===g}async function dr(a,b,c,d,e,f){let g,h;if(!(b instanceof Uint8Array))throw TypeError(b7(b,"Uint8Array"));let i=parseInt(a.slice(1,4),10),j=await crypto.subtle.importKey("raw",b.subarray(i>>3),"AES-CBC",!1,["decrypt"]),k=await crypto.subtle.importKey("raw",b.subarray(0,i>>3),{hash:`SHA-${i<<1}`,name:"HMAC"},!1,["sign"]),l=cA(f,d,c,cC(f.length<<3)),m=new Uint8Array((await crypto.subtle.sign("HMAC",k,l)).slice(0,i>>3));try{g=await dq(e,m)}catch{}if(!g)throw new cf;try{h=new Uint8Array(await crypto.subtle.decrypt({iv:d,name:"AES-CBC"},j,c))}catch{}if(!h)throw new cf;return h}async function ds(a,b,c,d,e,f){let g;b instanceof Uint8Array?g=await crypto.subtle.importKey("raw",b,"AES-GCM",!1,["decrypt"]):(c1(b,a,"decrypt"),g=b);try{return new Uint8Array(await crypto.subtle.decrypt({additionalData:f,iv:d,name:"AES-GCM",tagLength:128},g,cA(c,e)))}catch{throw new cf}}async function dt(a,b,c,d,e,f){if(!cq(b)&&!(b instanceof Uint8Array))throw TypeError(b7(b,"CryptoKey","KeyObject","Uint8Array","JSON Web Key"));if(!d)throw new cg("JWE Initialization Vector missing");if(!e)throw new cg("JWE Authentication Tag missing");switch(dn(a,d),a){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return b instanceof Uint8Array&&dp(b,parseInt(a.slice(-3),10)),dr(a,b,c,d,e,f);case"A128GCM":case"A192GCM":case"A256GCM":return b instanceof Uint8Array&&dp(b,parseInt(a.slice(1,4),10)),ds(a,b,c,d,e,f);default:throw new ce("Unsupported JWE Content Encryption Algorithm")}}function du(a,b){if(a.algorithm.length!==parseInt(b.slice(1,4),10))throw TypeError(`Invalid key size for alg: ${b}`)}function dv(a,b,c){return a instanceof Uint8Array?crypto.subtle.importKey("raw",a,"AES-KW",!0,[c]):(c1(a,b,c),a)}async function dw(a,b,c){let d=await dv(b,a,"wrapKey");du(d,a);let e=await crypto.subtle.importKey("raw",c,{hash:"SHA-256",name:"HMAC"},!0,["sign"]);return new Uint8Array(await crypto.subtle.wrapKey("raw",e,d,"AES-KW"))}async function dx(a,b,c){let d=await dv(b,a,"unwrapKey");du(d,a);let e=await crypto.subtle.unwrapKey("raw",c,d,"AES-KW",{hash:"SHA-256",name:"HMAC"},!0,["sign"]);return new Uint8Array(await crypto.subtle.exportKey("raw",e))}function dy(a){return cA(cD(a.length),a)}async function dz(a,b,c){let d=b>>3,e=Math.ceil(d/32),f=new Uint8Array(32*e);for(let b=1;b<=e;b++){let d=new Uint8Array(4+a.length+c.length);d.set(cD(b),0),d.set(a,4),d.set(c,4+a.length);let e=await cJ("sha256",d);f.set(e,(b-1)*32)}return f.slice(0,d)}async function dA(a,b,c,d,e=new Uint8Array,f=new Uint8Array){var g;c1(a,"ECDH"),c1(b,"ECDH","deriveBits");let h=cA(dy(cE(c)),dy(e),dy(f),cD(d),new Uint8Array);return dz(new Uint8Array(await crypto.subtle.deriveBits({name:a.algorithm.name,public:a},b,"X25519"===(g=a).algorithm.name?256:Math.ceil(parseInt(g.algorithm.namedCurve.slice(-3),10)/8)<<3)),d,h)}function dB(a){switch(a.algorithm.namedCurve){case"P-256":case"P-384":case"P-521":return!0;default:return"X25519"===a.algorithm.name}}async function dC(a,b,c,d){if(!(a instanceof Uint8Array)||a.length<8)throw new cg("PBES2 Salt Input must be 8 or more octets");let e=cA(cE(b),Uint8Array.of(0),a),f=parseInt(b.slice(13,16),10),g={hash:`SHA-${b.slice(8,11)}`,iterations:c,name:"PBKDF2",salt:e},h=await (d instanceof Uint8Array?crypto.subtle.importKey("raw",d,"PBKDF2",!1,["deriveBits"]):(c1(d,b,"deriveBits"),d));return new Uint8Array(await crypto.subtle.deriveBits(g,h,f))}async function dD(a,b,c,d=2048,e=crypto.getRandomValues(new Uint8Array(16))){let f=await dC(e,a,d,b);return{encryptedKey:await dw(a.slice(-6),f,c),p2c:d,p2s:cG(e)}}async function dE(a,b,c,d,e){let f=await dC(e,a,d,b);return dx(a.slice(-6),f,c)}let dF=a=>{switch(a){case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":return"RSA-OAEP";default:throw new ce(`alg ${a} is not supported either by JOSE or your javascript runtime`)}};async function dG(a,b,c){return c1(b,a,"encrypt"),cZ(a,b),new Uint8Array(await crypto.subtle.encrypt(dF(a),b,c))}async function dH(a,b,c){return c1(b,a,"decrypt"),cZ(a,b),new Uint8Array(await crypto.subtle.decrypt(dF(a),b,c))}function dI(a){switch(a){case"A128GCM":return 128;case"A192GCM":return 192;case"A256GCM":case"A128CBC-HS256":return 256;case"A192CBC-HS384":return 384;case"A256CBC-HS512":return 512;default:throw new ce(`Unsupported JWE Algorithm: ${a}`)}}let dJ=a=>crypto.getRandomValues(new Uint8Array(dI(a)>>3));async function dK(a,b,c,d,e){if(!(c instanceof Uint8Array))throw TypeError(b7(c,"Uint8Array"));let f=parseInt(a.slice(1,4),10),g=await crypto.subtle.importKey("raw",c.subarray(f>>3),"AES-CBC",!1,["encrypt"]),h=await crypto.subtle.importKey("raw",c.subarray(0,f>>3),{hash:`SHA-${f<<1}`,name:"HMAC"},!1,["sign"]),i=new Uint8Array(await crypto.subtle.encrypt({iv:d,name:"AES-CBC"},g,b)),j=cA(e,d,i,cC(e.length<<3));return{ciphertext:i,tag:new Uint8Array((await crypto.subtle.sign("HMAC",h,j)).slice(0,f>>3)),iv:d}}async function dL(a,b,c,d,e){let f;c instanceof Uint8Array?f=await crypto.subtle.importKey("raw",c,"AES-GCM",!1,["encrypt"]):(c1(c,a,"encrypt"),f=c);let g=new Uint8Array(await crypto.subtle.encrypt({additionalData:e,iv:d,name:"AES-GCM",tagLength:128},f,b)),h=g.slice(-16);return{ciphertext:g.slice(0,-16),tag:h,iv:d}}async function dM(a,b,c,d,e){if(!cq(c)&&!(c instanceof Uint8Array))throw TypeError(b7(c,"CryptoKey","KeyObject","Uint8Array","JSON Web Key"));if(d)dn(a,d);else d=crypto.getRandomValues(new Uint8Array(dm(a)>>3));switch(a){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return c instanceof Uint8Array&&dp(c,parseInt(a.slice(-3),10)),dK(a,b,c,d,e);case"A128GCM":case"A192GCM":case"A256GCM":return c instanceof Uint8Array&&dp(c,parseInt(a.slice(1,4),10)),dL(a,b,c,d,e);default:throw new ce("Unsupported JWE Content Encryption Algorithm")}}async function dN(a,b,c,d){let e=a.slice(0,7),f=await dM(e,c,b,d,new Uint8Array);return{encryptedKey:f.ciphertext,iv:cG(f.iv),tag:cG(f.tag)}}async function dO(a,b,c,d,e){return dt(a.slice(0,7),b,c,d,e,new Uint8Array)}async function dP(a,b,c,d,e){switch(a){case"dir":if(void 0!==c)throw new cg("Encountered unexpected JWE Encrypted Key");return b;case"ECDH-ES":if(void 0!==c)throw new cg("Encountered unexpected JWE Encrypted Key");case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{let e,f;if(!cK(d.epk))throw new cg('JOSE Header "epk" (Ephemeral Public Key) missing or invalid');if(cp(b),!dB(b))throw new ce("ECDH with the provided key is not allowed or not supported by your javascript runtime");let g=await cQ(d.epk,a);if(cp(g),void 0!==d.apu){if("string"!=typeof d.apu)throw new cg('JOSE Header "apu" (Agreement PartyUInfo) invalid');try{e=cF(d.apu)}catch{throw new cg("Failed to base64url decode the apu")}}if(void 0!==d.apv){if("string"!=typeof d.apv)throw new cg('JOSE Header "apv" (Agreement PartyVInfo) invalid');try{f=cF(d.apv)}catch{throw new cg("Failed to base64url decode the apv")}}let h=await dA(g,b,"ECDH-ES"===a?d.enc:a,"ECDH-ES"===a?dI(d.enc):parseInt(a.slice(-5,-2),10),e,f);if("ECDH-ES"===a)return h;if(void 0===c)throw new cg("JWE Encrypted Key missing");return dx(a.slice(-6),h,c)}case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":if(void 0===c)throw new cg("JWE Encrypted Key missing");return cp(b),dH(a,b,c);case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{let f;if(void 0===c)throw new cg("JWE Encrypted Key missing");if("number"!=typeof d.p2c)throw new cg('JOSE Header "p2c" (PBES2 Count) missing or invalid');let g=e?.maxPBES2Count||1e4;if(d.p2c>g)throw new cg('JOSE Header "p2c" (PBES2 Count) out is of acceptable bounds');if("string"!=typeof d.p2s)throw new cg('JOSE Header "p2s" (PBES2 Salt) missing or invalid');try{f=cF(d.p2s)}catch{throw new cg("Failed to base64url decode the p2s")}return dE(a,b,c,d.p2c,f)}case"A128KW":case"A192KW":case"A256KW":if(void 0===c)throw new cg("JWE Encrypted Key missing");return dx(a,b,c);case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{let e,f;if(void 0===c)throw new cg("JWE Encrypted Key missing");if("string"!=typeof d.iv)throw new cg('JOSE Header "iv" (Initialization Vector) missing or invalid');if("string"!=typeof d.tag)throw new cg('JOSE Header "tag" (Authentication Tag) missing or invalid');try{e=cF(d.iv)}catch{throw new cg("Failed to base64url decode the iv")}try{f=cF(d.tag)}catch{throw new cg("Failed to base64url decode the tag")}return dO(a,b,c,e,f)}default:throw new ce('Invalid or unsupported "alg" (JWE Algorithm) header value')}}async function dQ(a,b,c){let d,e,f,g,h,i,j;if(!cK(a))throw new cg("Flattened JWE must be an object");if(void 0===a.protected&&void 0===a.header&&void 0===a.unprotected)throw new cg("JOSE Header missing");if(void 0!==a.iv&&"string"!=typeof a.iv)throw new cg("JWE Initialization Vector incorrect type");if("string"!=typeof a.ciphertext)throw new cg("JWE Ciphertext missing or incorrect type");if(void 0!==a.tag&&"string"!=typeof a.tag)throw new cg("JWE Authentication Tag incorrect type");if(void 0!==a.protected&&"string"!=typeof a.protected)throw new cg("JWE Protected Header incorrect type");if(void 0!==a.encrypted_key&&"string"!=typeof a.encrypted_key)throw new cg("JWE Encrypted Key incorrect type");if(void 0!==a.aad&&"string"!=typeof a.aad)throw new cg("JWE AAD incorrect type");if(void 0!==a.header&&!cK(a.header))throw new cg("JWE Shared Unprotected Header incorrect type");if(void 0!==a.unprotected&&!cK(a.unprotected))throw new cg("JWE Per-Recipient Unprotected Header incorrect type");if(a.protected)try{let b=cF(a.protected);d=JSON.parse(cz.decode(b))}catch{throw new cg("JWE Protected Header is invalid")}if(!c4(d,a.header,a.unprotected))throw new cg("JWE Protected, JWE Unprotected Header, and JWE Per-Recipient Unprotected Header Parameter names must be disjoint");let k={...d,...a.header,...a.unprotected};if(c8(cg,new Map,c?.crit,d,k),void 0!==k.zip)throw new ce('JWE "zip" (Compression Algorithm) Header Parameter is not supported.');let{alg:l,enc:m}=k;if("string"!=typeof l||!l)throw new cg("missing JWE Algorithm (alg) in JWE Header");if("string"!=typeof m||!m)throw new cg("missing JWE Encryption Algorithm (enc) in JWE Header");let n=c&&c9("keyManagementAlgorithms",c.keyManagementAlgorithms),o=c&&c9("contentEncryptionAlgorithms",c.contentEncryptionAlgorithms);if(n&&!n.has(l)||!n&&l.startsWith("PBES2"))throw new cd('"alg" (Algorithm) Header Parameter value not allowed');if(o&&!o.has(m))throw new cd('"enc" (Encryption Algorithm) Header Parameter value not allowed');if(void 0!==a.encrypted_key)try{e=cF(a.encrypted_key)}catch{throw new cg("Failed to base64url decode the encrypted_key")}let p=!1;"function"==typeof b&&(b=await b(d,a),p=!0),c7("dir"===l?m:l,b,"decrypt");let q=await db(b,l);try{f=await dP(l,q,e,k,c)}catch(a){if(a instanceof TypeError||a instanceof cg||a instanceof ce)throw a;f=dJ(m)}if(void 0!==a.iv)try{g=cF(a.iv)}catch{throw new cg("Failed to base64url decode the iv")}if(void 0!==a.tag)try{h=cF(a.tag)}catch{throw new cg("Failed to base64url decode the tag")}let r=void 0!==a.protected?cE(a.protected):new Uint8Array;i=void 0!==a.aad?cA(r,cE("."),cE(a.aad)):r;try{j=cF(a.ciphertext)}catch{throw new cg("Failed to base64url decode the ciphertext")}let s={plaintext:await dt(m,f,j,g,h,i)};if(void 0!==a.protected&&(s.protectedHeader=d),void 0!==a.aad)try{s.additionalAuthenticatedData=cF(a.aad)}catch{throw new cg("Failed to base64url decode the aad")}return(void 0!==a.unprotected&&(s.sharedUnprotectedHeader=a.unprotected),void 0!==a.header&&(s.unprotectedHeader=a.header),p)?{...s,key:q}:s}async function dR(a,b,c){if(a instanceof Uint8Array&&(a=cz.decode(a)),"string"!=typeof a)throw new cg("Compact JWE must be a string or Uint8Array");let{0:d,1:e,2:f,3:g,4:h,length:i}=a.split(".");if(5!==i)throw new cg("Invalid Compact JWE");let j=await dQ({ciphertext:g,iv:f||void 0,protected:d,tag:h||void 0,encrypted_key:e||void 0},b,c),k={plaintext:j.plaintext,protectedHeader:j.protectedHeader};return"function"==typeof b?{...k,key:j.key}:k}"undefined"!=typeof navigator&&navigator.userAgent?.startsWith?.("Mozilla/5.0 ")||(h={"user-agent":"openid-client/v6.8.1"});let dS="ERR_INVALID_ARG_VALUE",dT="ERR_INVALID_ARG_TYPE";function dU(a,b,c){let d=TypeError(a,{cause:c});return Object.assign(d,{code:b}),d}class dV extends Error{code;constructor(a,b){super(a,b),this.name=this.constructor.name,this.code=b?.code,Error.captureStackTrace?.(this,this.constructor)}}function dW(a,b,c){return new dV(a,{cause:b,code:c})}function dX(a){if(a instanceof TypeError||a instanceof dV||a instanceof aV||a instanceof aW||a instanceof aX)throw a;if(a instanceof am)switch(a.code){case bA:throw dW("only requests to HTTPS are allowed",a,a.code);case bB:throw dW("only requests to HTTP or HTTPS are allowed",a,a.code);case bz:throw dW("unexpected HTTP response status code",a.cause,a.code);case by:throw dW("unexpected response content-type",a.cause,a.code);case bw:throw dW("parsing error occured",a,a.code);case bx:throw dW("invalid response encountered",a,a.code);case bD:throw dW("unexpected JWT claim value encountered",a,a.code);case bE:throw dW("unexpected JSON attribute value encountered",a,a.code);case bC:throw dW("JWT timestamp claim value failed validation",a,a.code);default:throw dW(a.message,a,a.code)}if(a instanceof al)throw dW("unsupported operation",a,a.code);if(a instanceof DOMException)switch(a.name){case"OperationError":throw dW("runtime operation error",a,bu);case"NotSupportedError":throw dW("runtime unsupported operation",a,bu);case"TimeoutError":throw dW("operation timed out",a,"OAUTH_TIMEOUT");case"AbortError":throw dW("operation aborted",a,"OAUTH_ABORT")}throw new dV("something went wrong",{cause:a})}new TextDecoder;let dY=Symbol();class dZ{constructor(a,b,c,d){let e;if("string"!=typeof b||!b.length)throw dU('"clientId" must be a non-empty string',dT);if("string"==typeof c&&(c={client_secret:c}),c?.client_id!==void 0&&b!==c.client_id)throw dU('"clientId" and "metadata.client_id" must be the same',dS);const f={...structuredClone(c),client_id:b};f[ac]=c?.[ac]??0,f[ad]=c?.[ad]??30,e=d||("string"==typeof f.client_secret&&f.client_secret.length?function(a){return void 0!==a?aJ(a):(j||=new WeakMap,(a,b,c,d)=>{let e;return(e=j.get(b))||(function(a,b){if("string"!=typeof a)throw dU(`${b} must be a string`,dT);if(0===a.length)throw dU(`${b} must not be empty`,dS)}(b.client_secret,'"metadata.client_secret"'),e=aJ(b.client_secret),j.set(b,e)),e(a,b,c,d)})}(f.client_secret):(a,b,c,d)=>{c.set("client_id",b.client_id)});let g=Object.freeze(f);const h=structuredClone(a);dY in a&&(h[bW]=({claims:{tid:b}})=>a.issuer.replace("{tenantid}",b));let k=Object.freeze(h);(i||=new WeakMap).set(this,{__proto__:null,as:k,c:g,auth:e,tlsOnly:!0,jwksCache:{}})}serverMetadata(){let a=structuredClone(i.get(this).as);return Object.defineProperties(a,{supportsPKCE:{__proto__:null,value:(b="S256")=>a.code_challenge_methods_supported?.includes(b)===!0}}),a}clientMetadata(){return structuredClone(i.get(this).c)}get timeout(){return i.get(this).timeout}set timeout(a){i.get(this).timeout=a}get[ae](){return i.get(this).fetch}set[ae](a){i.get(this).fetch=a}}async function d$(a,b,c,d=!1){let e,f=a.headers.get("retry-after")?.trim();if(void 0!==f){if(/^\d+$/.test(f))e=parseInt(f,10);else{let a=new Date(f);if(Number.isFinite(a.getTime())){let b=new Date,c=a.getTime()-b.getTime();c>0&&(e=Math.ceil(c/1e3))}}if(d&&!Number.isFinite(e))throw new am("invalid Retry-After header value",{cause:a});e>b&&await d_(e-b,c)}}function d_(a,b){return new Promise((c,d)=>{let e=a=>{try{b.throwIfAborted()}catch(a){d(a);return}if(a<=0)return void c();let f=Math.min(a,5);setTimeout(()=>e(a-f),1e3*f)};e(a)})}async function d0(a,b){d2(a);let{as:c,c:d,auth:e,fetch:f,tlsOnly:g,timeout:j}=i.get(a);return bQ(c,d,e,b,{[ae]:f,[ab]:!g,headers:new Headers(h),signal:d3(j)}).then(a=>bR(c,d,a)).catch(dX)}async function d1(a,b,c,d){var e,f,g;let j;d2(a),c=new URLSearchParams(c);let k=b.interval??5,l=d?.signal??AbortSignal.timeout(1e3*b.expires_in);try{await d_(k,l)}catch(a){dX(a)}let{as:m,c:n,auth:o,fetch:p,tlsOnly:q,nonRepudiation:r,timeout:s,decrypt:t}=i.get(a),u=(e,f)=>d1(a,{...b,interval:e},c,{...d,signal:l,flag:f}),v=await bS(m,n,o,b.auth_req_id,{[ae]:p,[ab]:!q,additionalParameters:c,DPoP:d?.DPoP,headers:new Headers(h),signal:l.aborted?l:d3(s)}).catch(dX);if(503===v.status&&v.headers.has("retry-after"))return await d$(v,k,l,!0),await v.body?.cancel(),u(k);let w=bT(m,n,v,{[ag]:t});try{j=await w}catch(a){if(f=a,g=d,g?.DPoP&&g.flag!==d4&&aT(f))return u(k,d4);if(a instanceof aV)switch(a.error){case"slow_down":k+=5;case"authorization_pending":return await d$(a.response,k,l),u(k)}dX(a)}return j.id_token&&await r?.(v),Object.defineProperties(e=j,function(a){let b;if(void 0!==a.expires_in){let c=new Date;c.setSeconds(c.getSeconds()+a.expires_in),b=c.getTime()}return{expiresIn:{__proto__:null,value(){if(b){let a=Date.now();return b>a?Math.floor((b-a)/1e3):0}}},claims:{__proto__:null,value(){try{return bc(this)}catch{return}}}}}(e)),j}function d2(a){if(!(a instanceof dZ))throw dU('"config" must be an instance of Configuration',dT);if(Object.getPrototypeOf(a)!==dZ.prototype)throw dU("subclassing Configuration is not allowed",dS)}function d3(a){return a?AbortSignal.timeout(1e3*a):void 0}Object.freeze(dZ.prototype);let d4=Symbol();var d5=a.i(372418);function d6(a,b,c=[]){let d=new URLSearchParams,e={...a,...b};return Object.entries(e).forEach(([a,b])=>{c&&(c.includes(a)||null==b)||("scope"===a&&"object"==typeof b&&(b=b$(b,e.audience)),b&&d.set(a,String(b)))}),d}function d7(a){return a&&!a.endsWith("/")?`${a}/`:a}function d8(a){return a&&a.startsWith("/")?a.substring(1,a.length):a}(p=v||(v={})).SUBJECT_TYPE_REFRESH_TOKEN="urn:ietf:params:oauth:token-type:refresh_token",p.SUBJECT_TYPE_ACCESS_TOKEN="urn:ietf:params:oauth:token-type:access_token",(q=w||(w={})).CODE="code",q.CONNECT_CODE="connect_code";let d9=new Set(["accept","accept-language","content-language","content-type","user-agent","cache-control","if-match","if-none-match","if-modified-since","if-unmodified-since","etag","x-request-id","x-correlation-id","traceparent","tracestate","x-forwarded-for","x-forwarded-host","x-forwarded-proto","x-real-ip","origin","access-control-request-method","access-control-request-headers"]),ea=new Set(["connection","keep-alive","proxy-authenticate","proxy-authorization","te","trailer","transfer-encoding","upgrade"]);function eb(a){let b=new Headers;return a.headers.forEach((a,c)=>{let d=c.toLowerCase();d9.has(d)&&!ea.has(d)&&b.set(c,a)}),b}function ec(a){let b=new Headers;return a.headers.forEach((a,c)=>{let d=c.toLowerCase();ea.has(d)||b.set(c,a)}),b}function ed(a,b){let c=b.targetBaseUrl,d=a.nextUrl.pathname.startsWith(b.proxyPath)?a.nextUrl.pathname.slice(b.proxyPath.length):a.nextUrl.pathname;d&&!d.startsWith("/")&&(d="/"+d);let e=new URL(c.replace(/\/$/,"")),f=e.pathname,g=f;if(d&&"/"!==d){let a=f.split("/").filter(Boolean),b=d.split("/").filter(Boolean),c=0,e=Math.min(a.length,b.length);for(let d=e;d>=1;d--){let e=a.slice(-d),f=b.slice(0,d);if(e.every((a,b)=>a===f[b])){c=d;break}}let h=b.slice(c);if(h.length>0){let a="/"===f||f.endsWith("/")?"":"/";g=f+a+h.join("/")}}let h=new URL(e.origin+g);return a.nextUrl.searchParams.forEach((a,b)=>{h.searchParams.set(b,a)}),h}function ee(a,b){let c;try{c=new URL(a,b)}catch(a){return}if(c.origin===b.origin)return c}function ef(a){var b;let c=["path"in a&&a.path&&`Path=${a.path}`,"expires"in a&&(a.expires||0===a.expires)&&`Expires=${("number"==typeof a.expires?new Date(a.expires):a.expires).toUTCString()}`,"maxAge"in a&&"number"==typeof a.maxAge&&`Max-Age=${a.maxAge}`,"domain"in a&&a.domain&&`Domain=${a.domain}`,"secure"in a&&a.secure&&"Secure","httpOnly"in a&&a.httpOnly&&"HttpOnly","sameSite"in a&&a.sameSite&&`SameSite=${a.sameSite}`,"partitioned"in a&&a.partitioned&&"Partitioned","priority"in a&&a.priority&&`Priority=${a.priority}`].filter(Boolean),d=`${a.name}=${encodeURIComponent(null!=(b=a.value)?b:"")}`;return 0===c.length?d:`${d}; ${c.join("; ")}`}function eg(a){let b=new Map;for(let c of a.split(/; */)){if(!c)continue;let a=c.indexOf("=");if(-1===a){b.set(c,"true");continue}let[d,e]=[c.slice(0,a),c.slice(a+1)];try{b.set(d,decodeURIComponent(null!=e?e:"true"))}catch{}}return b}var eh=["strict","lax","none"],ei=["low","medium","high"],ej=class{constructor(a){this._parsed=new Map,this._headers=a;const b=a.get("cookie");if(b)for(const[a,c]of eg(b))this._parsed.set(a,{name:a,value:c})}[Symbol.iterator](){return this._parsed[Symbol.iterator]()}get size(){return this._parsed.size}get(...a){let b="string"==typeof a[0]?a[0]:a[0].name;return this._parsed.get(b)}getAll(...a){var b;let c=Array.from(this._parsed);if(!a.length)return c.map(([a,b])=>b);let d="string"==typeof a[0]?a[0]:null==(b=a[0])?void 0:b.name;return c.filter(([a])=>a===d).map(([a,b])=>b)}has(a){return this._parsed.has(a)}set(...a){let[b,c]=1===a.length?[a[0].name,a[0].value]:a,d=this._parsed;return d.set(b,{name:b,value:c}),this._headers.set("cookie",Array.from(d).map(([a,b])=>ef(b)).join("; ")),this}delete(a){let b=this._parsed,c=Array.isArray(a)?a.map(a=>b.delete(a)):b.delete(a);return this._headers.set("cookie",Array.from(b).map(([a,b])=>ef(b)).join("; ")),c}clear(){return this.delete(Array.from(this._parsed.keys())),this}[Symbol.for("edge-runtime.inspect.custom")](){return`RequestCookies ${JSON.stringify(Object.fromEntries(this._parsed))}`}toString(){return[...this._parsed.values()].map(a=>`${a.name}=${encodeURIComponent(a.value)}`).join("; ")}},ek=class{constructor(a){var b,c,d;this._parsed=new Map,this._headers=a;const e=null!=(d=null!=(c=null==(b=a.getSetCookie)?void 0:b.call(a))?c:a.get("set-cookie"))?d:[];for(const a of Array.isArray(e)?e:function(a){if(!a)return[];var b,c,d,e,f,g=[],h=0;function i(){for(;h<a.length&&/\s/.test(a.charAt(h));)h+=1;return h<a.length}for(;h<a.length;){for(b=h,f=!1;i();)if(","===(c=a.charAt(h))){for(d=h,h+=1,i(),e=h;h<a.length&&"="!==(c=a.charAt(h))&&";"!==c&&","!==c;)h+=1;h<a.length&&"="===a.charAt(h)?(f=!0,h=e,g.push(a.substring(b,d)),b=h):h=d+1}else h+=1;(!f||h>=a.length)&&g.push(a.substring(b,a.length))}return g}(e)){const b=function(a){var b,c;if(!a)return;let[[d,e],...f]=eg(a),{domain:g,expires:h,httponly:i,maxage:j,path:k,samesite:l,secure:m,partitioned:n,priority:o}=Object.fromEntries(f.map(([a,b])=>[a.toLowerCase().replace(/-/g,""),b]));return function(a){let b={};for(let c in a)a[c]&&(b[c]=a[c]);return b}({name:d,value:decodeURIComponent(e),domain:g,...h&&{expires:new Date(h)},...i&&{httpOnly:!0},..."string"==typeof j&&{maxAge:Number(j)},path:k,...l&&{sameSite:(b=(b=l).toLowerCase(),eh.includes(b)?b:void 0)},...m&&{secure:!0},...o&&{priority:(c=(c=o).toLowerCase(),ei.includes(c)?c:void 0)},...n&&{partitioned:!0}})}(a);b&&this._parsed.set(b.name,b)}}get(...a){let b="string"==typeof a[0]?a[0]:a[0].name;return this._parsed.get(b)}getAll(...a){var b;let c=Array.from(this._parsed.values());if(!a.length)return c;let d="string"==typeof a[0]?a[0]:null==(b=a[0])?void 0:b.name;return c.filter(a=>a.name===d)}has(a){return this._parsed.has(a)}set(...a){let[b,c,d]=1===a.length?[a[0].name,a[0].value,a[0]]:a,e=this._parsed;return e.set(b,function(a={name:"",value:""}){return"number"==typeof a.expires&&(a.expires=new Date(a.expires)),a.maxAge&&(a.expires=new Date(Date.now()+1e3*a.maxAge)),(null===a.path||void 0===a.path)&&(a.path="/"),a}({name:b,value:c,...d})),function(a,b){for(let[,c]of(b.delete("set-cookie"),a)){let a=ef(c);b.append("set-cookie",a)}}(e,this._headers),this}delete(...a){let[b,c]="string"==typeof a[0]?[a[0]]:[a[0].name,a[0]];return this.set({...c,name:b,value:"",expires:new Date(0)})}[Symbol.for("edge-runtime.inspect.custom")](){return`ResponseCookies ${JSON.stringify(Object.fromEntries(this._parsed))}`}toString(){return[...this._parsed.values()].map(ef).join("; ")}};"function"!=typeof Y.hkdf||process.versions.electron||(k=async(...a)=>new Promise((b,c)=>{Y.hkdf(...a,(a,d)=>{a?c(a):b(new Uint8Array(d))})}));let el=async(a,b,c,d,e)=>(k||((a,b,c,d,e)=>{let f=parseInt(a.substr(3),10)>>3||20,g=(0,Y.createHmac)(a,c.byteLength?c:new Uint8Array(f)).update(b).digest(),h=Math.ceil(e/f),i=new Uint8Array(f*h+d.byteLength+1),j=0,k=0;for(let b=1;b<=h;b++)i.set(d,k),i[k+d.byteLength]=b,i.set((0,Y.createHmac)(a,g).update(i.subarray(j,k+d.byteLength+1)).digest(),k),j=k,k+=f;return i.slice(0,e)}))(a,b,c,d,e);function em(a,b){if("string"==typeof a)return new TextEncoder().encode(a);if(!(a instanceof Uint8Array))throw TypeError(`"${b}"" must be an instance of Uint8Array or a string`);return a}async function en(a,b,c,d,e){return el(function(a){switch(a){case"sha256":case"sha384":case"sha512":case"sha1":return a;default:throw TypeError('unsupported "digest" value')}}(a),function(a){let b=em(a,"ikm");if(!b.byteLength)throw TypeError('"ikm" must be at least one byte in length');return b}(b),em(c,"salt"),function(a){let b=em(a,"info");if(b.byteLength>1024)throw TypeError('"info" must not contain more than 1024 bytes');return b}(d),function(a,b){if("number"!=typeof a||!Number.isInteger(a)||a<1)throw TypeError('"keylen" must be a positive integer');if(a>255*(parseInt(b.substr(3),10)>>3||20))throw TypeError('"keylen" too large');return a}(e,a))}let eo=Symbol();async function ep(a,b,c,d,e={}){let f,g,h;switch(a){case"dir":h=c;break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{let i;if(cp(c),!dB(c))throw new ce("ECDH with the provided key is not allowed or not supported by your javascript runtime");let{apu:j,apv:k}=e;i=e.epk?await db(e.epk,a):(await crypto.subtle.generateKey(c.algorithm,!0,["deriveBits"])).privateKey;let{x:l,y:m,crv:n,kty:o}=await cI(i),p=await dA(c,i,"ECDH-ES"===a?b:a,"ECDH-ES"===a?dI(b):parseInt(a.slice(-5,-2),10),j,k);if(g={epk:{x:l,crv:n,kty:o}},"EC"===o&&(g.epk.y=m),j&&(g.apu=cG(j)),k&&(g.apv=cG(k)),"ECDH-ES"===a){h=p;break}h=d||dJ(b);let q=a.slice(-6);f=await dw(q,p,h);break}case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":h=d||dJ(b),cp(c),f=await dG(a,c,h);break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{h=d||dJ(b);let{p2c:i,p2s:j}=e;({encryptedKey:f,...g}=await dD(a,c,h,i,j));break}case"A128KW":case"A192KW":case"A256KW":h=d||dJ(b),f=await dw(a,c,h);break;case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{h=d||dJ(b);let{iv:i}=e;({encryptedKey:f,...g}=await dN(a,c,h,i));break}default:throw new ce('Invalid or unsupported "alg" (JWE Algorithm) header value')}return{cek:h,encryptedKey:f,parameters:g}}class eq{#w;#x;#y;#z;#A;#B;#C;#D;constructor(a){if(!(a instanceof Uint8Array))throw TypeError("plaintext must be an instance of Uint8Array");this.#w=a}setKeyManagementParameters(a){if(this.#D)throw TypeError("setKeyManagementParameters can only be called once");return this.#D=a,this}setProtectedHeader(a){if(this.#x)throw TypeError("setProtectedHeader can only be called once");return this.#x=a,this}setSharedUnprotectedHeader(a){if(this.#y)throw TypeError("setSharedUnprotectedHeader can only be called once");return this.#y=a,this}setUnprotectedHeader(a){if(this.#z)throw TypeError("setUnprotectedHeader can only be called once");return this.#z=a,this}setAdditionalAuthenticatedData(a){return this.#A=a,this}setContentEncryptionKey(a){if(this.#B)throw TypeError("setContentEncryptionKey can only be called once");return this.#B=a,this}setInitializationVector(a){if(this.#C)throw TypeError("setInitializationVector can only be called once");return this.#C=a,this}async encrypt(a,b){let c,d,e,f,g,h;if(!this.#x&&!this.#z&&!this.#y)throw new cg("either setProtectedHeader, setUnprotectedHeader, or sharedUnprotectedHeader must be called before #encrypt()");if(!c4(this.#x,this.#z,this.#y))throw new cg("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");let i={...this.#x,...this.#z,...this.#y};if(c8(cg,new Map,b?.crit,this.#x,i),void 0!==i.zip)throw new ce('JWE "zip" (Compression Algorithm) Header Parameter is not supported.');let{alg:j,enc:k}=i;if("string"!=typeof j||!j)throw new cg('JWE "alg" (Algorithm) Header Parameter missing or invalid');if("string"!=typeof k||!k)throw new cg('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');if(this.#B&&("dir"===j||"ECDH-ES"===j))throw TypeError(`setContentEncryptionKey cannot be called with JWE "alg" (Algorithm) Header ${j}`);c7("dir"===j?k:j,a,"encrypt");{let e,f=await db(a,j);({cek:d,encryptedKey:c,parameters:e}=await ep(j,k,f,this.#B,this.#D)),e&&(b&&eo in b?this.#z?this.#z={...this.#z,...e}:this.setUnprotectedHeader(e):this.#x?this.#x={...this.#x,...e}:this.setProtectedHeader(e))}if(this.#x?g=cE(f=cG(JSON.stringify(this.#x))):(f="",g=new Uint8Array),this.#A){let a=cE(h=cG(this.#A));e=cA(g,cE("."),a)}else e=g;let{ciphertext:l,tag:m,iv:n}=await dM(k,this.#w,d,this.#C,e),o={ciphertext:cG(l)};return n&&(o.iv=cG(n)),m&&(o.tag=cG(m)),c&&(o.encrypted_key=cG(c)),h&&(o.aad=h),this.#x&&(o.protected=f),this.#y&&(o.unprotected=this.#y),this.#z&&(o.header=this.#z),o}}class er{#E;constructor(a){this.#E=new eq(a)}setContentEncryptionKey(a){return this.#E.setContentEncryptionKey(a),this}setInitializationVector(a){return this.#E.setInitializationVector(a),this}setProtectedHeader(a){return this.#E.setProtectedHeader(a),this}setKeyManagementParameters(a){return this.#E.setKeyManagementParameters(a),this}async encrypt(a,b){let c=await this.#E.encrypt(a,b);return[c.protected,c.encrypted_key,c.iv,c.ciphertext,c.tag].join(".")}}class es{#B;#C;#D;#x;#F;#G;#H;#I;constructor(a={}){this.#I=new dk(a)}setIssuer(a){return this.#I.iss=a,this}setSubject(a){return this.#I.sub=a,this}setAudience(a){return this.#I.aud=a,this}setJti(a){return this.#I.jti=a,this}setNotBefore(a){return this.#I.nbf=a,this}setExpirationTime(a){return this.#I.exp=a,this}setIssuedAt(a){return this.#I.iat=a,this}setProtectedHeader(a){if(this.#x)throw TypeError("setProtectedHeader can only be called once");return this.#x=a,this}setKeyManagementParameters(a){if(this.#D)throw TypeError("setKeyManagementParameters can only be called once");return this.#D=a,this}setContentEncryptionKey(a){if(this.#B)throw TypeError("setContentEncryptionKey can only be called once");return this.#B=a,this}setInitializationVector(a){if(this.#C)throw TypeError("setInitializationVector can only be called once");return this.#C=a,this}replicateIssuerAsHeader(){return this.#F=!0,this}replicateSubjectAsHeader(){return this.#G=!0,this}replicateAudienceAsHeader(){return this.#H=!0,this}async encrypt(a,b){let c=new er(this.#I.data());return this.#x&&(this.#F||this.#G||this.#H)&&(this.#x={...this.#x,iss:this.#F?this.#I.iss:void 0,sub:this.#G?this.#I.sub:void 0,aud:this.#H?this.#I.aud:void 0}),c.setProtectedHeader(this.#x),this.#C&&c.setInitializationVector(this.#C),this.#B&&c.setContentEncryptionKey(this.#B),this.#D&&c.setKeyManagementParameters(this.#D),c.encrypt(a,b)}}async function et(a,b,c){let d=await dR(a,b,c),e=dj(d.protectedHeader,d.plaintext,c),{protectedHeader:f}=d;if(void 0!==f.iss&&f.iss!==e.iss)throw new cb('replicated "iss" claim header parameter mismatch',e,"iss","mismatch");if(void 0!==f.sub&&f.sub!==e.sub)throw new cb('replicated "sub" claim header parameter mismatch',e,"sub","mismatch");if(void 0!==f.aud&&JSON.stringify(f.aud)!==JSON.stringify(e.aud))throw new cb('replicated "aud" claim header parameter mismatch',e,"aud","mismatch");let g={payload:e,protectedHeader:f};return"function"==typeof b?{...g,key:d.key}:g}var eu=a.i(509634),eu=eu;let ev="sha256",ew="JWE CEK";async function ex(a,b,c,d){let e=await en(ev,b,"",ew,32);return(await new es(a).setProtectedHeader({enc:"A256GCM",alg:"dir",...d}).setExpirationTime(c).encrypt(e)).toString()}async function ey(a,b,c){try{let d=await en(ev,b,"",ew,32);return await et(a,d,{...c,clockTolerance:15})}catch(a){if("ERR_JWT_EXPIRED"===a.code)return null;throw a}}async function ez(a,b,c){if(!b)return;let[d,e]=b.split("."),f={protected:eu.encode(JSON.stringify({alg:"HS256",b64:!1,crit:["b64"]})),payload:`${a}=${d}`,signature:e},g=await en("sha256",c,"","JWS Cookie Signing",32);try{return await dc(f,g,{algorithms:["HS256"]}),d}catch(a){return}}let eA=RegExp("__(\\d+)$"),eB=/\.(\d+)$/,eC=(a,b)=>{let c=b?eB.exec(a):eA.exec(a);if(c)return parseInt(c[1],10)},eD=(a,b,c)=>{let d=new RegExp(c?`^${b}${eB.source}$`:`^${b}__\\d+$`);return a.getAll().filter(a=>d.test(a.name))};function eE(a,b,c){let d=b.get(a);if(d?.value)return d.value;let e=eD(b,a,c).sort((a,b)=>eC(a.name,c)-eC(b.name,c));if(0===e.length)return;let f=eC(e[e.length-1].name,c);return e.length!==f+1?void console.warn(`Incomplete chunked cookie '${a}': Found ${e.length} chunks, expected ${f+1}`):e.map(a=>a.value).join("")}function eF(a,b,c,d,e){eH(c,a,e),eD(b,a,d).forEach(a=>{eH(c,a.name,e)})}function eG(a){a.headers.set("Cache-Control","private, no-cache, no-store, must-revalidate, max-age=0"),a.headers.set("Pragma","no-cache"),a.headers.set("Expires","0")}function eH(a,b,c){let d={maxAge:0};c?.domain&&(d.domain=c.domain),c?.path&&(d.path=c.path),a.set(b,"",d)}class eI{constructor(a,b){this.hooks=b,this.config={...a,fetch:a.fetch||fetch}}isAbsoluteUrl(a){try{return new URL(a),!0}catch{return!1}}buildUrl(a,b){if(b){if(this.isAbsoluteUrl(b))return b;if(a)return`${a.replace(/\/?\/$/,"")}/${b.replace(/^\/+/,"")}`}throw TypeError("`url` must be absolute or `baseUrl` non-empty.")}getAccessToken(a){return this.config.getAccessToken?this.config.getAccessToken(a??{}):this.hooks.getAccessToken(a??{})}buildBaseRequest(a,b){let c;return c=a instanceof Request?a.url:a instanceof URL?a.toString():this.config.baseUrl&&!this.isAbsoluteUrl(a)?this.buildUrl(this.config.baseUrl,a):a,new Request(c,b)}getHeader(a,b){return Array.isArray(a)?new Headers(a).get(b)||"":"function"==typeof a.get?a.get(b)||"":a[b]||""}async internalFetchWithAuth(a,b,c,d){let e,f,g=this.buildBaseRequest(a,b),h=await this.getAccessToken(d);"string"==typeof h?(e=!!this.config.dpopHandle,f=h):(e=!!this.config.dpopHandle&&h.token_type?.toLowerCase()==="dpop",f=h.accessToken);try{return await a6(f,g.method,new URL(g.url),g.headers,g.body,{...this.config.httpOptions(),[ae]:(a,b)=>this.config.fetch(a,b),[ab]:this.config.allowInsecureRequests||!1,...e&&{DPoP:this.config.dpopHandle}})}catch(a){if(aT(a)&&c.onUseDpopNonceError)return c.onUseDpopNonceError();throw a}}isRequestInit(a){return!!a&&"object"==typeof a&&!["refresh","scope","audience"].some(b=>Object.prototype.hasOwnProperty.call(a,b))}fetchWithAuth(a,b,c){let d,e;2==arguments.length&&void 0!==b?this.isRequestInit(b)?(d=b,e=void 0):(d=void 0,e=b):(d=b,e=c);let f={onUseDpopNonceError:async()=>{let b=this.config.retryConfig??{delay:100,jitter:!0},c=b.delay??100;b.jitter&&(c*=.5+.5*Math.random()),await new Promise(a=>setTimeout(a,c));try{return await this.internalFetchWithAuth(a,d,{...f,onUseDpopNonceError:void 0},e)}catch(a){if(aT(a)){let b=Error(`DPoP nonce error persisted after retry: ${a.message}`);throw b.code=a.code||"dpop_nonce_retry_failed",b}throw a}}};return this.internalFetchWithAuth(a,d,f,e)}}let eJ=["sub","name","nickname","given_name","family_name","picture","email","email_verified","org_id"];var eK=function(a,b,c,d){if("a"===c&&!d)throw TypeError("Private accessor was defined without a getter");if("function"==typeof b?a!==b||!d:!b.has(a))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===c?d:"a"===c?d.call(a):d?d.value:b.get(a)};let eL=["client_id","redirect_uri","response_type","code_challenge","code_challenge_method","state","nonce"];function eM(a,b){return new URL(d8((a=>{let b=process.env.NEXT_PUBLIC_BASE_PATH;return b?d7(b&&!b.startsWith("/")?`/${b}`:b)+d8(a):a})(a)),d7(b))}class eN{constructor(a){x.add(this),this.proxyFetchers={},this.fetch=a.fetch||fetch,this.jwksCache=a.jwksCache||{},this.allowInsecureRequests=a.allowInsecureRequests??!1,this.httpTimeout=a.httpTimeout??5e3,this.httpOptions=()=>{let b=new Headers;if(a.enableTelemetry??!0){let a="nextjs-auth0",c=d5.default.version;b.set("User-Agent",`${a}/${c}`),b.set("Auth0-Client",eO(JSON.stringify({name:a,version:c})))}return{signal:AbortSignal.timeout(this.httpTimeout),headers:b}},this.allowInsecureRequests&&console.warn("allowInsecureRequests is enabled in a production environment. This is not recommended."),this.transactionStore=a.transactionStore,this.sessionStore=a.sessionStore,this.domain=a.domain,this.clientMetadata={client_id:a.clientId},a.dpopOptions&&("number"==typeof a.dpopOptions.clockSkew&&(this.clientMetadata[ac]=a.dpopOptions.clockSkew),"number"==typeof a.dpopOptions.clockTolerance&&(this.clientMetadata[ad]=a.dpopOptions.clockTolerance)),this.dpopOptions=a.dpopOptions,this.clientSecret=a.clientSecret,this.authorizationParameters=a.authorizationParameters||{scope:X},this.pushedAuthorizationRequests=a.pushedAuthorizationRequests??!1,this.clientAssertionSigningKey=a.clientAssertionSigningKey,this.clientAssertionSigningAlg=a.clientAssertionSigningAlg||"RS256",this.authorizationParameters.scope=function(a){if(!a.scope)return X;if("object"==typeof a.scope&&!b$(a.scope,a.audience)){let b=a.audience;return{...a.scope,[b]:X}}return a.scope}(this.authorizationParameters);const b=b$(this.authorizationParameters.scope,this.authorizationParameters.audience)?.split(" ").map(a=>a.trim());if(!b||!b.includes("openid"))throw Error("The 'openid' scope must be included in the set of scopes. See https://auth0.com/docs");this.appBaseUrl=a.appBaseUrl,this.signInReturnToPath=a.signInReturnToPath||"/";const c=["auto","oidc","v2"];let d=a.logoutStrategy||"auto";c.includes(d)||(console.error(`Invalid logoutStrategy: ${d}. Must be one of: ${c.join(", ")}. Defaulting to "auto"`),d="auto"),this.logoutStrategy=d,this.includeIdTokenHintInOIDCLogoutUrl=a.includeIdTokenHintInOIDCLogoutUrl??!0,this.beforeSessionSaved=a.beforeSessionSaved,this.onCallback=a.onCallback||this.defaultOnCallback,this.routes=a.routes,this.enableAccessTokenEndpoint=a.enableAccessTokenEndpoint??!0,this.noContentProfileResponseWhenUnauthenticated=a.noContentProfileResponseWhenUnauthenticated??!1,this.enableConnectAccountEndpoint=a.enableConnectAccountEndpoint??!1,this.useDPoP=a.useDPoP??!1,a.useDPoP&&a.dpopKeyPair&&(this.dpopKeyPair=a.dpopKeyPair)}async handler(a){let b,{pathname:c}=a.nextUrl,d=a.nextUrl.basePath;d&&c.startsWith(d)&&(c=c.slice(d.length)||"/");let e=(b=c).endsWith("/")?b.slice(0,-1):b,f=a.method;if("GET"===f&&e===this.routes.login)return this.handleLogin(a);{if("GET"===f&&e===this.routes.logout)return this.handleLogout(a);if("GET"===f&&e===this.routes.callback)return this.handleCallback(a);if("GET"===f&&e===this.routes.profile)return this.handleProfile(a);if("GET"===f&&e===this.routes.accessToken&&this.enableAccessTokenEndpoint)return this.handleAccessToken(a);if("POST"===f&&e===this.routes.backChannelLogout)return this.handleBackChannelLogout(a);if("GET"===f&&e===this.routes.connectAccount&&this.enableConnectAccountEndpoint)return this.handleConnectAccount(a);if(e.startsWith("/me/"))return this.handleMyAccount(a);if(e.startsWith("/my-org/"))return this.handleMyOrg(a);let b=F.NextResponse.next(),c=await this.sessionStore.get(a.cookies);return c&&(await this.sessionStore.set(a.cookies,b.cookies,{...c}),eG(b)),b}}async startInteractiveLogin(a={}){let b=eM(this.routes.callback,this.appBaseUrl),c=this.signInReturnToPath;if(a.returnTo){let b=new URL(this.authorizationParameters.redirect_uri||this.appBaseUrl),d=ee(a.returnTo,b);d&&(c=d.pathname+d.search+d.hash)}let d=aB(),e=await aC(d),f=aB(),g=aB(),h=d6(this.authorizationParameters,a.authorizationParameters,eL);if(h.set("client_id",this.clientMetadata.client_id),h.set("redirect_uri",b.toString()),h.set("response_type",w.CODE),h.set("code_challenge",e),h.set("code_challenge_method","S256"),h.set("state",f),h.set("nonce",g),this.dpopKeyPair)try{let a=await cI(this.dpopKeyPair.publicKey),b=await cN(a);h.set("dpop_jkt",b)}catch(a){throw new U(t.DPOP_JKT_CALCULATION_FAILED,"DPoP is enabled but failed to calculate key thumbprint (dpop_jkt). This is required for secure DPoP binding. Please check your key configuration.",a instanceof Error?a:void 0)}let i={nonce:g,maxAge:this.authorizationParameters.max_age,codeVerifier:d,responseType:w.CODE,state:f,returnTo:c,scope:h.get("scope")||void 0,audience:h.get("audience")||void 0},[j,k]=await this.authorizationUrl(h);if(j)return new F.NextResponse("An error occurred while trying to initiate the login request.",{status:500});let l=F.NextResponse.redirect(k.toString());return await this.transactionStore.save(l.cookies,i),l}async handleLogin(a){let{returnTo:b,...c}=Object.fromEntries(a.nextUrl.searchParams.entries());return this.startInteractiveLogin({authorizationParameters:c,returnTo:b})}async handleLogout(a){let b,c=await this.sessionStore.get(a.cookies),[d,e]=await this.discoverAuthorizationServerMetadata();if(d){let b=new F.NextResponse("An error occurred while trying to initiate the logout request.",{status:500});return await this.sessionStore.delete(a.cookies,b.cookies),await this.transactionStore.deleteAll(a.cookies,b.cookies),b}let f=a.nextUrl.searchParams.get("returnTo")||this.appBaseUrl,g=a.nextUrl.searchParams.has("federated"),h=()=>{let a=new URL("/v2/logout",this.issuer);return a.searchParams.set("returnTo",f),a.searchParams.set("client_id",this.clientMetadata.client_id),g&&a.searchParams.set("federated",""),F.NextResponse.redirect(a)},i=()=>{let a=new URL(e.end_session_endpoint);return a.searchParams.set("client_id",this.clientMetadata.client_id),a.searchParams.set("post_logout_redirect_uri",f),c?.internal.sid&&a.searchParams.set("logout_hint",c.internal.sid),this.includeIdTokenHintInOIDCLogoutUrl&&c?.tokenSet.idToken&&a.searchParams.set("id_token_hint",c.tokenSet.idToken),g&&a.searchParams.set("federated",""),F.NextResponse.redirect(a)};if("v2"===this.logoutStrategy)b=h();else if("oidc"===this.logoutStrategy){if(!e.end_session_endpoint){let b=new F.NextResponse("OIDC RP-Initiated Logout is not supported by the authorization server. Enable it or use a different logout strategy.",{status:500});return await this.sessionStore.delete(a.cookies,b.cookies),await this.transactionStore.deleteAll(a.cookies,b.cookies),b}b=i()}else e.end_session_endpoint?b=i():(console.warn("The Auth0 client does not have RP-initiated logout enabled, the user will be redirected to the `/v2/logout` endpoint instead. Learn how to enable it here: https://auth0.com/docs/authenticate/login/logout/log-users-out-of-auth0#enable-endpoint-discovery"),b=h());return await this.sessionStore.delete(a.cookies,b.cookies),eG(b),await this.transactionStore.deleteAll(a.cookies,b.cookies),b}async handleCallback(a){let b,c,d,e,f,g=a.nextUrl.searchParams.get("state");if(!g)return this.handleCallbackError(new J,{},a);let h=await this.transactionStore.get(a.cookies,g);if(!h)return this.onCallback(new K,{},null);let i=h.payload,j={responseType:i.responseType,returnTo:i.returnTo};if(i.responseType===w.CONNECT_CODE){let b=await this.sessionStore.get(a.cookies);if(!b)return this.handleCallbackError(new W({code:u.MISSING_SESSION,message:"The user does not have an active session."}),j,a,g);let[c,d]=await this.getTokenSet(b,{audience:`${this.issuer}/me/`,scope:"create:me:connected_accounts"});if(c)return this.handleCallbackError(c,j,a,g);let[e,f]=await this.completeConnectAccount({tokenSet:d.tokenSet,authSession:i.authSession,connectCode:a.nextUrl.searchParams.get("connect_code"),redirectUri:eM(this.routes.callback,this.appBaseUrl).toString(),codeVerifier:i.codeVerifier});if(e)return this.handleCallbackError(e,j,a,g);let h=await this.onCallback(null,{...j,connectedAccount:f},b);return await this.transactionStore.delete(h.cookies,g),h}let[k,l]=await this.discoverAuthorizationServerMetadata();if(k)return this.handleCallbackError(k,j,a,g);try{b=function(a,b,c,d){var e;if(aH(a),aI(b),c instanceof URL&&(c=c.searchParams),!(c instanceof URLSearchParams))throw aa('"parameters" must be an instance of URLSearchParams, or URL',_);if(bN(c,"response"))throw an('"parameters" contains a JARM response, use validateJwtAuthResponse() instead of validateAuthResponse()',bx,{parameters:c});let f=bN(c,"iss"),g=bN(c,"state");if(!f&&a.authorization_response_iss_parameter_supported)throw an('response parameter "iss" (issuer) missing',bx,{parameters:c});if(f&&f!==a.issuer)throw an('unexpected "iss" (issuer) response parameter value',bx,{expected:a.issuer,parameters:c});switch(d){case void 0:case bP:if(void 0!==g)throw an('unexpected "state" response parameter encountered',bx,{expected:void 0,parameters:c});break;case bO:break;default:if(ay(d,'"expectedState" argument'),g!==d)throw an(void 0===g?'response parameter "state" missing':'unexpected "state" response parameter value',bx,{expected:d,parameters:c})}if(bN(c,"error"))throw new aW("authorization response from the server is an error",{cause:c});let h=bN(c,"id_token"),i=bN(c,"token");if(void 0!==h||void 0!==i)throw new al("implicit and hybrid flows are not supported");return e=new URLSearchParams(c),bi.add(e),e}(l,this.clientMetadata,a.nextUrl.searchParams,i.state)}catch(b){return this.handleCallbackError(new M({cause:new H({code:b.error,message:b.error_description})}),j,a,g)}try{d=eM(this.routes.callback,this.appBaseUrl);let a=this.useDPoP&&this.dpopKeyPair?aU(this.clientMetadata,this.dpopKeyPair):void 0;e=async()=>bk(l,this.clientMetadata,await this.getClientAuth(),b,d.toString(),i.codeVerifier,{...this.httpOptions(),[ae]:this.fetch,[ab]:this.allowInsecureRequests,...a&&{DPoP:a}}),c=await bZ(e,{isDPoPEnabled:!!a,...this.dpopOptions?.retry})}catch(b){return this.handleCallbackError(new N(b.message),j,a,g)}try{f=await bp(l,this.clientMetadata,c,{expectedNonce:i.nonce,maxAge:i.maxAge,requireIdToken:!0})}catch(b){return this.handleCallbackError(new O({cause:new H({code:b.error,message:b.error_description})}),j,a,g)}let m=bc(f),n={user:m,tokenSet:{accessToken:f.access_token,idToken:f.id_token,scope:f.scope,requestedScope:i.scope,audience:i.audience,refreshToken:f.refresh_token,expiresAt:Math.floor(Date.now()/1e3)+Number(f.expires_in)},internal:{sid:m.sid,createdAt:Math.floor(Date.now()/1e3)}},o=await this.onCallback(null,j,n);return n=await this.finalizeSession(n,f.id_token),await this.sessionStore.set(a.cookies,o.cookies,n,!0),eG(o),await this.transactionStore.delete(o.cookies,g),o}async handleProfile(a){let b=await this.sessionStore.get(a.cookies);if(!b)return this.noContentProfileResponseWhenUnauthenticated?new F.NextResponse(null,{status:204}):new F.NextResponse(null,{status:401});let c=F.NextResponse.json(b?.user);return eG(c),c}async handleAccessToken(a){let b=await this.sessionStore.get(a.cookies),c=a.nextUrl.searchParams.get("audience"),d=a.nextUrl.searchParams.get("scope");if(!b)return F.NextResponse.json({error:{message:"The user does not have an active session.",code:r.MISSING_SESSION}},{status:401});let[e,f]=await this.getTokenSet(b,{scope:d,audience:c});if(e)return F.NextResponse.json({error:{message:e.message,code:e.code}},{status:401});let{tokenSet:g}=f,h=F.NextResponse.json({token:g.accessToken,scope:g.scope,expires_at:g.expiresAt,...g.token_type&&{token_type:g.token_type}});return await eK(this,x,"m",B).call(this,a,h,b,f),h}async handleBackChannelLogout(a){if(!this.sessionStore.store)return new F.NextResponse("A session data store is not configured.",{status:500});if(!this.sessionStore.store.deleteByLogoutToken)return new F.NextResponse("Back-channel logout is not supported by the session data store.",{status:500});let b=new URLSearchParams(await a.text()).get("logout_token");if(!b)return new F.NextResponse("Missing `logout_token` in the request body.",{status:400});let[c,d]=await this.verifyLogoutToken(b);return c?new F.NextResponse(c.message,{status:400}):(await this.sessionStore.store.deleteByLogoutToken(d),new F.NextResponse(null,{status:204}))}async handleConnectAccount(a){let b=await this.sessionStore.get(a.cookies),c=a.nextUrl.searchParams.get("connection"),d=a.nextUrl.searchParams.get("returnTo")??void 0,e=a.nextUrl.searchParams.getAll("scopes"),f=Object.fromEntries([...a.nextUrl.searchParams.entries()].filter(([a])=>"connection"!==a&&"returnTo"!==a&&"scopes"!==a));if(!c)return new F.NextResponse("A connection is required.",{status:400});if(!b)return new F.NextResponse("The user does not have an active session.",{status:401});let[g,h]=await this.getTokenSet(b,{scope:"create:me:connected_accounts",audience:`${this.issuer}/me/`});if(g)return new F.NextResponse("Failed to retrieve a connected account access token.",{status:401});let{tokenSet:i}=h,j={connection:c,authorizationParams:f,returnTo:d};e.length>0&&(j.scopes=e);let[k,l]=await this.connectAccount({tokenSet:i,...j});return k?new F.NextResponse(k.message,{status:k.cause?.status??500}):(await eK(this,x,"m",B).call(this,a,l,b,h),l)}async handleMyAccount(a){return eK(this,x,"m",A).call(this,a,{proxyPath:"/me",targetBaseUrl:`${this.issuer}/me/v1`,audience:`${this.issuer}/me/`,scope:a.headers.get("scope")})}async handleMyOrg(a){return eK(this,x,"m",A).call(this,a,{proxyPath:"/my-org",targetBaseUrl:`${this.issuer}/my-org`,audience:`${this.issuer}/my-org/`,scope:a.headers.get("scope")})}async getTokenSet(a,b={}){let c=b2(b$(this.authorizationParameters.scope,b.audience??this.authorizationParameters.audience),b.scope),d=eK(this,x,"m",y).call(this,a,{scope:c,audience:b.audience??this.authorizationParameters.audience});if(!d.refreshToken&&!d.accessToken)return[new S(r.MISSING_REFRESH_TOKEN,"No access token found and a refresh token was not provided. The user needs to re-authenticate."),null];if(!d.refreshToken&&d.accessToken&&d.expiresAt&&d.expiresAt<=Date.now()/1e3)return[new S(r.MISSING_REFRESH_TOKEN,"The access token has expired and a refresh token was not provided. The user needs to re-authenticate."),null];if(d.refreshToken&&(b.refresh||!d.expiresAt||d.expiresAt<=Date.now()/1e3)){let[a,e]=await eK(this,x,"m",C).call(this,d,{audience:b.audience,scope:b.scope?c:void 0,requestedScope:c});return a?[a,null]:[null,{tokenSet:e.updatedTokenSet,idTokenClaims:e.idTokenClaims}]}return[null,{tokenSet:d,idTokenClaims:void 0}]}async backchannelAuthentication(a){let[b,c]=await this.discoverAuthorizationServerMetadata();if(b)return[b,null];if(!c.backchannel_authentication_endpoint)return[new Q,null];let d=d6(this.authorizationParameters,a.authorizationParams,eL);d.get("scope")||d.set("scope",X),d.set("client_id",this.clientMetadata.client_id),d.set("binding_message",a.bindingMessage),d.set("login_hint",JSON.stringify({format:"iss_sub",iss:c.issuer,sub:a.loginHint.sub})),a.requestedExpiry&&d.append("requested_expiry",a.requestedExpiry.toString()),a.authorizationDetails&&d.append("authorization_details",JSON.stringify(a.authorizationDetails));let[e,f]=await this.getOpenIdClientConfig();if(e)return[e,null];try{let a=await d0(f,d),b=await d1(f,a),c=Math.floor(Date.now()/1e3)+Number(b.expires_in);return[null,{tokenSet:{accessToken:b.access_token,idToken:b.id_token,scope:b.scope,refreshToken:b.refresh_token,expiresAt:c},idTokenClaims:b.claims(),authorizationDetails:b.authorization_details}]}catch(a){return[new R({cause:new H({code:a.error,message:a.error_description})}),null]}}async discoverAuthorizationServerMetadata(){if(this.authorizationServerMetadata)return[null,this.authorizationServerMetadata];let a=new URL(this.issuer);try{let b=await aw(a,{...this.httpOptions(),[ae]:this.fetch,[ab]:this.allowInsecureRequests}).then(b=>az(a,b));return this.authorizationServerMetadata=b,[null,b]}catch(b){return console.error(`An error occurred while performing the discovery request. issuer=${a.toString()}, error:`,b),[new I("Discovery failed for the OpenID Connect configuration."),null]}}async defaultOnCallback(a,b){return a?new F.NextResponse(a.message,{status:500}):F.NextResponse.redirect(eM(b.returnTo||"/",this.appBaseUrl))}async handleCallbackError(a,b,c,d){let e=await this.onCallback(a,b,null);return d&&await this.transactionStore.delete(e.cookies,d),e}async verifyLogoutToken(a){let b,c,[d,e]=await this.discoverAuthorizationServerMetadata();if(d)return[d,null];let f=(b=new cY(new URL(e.jwks_uri),{[cX]:this.jwksCache}),Object.defineProperties(c=async(a,c)=>b.getKey(a,c),{coolingDown:{get:()=>b.coolingDown(),enumerable:!0,configurable:!1},fresh:{get:()=>b.fresh(),enumerable:!0,configurable:!1},reload:{value:()=>b.reload(),enumerable:!0,configurable:!1,writable:!1},reloading:{get:()=>b.pendingFetch(),enumerable:!0,configurable:!1},jwks:{value:()=>b.jwks(),enumerable:!0,configurable:!1,writable:!1}}),c),{payload:g}=await dl(a,f,{issuer:e.issuer,audience:this.clientMetadata.client_id,algorithms:["RS256"],requiredClaims:["iat"]});return"sid"in g||"sub"in g?"sid"in g&&"string"!=typeof g.sid?[new P('"sid" claim must be a string'),null]:"sub"in g&&"string"!=typeof g.sub?[new P('"sub" claim must be a string'),null]:"nonce"in g?[new P('"nonce" claim is prohibited'),null]:"events"in g?"object"!=typeof g.events||null===g.events?[new P('"events" claim must be an object'),null]:"http://schemas.openid.net/event/backchannel-logout"in g.events?"object"!=typeof g.events["http://schemas.openid.net/event/backchannel-logout"]?[new P('"http://schemas.openid.net/event/backchannel-logout" member in the "events" claim must be an object'),null]:[null,{sid:g.sid,sub:g.sub}]:[new P('"http://schemas.openid.net/event/backchannel-logout" member is missing in the "events" claim'),null]:[new P('"events" claim is missing'),null]:[new P('either "sid" or "sub" (or both) claims must be present'),null]}async authorizationUrl(a){let[b,c]=await this.discoverAuthorizationServerMetadata();if(b)return[b,null];if(this.pushedAuthorizationRequests&&!c.pushed_authorization_request_endpoint)return console.error("The Auth0 tenant does not have pushed authorization requests enabled. Learn how to enable it here: https://auth0.com/docs/get-started/applications/configure-par"),[Error("The authorization server does not support pushed authorization requests."),null];let d=new URL(c.authorization_endpoint);if(this.pushedAuthorizationRequests){let b,e=await aR(c,this.clientMetadata,await this.getClientAuth(),a,{...this.httpOptions(),[ae]:this.fetch,[ab]:this.allowInsecureRequests});try{b=await a1(c,this.clientMetadata,e)}catch(a){return[new M({cause:new H({code:a.error,message:a.error_description}),message:"An error occurred while pushing the authorization request."}),null]}return d.searchParams.set("request_uri",b.request_uri),d.searchParams.set("client_id",this.clientMetadata.client_id),[null,d]}return d.search=a.toString(),[null,d]}async getClientAuth(){if(!this.clientSecret&&!this.clientAssertionSigningKey)throw Error("The client secret or client assertion signing key must be provided.");let a=this.clientAssertionSigningKey;return a&&"string"==typeof a&&(a=await cP(a,this.clientAssertionSigningAlg)),a?function(a,b){let{key:c,kid:d}=a instanceof CryptoKey?{key:a}:a?.key instanceof CryptoKey?(void 0!==a.kid&&ay(a.kid,'"kid"'),{key:a.key,kid:a.kid}):{};return aq(c,'"clientPrivateKey.key"'),async(a,b,e,f)=>{let g,h={alg:aD(c),kid:d},i=(g=aG()+aE(b),{jti:aB(),aud:a.issuer,exp:g+60,iat:g,nbf:g,iss:b.client_id,sub:b.client_id});e.set("client_id",b.client_id),e.set("client_assertion_type","urn:ietf:params:oauth:client-assertion-type:jwt-bearer"),e.set("client_assertion",await aK(h,i,c))}}(a):aJ(this.clientSecret)}get issuer(){return this.domain.startsWith("http://")||this.domain.startsWith("https://")?this.domain:`https://${this.domain}`}async getConnectionTokenSet(a,b,c){if(!a.refreshToken&&(!b||b.expiresAt<=Date.now()/1e3))return[new T(s.MISSING_REFRESH_TOKEN,"A refresh token was not present, Connection Access Token requires a refresh token. The user needs to re-authenticate."),null];if(a.refreshToken&&(!b||b.expiresAt<=Date.now()/1e3)){let b,d=new URLSearchParams;d.append("connection",c.connection);let e=c.subject_token_type??v.SUBJECT_TYPE_REFRESH_TOKEN,f=e===v.SUBJECT_TYPE_ACCESS_TOKEN?a.accessToken:a.refreshToken;d.append("subject_token_type",e),d.append("subject_token",f),d.append("requested_token_type","http://auth0.com/oauth/token-type/federated-connection-access-token"),c.login_hint&&d.append("login_hint",c.login_hint);let[g,h]=await this.discoverAuthorizationServerMetadata();if(g)return[g,null];let i=this.useDPoP&&this.dpopKeyPair?aU(this.clientMetadata,this.dpopKeyPair):void 0,j=async()=>bH(h,this.clientMetadata,await this.getClientAuth(),"urn:auth0:params:oauth:grant-type:token-exchange:federated-connection-access-token",d,{[ae]:this.fetch,[ab]:this.allowInsecureRequests,...i&&{DPoP:i}}),k=async()=>{let a=await j();return bI(h,this.clientMetadata,a)};try{b=await bZ(k,{isDPoPEnabled:!!(this.useDPoP&&this.dpopKeyPair),...this.dpopOptions?.retry})}catch(a){return[new T(s.FAILED_TO_EXCHANGE,"There was an error trying to exchange the refresh token for a connection access token.",new H({code:a.error,message:a.error_description})),null]}return[null,{accessToken:b.access_token,expiresAt:Math.floor(Date.now()/1e3)+Number(b.expires_in),scope:b.scope,connection:c.connection}]}return[null,b]}async finalizeSession(a,b){if(this.beforeSessionSaved)a={...await this.beforeSessionSaved(a,b??null),internal:a.internal};else{var c;a.user=Object.keys(c=a.user).reduce((a,b)=>(eJ.includes(b)&&(a[b]=c[b]),a),{})}return a}async connectAccount(a){let b=eM(this.routes.callback,this.appBaseUrl),c=this.signInReturnToPath;if(a.returnTo){let b=new URL(this.authorizationParameters.redirect_uri||this.appBaseUrl),d=ee(a.returnTo,b);d&&(c=d.pathname+d.search+d.hash)}let d=aB(),e=await aC(d),f=aB(),[g,h]=await this.createConnectAccountTicket({tokenSet:a.tokenSet,connection:a.connection,redirectUri:b.toString(),state:f,codeChallenge:e,codeChallengeMethod:"S256",scopes:a.scopes,authorizationParams:a.authorizationParams});if(g)return[g,null];let i={codeVerifier:d,responseType:w.CONNECT_CODE,state:f,returnTo:c,authSession:h.authSession},j=F.NextResponse.redirect(`${h.connectUri}?ticket=${encodeURIComponent(h.connectParams.ticket)}`);return await this.transactionStore.save(j.cookies,i),[null,j]}async createConnectAccountTicket(a){try{let b=new URL("/me/v1/connected-accounts/connect",this.issuer),c=await this.fetcherFactory({useDPoP:this.useDPoP,getAccessToken:async()=>({accessToken:a.tokenSet.accessToken,expiresAt:a.tokenSet.expiresAt||0,scope:a.tokenSet.scope,token_type:a.tokenSet.token_type}),fetch:this.fetch}),d=this.httpOptions();new Headers(d.headers).set("Content-Type","application/json");let e={connection:a.connection,redirect_uri:a.redirectUri,state:a.state,code_challenge:a.codeChallenge,code_challenge_method:a.codeChallengeMethod,scopes:a.scopes,authorization_params:a.authorizationParams},f=await c.fetchWithAuth(b.toString(),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!f.ok)return eP(f,u.FAILED_TO_INITIATE);let{connect_uri:g,connect_params:h,auth_session:i,expires_in:j}=await f.json();return[null,{connectUri:g,connectParams:h,authSession:i,expiresIn:j}]}catch(b){let a="An unexpected error occurred while trying to initiate the connect account flow.";return b instanceof U&&(a=b.message),[new W({code:u.FAILED_TO_INITIATE,message:a}),null]}}async completeConnectAccount(a){let b=new URL("/me/v1/connected-accounts/complete",this.issuer);try{let c=this.httpOptions();new Headers(c.headers).set("Content-Type","application/json");let d=await this.fetcherFactory({useDPoP:this.useDPoP,getAccessToken:async()=>({accessToken:a.tokenSet.accessToken,expiresAt:a.tokenSet.expiresAt||0,scope:a.tokenSet.scope,token_type:a.tokenSet.token_type}),fetch:this.fetch}),e={auth_session:a.authSession,connect_code:a.connectCode,redirect_uri:a.redirectUri,code_verifier:a.codeVerifier},f=await d.fetchWithAuth(b,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!f.ok)return eP(f,u.FAILED_TO_COMPLETE);let{id:g,connection:h,access_type:i,scopes:j,created_at:k,expires_at:l}=await f.json();return[null,{id:g,connection:h,accessType:i,scopes:j,createdAt:k,expiresAt:l}]}catch(a){return[new W({code:u.FAILED_TO_COMPLETE,message:"An unexpected error occurred while trying to complete the connect account flow."}),null]}}async getOpenIdClientConfig(){let[a,b]=await this.discoverAuthorizationServerMetadata();if(a)return[a,null];let c=new dZ(b,this.clientMetadata.client_id,{},await this.getClientAuth()),d=new Headers(this.httpOptions().headers);return c[ae]=(...a)=>{let b=new Headers(a[1].headers);return this.fetch(a[0],{...a[1],body:a[1].body,headers:new Headers([...d,...b])})},c.timeout=this.httpTimeout,this.allowInsecureRequests&&(i.get(c).tlsOnly=!1),[null,c]}async fetcherFactory(a){if(this.useDPoP&&!this.dpopKeyPair)throw new U(t.DPOP_CONFIGURATION_ERROR,"DPoP is enabled but no keypair is configured.");let[b,c]=await this.discoverAuthorizationServerMetadata();if(b)throw b;return new eI({dpopHandle:this.useDPoP&&(a.useDPoP??!0)?aU(this.clientMetadata,this.dpopKeyPair):void 0,httpOptions:this.httpOptions,allowInsecureRequests:this.allowInsecureRequests,retryConfig:this.dpopOptions?.retry,fetch:a.fetch,getAccessToken:a.getAccessToken,baseUrl:a.baseUrl},{getAccessToken:a.getAccessToken,isDpopEnabled:()=>a.useDPoP??this.useDPoP??!1})}}x=new WeakSet,y=function(a,b){var c;let d,e=a.tokenSet,f=b.audience,g=b.scope,h=!f||f===(e.audience||this.authorizationParameters.audience),i=!g||b1(e.requestedScope||b$(this.authorizationParameters.scope,f),g);return h&&i?e:(f&&(d=b3(a,{scope:g,audience:f})),c=d,{...e,accessToken:c?.accessToken,expiresAt:c?.expiresAt,scope:c?.scope,requestedScope:c?.requestedScope,audience:c?.audience,...c?.token_type&&{token_type:c.token_type}})},z=async function(a,b){let c=eb(a),d=ed(a,b);c.set("host",d.host);try{let a=await this.fetch(d.toString(),{method:"OPTIONS",headers:c});return new F.NextResponse(null,{status:a.status,headers:ec(a)})}catch(a){return new F.NextResponse(a.cause||a.message||"Preflight request failed",{status:500})}},A=async function(a,b){let c,d=await this.sessionStore.get(a.cookies);if(!d)return new F.NextResponse("The user does not have an active session.",{status:401});if("OPTIONS"===a.method&&a.headers.has("access-control-request-method"))return eK(this,x,"m",z).call(this,a,b);let e=eb(a),f=this.useDPoP?a.clone():a,g=ed(a,b);e.set("host",g.host);let h=f.body?await f.arrayBuffer():void 0,i=async a=>{let[b,e]=await this.getTokenSet(d,{audience:a.audience,scope:a.scope});if(b)throw b;return c=e,e.tokenSet},j=this.proxyFetchers[b.audience];j?j.getAccessToken=i:(j=await this.fetcherFactory({useDPoP:this.useDPoP,fetch:this.fetch,getAccessToken:i}),this.proxyFetchers[b.audience]=j);try{let i=await j.fetchWithAuth(g.toString(),{method:f.method,headers:e,body:h},{scope:b.scope,audience:b.audience}),k=new F.NextResponse(i.body,{status:i.status,statusText:i.statusText,headers:ec(i)});return c&&await eK(this,x,"m",B).call(this,a,k,d,c),k}catch(a){if(a instanceof S&&a.code===r.MISSING_REFRESH_TOKEN)return new F.NextResponse(a.message,{status:401});return new F.NextResponse(a.cause||a.message||"An error occurred while proxying the request.",{status:500})}},B=async function(a,b,c,d){let e=b5(c,d.tokenSet,{scope:this.authorizationParameters?.scope??X,audience:this.authorizationParameters?.audience});if(e){d.idTokenClaims&&(c.user=d.idTokenClaims);let f=await this.finalizeSession({...c,...e},d.tokenSet.idToken);await this.sessionStore.set(a.cookies,b.cookies,f),eG(b)}},C=async function(a,b){let c,[d,e]=await this.discoverAuthorizationServerMetadata();if(d)return[d,null];let f=new URLSearchParams;b.scope&&f.append("scope",b.scope),b.audience&&f.append("audience",b.audience);let g=this.useDPoP&&this.dpopKeyPair?aU(this.clientMetadata,this.dpopKeyPair):void 0,h=async()=>a9(e,this.clientMetadata,await this.getClientAuth(),a.refreshToken,{...this.httpOptions(),[ae]:this.fetch,[ab]:this.allowInsecureRequests,additionalParameters:f,...g&&{DPoP:g}}),i=a=>bf(e,this.clientMetadata,a);try{c=await bZ(async()=>{let a=await h();return await i(a)},{isDPoPEnabled:!!(this.useDPoP&&this.dpopKeyPair),...this.dpopOptions?.retry})}catch(a){return[new S(r.FAILED_TO_REFRESH_TOKEN,"The access token has expired and there was an error while trying to refresh it.",new H({code:a.error,message:a.error_description})),null]}let j=bc(c),k=Math.floor(Date.now()/1e3)+Number(c.expires_in),l={...a,accessToken:c.access_token,idToken:c.id_token,scope:c.scope,requestedScope:b.requestedScope,expiresAt:k,audience:a.audience||b.audience||void 0,...c.token_type&&{token_type:c.token_type}};return c.refresh_token?l.refreshToken=c.refresh_token:l.refreshToken=a.refreshToken,[null,{updatedTokenSet:l,idTokenClaims:j}]};let eO=a=>{let b=new TextEncoder().encode(a),c=[];for(let a=0;a<b.length;a+=32768)c.push(String.fromCharCode.apply(null,b.subarray(a,a+32768)));return btoa(c.join(""))};async function eP(a,b){let c=b===u.FAILED_TO_INITIATE?"initiate":"complete";try{let d=await a.json();return[new W({code:b,message:`The request to ${c} the connect account flow failed with status ${a.status}.`,cause:new V({type:d.type,title:d.title,detail:d.detail,status:a.status,validationErrors:d.validation_errors})}),null]}catch(d){return[new W({code:b,message:`The request to ${c} the connect account flow failed with status ${a.status}.`}),null]}}function eQ(a){if(a instanceof F.NextRequest)return a;let b=function(a){let b;try{let c=a.nextUrl;if(!c)return;"string"==typeof c.basePath&&c.basePath&&(b={basePath:c.basePath}),("string"==typeof c.locale||"string"==typeof c.defaultLocale)&&(b={...b||{},i18n:{locales:c.locale?[c.locale]:[],defaultLocale:c.defaultLocale}}),"boolean"==typeof c.trailingSlash&&(b={...b||{},trailingSlash:c.trailingSlash})}catch{}return b&&Object.keys(b).length?b:void 0}(a),c={method:a.method,headers:a.headers,body:a.body,duplex:a.duplex??"half"};return b&&(c.nextConfig=b),new F.NextRequest(a.url,c)}class eR{constructor({secret:a,rolling:b=!0,absoluteDuration:c=259200,inactivityDuration:d=86400,store:e,cookieOptions:f}){this.secret=a,this.rolling=b,this.absoluteDuration=c,this.inactivityDuration=d,this.store=e,this.sessionCookieName=f?.name??"__session",this.cookieConfig={httpOnly:!0,sameSite:f?.sameSite??"lax",secure:f?.secure??!1,path:f?.path??"/",domain:f?.domain,transient:f?.transient}}epoch(){return Date.now()/1e3|0}calculateMaxAge(a){if(!this.rolling)return this.absoluteDuration;let b=this.epoch(),c=Math.min(b+this.inactivityDuration,a+this.absoluteDuration)-b;return c>0?c:0}}let eS="appSession";function eT(a,b){let c=b.user;return{user:c,tokenSet:{idToken:b.idToken??void 0,accessToken:b.accessToken??void 0,scope:b.accessTokenScope,refreshToken:b.refreshToken,expiresAt:b.accessTokenExpiresAt},internal:{sid:c.sid,createdAt:a.iat}}}let eU=()=>{let a=new Uint8Array(16);return crypto.getRandomValues(a),Array.from(a).map(a=>a.toString(16).padStart(2,"0")).join("")};class eV extends eR{constructor({secret:a,store:b,rolling:c,absoluteDuration:d,inactivityDuration:e,cookieOptions:f}){super({secret:a,rolling:c,absoluteDuration:d,inactivityDuration:e,cookieOptions:f}),this.store=b}async get(a){let b=a.get(this.sessionCookieName)||a.get(eS);if(!b||!b.value)return null;let c=null;try{let a=await ey(b.value,this.secret);if(null===a)return null;c=a.payload.id}catch(a){if("ERR_JWE_INVALID"===a.code){let a=await ez(b.name,b.value,this.secret);if(!a)return null;c=a}}if(!c)return null;let d=await this.store.get(c);return d?d.header?.iat?eT(d.header,d.data):d:null}async set(a,b,c,d=!1){let e=null,f=a.get(this.sessionCookieName)?.value;if(f){let a=await ey(f,this.secret);a&&(e=a.payload.id)}e&&d&&(await this.store.delete(e),e=eU()),e||(e=eU());let g=this.calculateMaxAge(c.internal.createdAt),h=this.epoch(),i=await ex({id:e},this.secret,h+g);b.set(this.sessionCookieName,i.toString(),{...this.cookieConfig,maxAge:g}),await this.store.set(e,c),a.set(this.sessionCookieName,i.toString()),this.sessionCookieName!==eS&&a.has(eS)&&eH(b,eS,{domain:this.cookieConfig.domain,path:this.cookieConfig.path})}async delete(a,b){let c=a.get(this.sessionCookieName)?.value;if(eH(b,this.sessionCookieName,{domain:this.cookieConfig.domain,path:this.cookieConfig.path}),!c)return;let d=await ey(c,this.secret);d&&await this.store.delete(d.payload.id)}}class eW extends eR{constructor({secret:a,rolling:b,absoluteDuration:c,inactivityDuration:d,cookieOptions:e}){super({secret:a,rolling:b,absoluteDuration:c,inactivityDuration:d,cookieOptions:e}),this.connectionTokenSetsCookieName="__FC"}async get(a){let b=eE(this.sessionCookieName,a)??eE(eS,a,!0);if(!b)return null;let c=await ey(b,this.secret);if(!c)return null;let d=c.protectedHeader.iat?eT(c.protectedHeader,c.payload):c.payload,e=this.getConnectionTokenSetsCookies(a),f=[];for(let a of e){let b=await ey(a.value,this.secret);b&&f.push(b.payload)}return{...d,...f.length?{connectionTokenSets:f}:{}}}async set(a,b,c){let{connectionTokenSets:d,...e}=c,f=this.calculateMaxAge(c.internal.createdAt),g=this.epoch(),h=(await ex(e,this.secret,g+f)).toString(),i={...this.cookieConfig,maxAge:f};!function(a,b,c,d,e){let{transient:f,...g}=c,h={...g};if(f&&delete h.maxAge,new TextEncoder().encode(b).length<=3500){e.set(a,b,h),d.set(a,b),eD(d,a).forEach(a=>{eH(e,a.name,{path:h.path,domain:h.domain}),d.delete(a.name)});return}let i=0,j=0;for(;i<b.length;){let c=b.slice(i,i+3500),f=`${a}__${j}`;e.set(f,c,h),d.set(f,c),i+=3500,j++}let k=eD(d,a).length-j;if(k>0)for(let b=0;b<k;b++){let c=j+b,f=`${a}__${c}`;eH(e,f,{path:h.path,domain:h.domain}),d.delete(f)}eH(e,a,{path:h.path,domain:h.domain}),d.delete(a)}(this.sessionCookieName,h,i,a,b),d?.length&&await Promise.all(d.map((c,d)=>this.storeInCookie(a,b,c,`${this.connectionTokenSetsCookieName}_${d}`,f))),eE(eS,a,!0)&&eF(eS,a,b,!0,{domain:this.cookieConfig.domain,path:this.cookieConfig.path})}async delete(a,b){let c={domain:this.cookieConfig.domain,path:this.cookieConfig.path};eF(this.sessionCookieName,a,b,!1,c),this.getConnectionTokenSetsCookies(a).forEach(a=>eH(b,a.name,c))}async storeInCookie(a,b,c,d,e){let f=Math.floor(Date.now()/1e3+e),g=await ex(c,this.secret,f),h=g.toString();b.set(d,g.toString(),{...this.cookieConfig,maxAge:e}),a.set(d,h);let i=new ek(new Headers);i.set(d,h,{...this.cookieConfig,maxAge:e}),new TextEncoder().encode(i.toString()).length>=4096&&(d===this.sessionCookieName?console.warn(`The ${d} cookie size exceeds 4096 bytes, which may cause issues in some browsers. Consider removing any unnecessary custom claims from the access token or the user profile. Alternatively, you can use a stateful session implementation to store the session data in a data store.`):console.warn(`The ${d} cookie size exceeds 4096 bytes, which may cause issues in some browsers. You can use a stateful session implementation to store the session data in a data store.`))}getConnectionTokenSetsCookies(a){return a.getAll().filter(a=>a.name.startsWith(this.connectionTokenSetsCookieName))}}class eX{constructor({secret:a,cookieOptions:b,enableParallelTransactions:c}){this.secret=a,this.transactionCookiePrefix=b?.prefix??"__txn_",this.cookieOptions={httpOnly:!0,sameSite:b?.sameSite??"lax",secure:b?.secure??!1,path:b?.path??"/",domain:b?.domain,maxAge:b?.maxAge||3600},this.enableParallelTransactions=c??!0}getTransactionCookieName(a){return this.enableParallelTransactions?`${this.transactionCookiePrefix}${a}`:`${this.transactionCookiePrefix}`}getCookiePrefix(){return this.transactionCookiePrefix}async save(a,b,c){if(!b.state)throw Error("Transaction state is required");if(c&&!this.enableParallelTransactions){let a=this.getTransactionCookieName(b.state);if(c.get(a))return void console.warn("A transaction is already in progress. Only one transaction is allowed when parallel transactions are disabled.")}let d=this.cookieOptions.maxAge,e=Math.floor(Date.now()/1e3+d),f=await ex(b,this.secret,e);a.set(this.getTransactionCookieName(b.state),f.toString(),this.cookieOptions)}async get(a,b){let c=this.getTransactionCookieName(b),d=a.get(c)?.value;return d?ey(d,this.secret):null}async delete(a,b){eH(a,this.getTransactionCookieName(b),{domain:this.cookieOptions.domain,path:this.cookieOptions.path})}async deleteAll(a,b){let c=this.getCookiePrefix(),d={domain:this.cookieOptions.domain,path:this.cookieOptions.path};a.getAll().forEach(a=>{a.name.startsWith(c)&&eH(b,a.name,d)})}}var eY=function(a,b,c,d,e){if("m"===d)throw TypeError("Private method is not writable");if("a"===d&&!e)throw TypeError("Private accessor was defined without a setter");if("function"==typeof b?a!==b||!e:!b.has(a))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===d?e.call(a,c):e?e.value=c:b.set(a,c),c},eZ=function(a,b,c,d){if("a"===c&&!d)throw TypeError("Private accessor was defined without a getter");if("function"==typeof b?a!==b||!d:!b.has(a))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===c?d:"a"===c?d.call(a):d?d.value:b.get(a)};D=new WeakMap;let e$=new class{constructor(a={}){D.set(this,void 0),eY(this,D,a,"f");const{domain:b,clientId:c,clientSecret:d,appBaseUrl:e,secret:f,clientAssertionSigningKey:g}=this.validateAndExtractRequiredOptions(a);this.domain=b;const h=a.clientAssertionSigningAlg||process.env.AUTH0_CLIENT_ASSERTION_SIGNING_ALG,{dpopKeyPair:i,dpopOptions:j}=function(a){let b=a.useDPoP||!1;if(!b)return{dpopKeyPair:void 0,dpopOptions:void 0};let c=a.dpopOptions?.clockTolerance??(process.env.AUTH0_DPOP_CLOCK_TOLERANCE?parseInt(process.env.AUTH0_DPOP_CLOCK_TOLERANCE,10):30);if(c>300){let a=process.env.AUTH0_DPOP_CLOCK_TOLERANCE_MAX_PROD?parseInt(process.env.AUTH0_DPOP_CLOCK_TOLERANCE_MAX_PROD,10):300;if(c>a)throw Error(`clockTolerance of ${c}s exceeds maximum allowed ${a}s in production. This could significantly weaken DPoP replay attack protection. Set AUTH0_DPOP_CLOCK_TOLERANCE_MAX_PROD environment variable to override this limit in production.`);console.warn(`WARNING: clockTolerance of ${c}s exceeds recommended maximum of 300s. This may weaken DPoP security by allowing replay attacks within a wider time window. Consider synchronizing server clocks using NTP instead of increasing tolerance.`)}let d={clockSkew:a.dpopOptions?.clockSkew??(process.env.AUTH0_DPOP_CLOCK_SKEW?parseInt(process.env.AUTH0_DPOP_CLOCK_SKEW,10):0),clockTolerance:c,retry:{delay:a.dpopOptions?.retry?.delay??(process.env.AUTH0_RETRY_DELAY?parseInt(process.env.AUTH0_RETRY_DELAY,10):100),jitter:a.dpopOptions?.retry?.jitter??(!process.env.AUTH0_RETRY_JITTER||"true"===process.env.AUTH0_RETRY_JITTER)}};if(d.retry&&"number"==typeof d.retry.delay&&d.retry.delay<0)throw Error("Retry delay must be non-negative");if(a.dpopKeyPair)return{dpopKeyPair:a.dpopKeyPair,dpopOptions:d};if(b){let a=process.env.AUTH0_DPOP_PRIVATE_KEY,b=process.env.AUTH0_DPOP_PUBLIC_KEY;if(bX()&&(a||b))return console.warn("WARNING: Running in Edge Runtime environment. DPoP keypair loading from environment variables is not supported due to limited Node.js crypto API access. DPoP has been disabled. To use DPoP in Edge Runtime, provide a pre-generated keypair via the dpopKeyPair option."),{dpopKeyPair:void 0,dpopOptions:void 0};if(a&&b)try{let c=(0,Y.createPrivateKey)(a),e=(0,Y.createPublicKey)(b);if("ec"!==c.asymmetricKeyType)throw Error(`DPoP private key must be an Elliptic Curve key for ES256 algorithm, got: ${c.asymmetricKeyType}`);if("ec"!==e.asymmetricKeyType)throw Error(`DPoP public key must be an Elliptic Curve key for ES256 algorithm, got: ${e.asymmetricKeyType}`);let f=c.asymmetricKeyDetails,g=e.asymmetricKeyDetails;if(f?.namedCurve!=="prime256v1")throw Error(`DPoP private key must use P-256 curve (prime256v1) for ES256 algorithm, got: ${f?.namedCurve}`);if(g?.namedCurve!=="prime256v1")throw Error(`DPoP public key must use P-256 curve (prime256v1) for ES256 algorithm, got: ${g?.namedCurve}`);if(!function(a,b){if(bX())return!0;try{let c="test-data-for-key-pair-validation",d=(0,Y.createSign)("sha256");d.update(c);let e=d.sign(a),f=(0,Y.createVerify)("sha256");if(f.update(c),!f.verify(b,e))return console.warn("WARNING: Private and public keys do not form a valid key pair - signature verification failed. Please ensure the keys are properly paired and in the correct format. DPoP will be disabled and bearer authentication will be used instead."),!1;return!0}catch(a){return console.warn(`WARNING: Failed to validate key pair compatibility. This may indicate invalid key format, mismatched algorithms, or corrupted key data. DPoP will be disabled and bearer authentication will be used instead. Error: ${a instanceof Error?a.message:String(a)}`),!1}}(c,e))return console.warn("WARNING: DPoP key pair validation failed. DPoP has been completely disabled. Falling back to bearer authentication. Please verify your key pair configuration."),{dpopKeyPair:void 0,dpopOptions:void 0};let h=c.toCryptoKey("ES256",!1,["sign"]),i=e.toCryptoKey("ES256",!1,["verify"]);return{dpopKeyPair:{privateKey:h,publicKey:i},dpopOptions:d}}catch(a){console.warn(`WARNING: Failed to load DPoP keypair from environment variables. Please ensure AUTH0_DPOP_PUBLIC_KEY and AUTH0_DPOP_PRIVATE_KEY contain valid ES256 keys in PEM format. Error: ${a instanceof Error?a.message:String(a)}`)}a&&b||console.warn("WARNING: useDPoP is set to true but dpopKeyPair is not provided. DPoP will not be used and protected requests will use bearer authentication instead. To enable DPoP, provide a dpopKeyPair in the Auth0Client options or set AUTH0_DPOP_PUBLIC_KEY and AUTH0_DPOP_PRIVATE_KEY environment variables.")}return{dpopKeyPair:void 0,dpopOptions:d}}(a),k=process.env.NEXT_PUBLIC_BASE_PATH,l={name:a.session?.cookie?.name??"__session",secure:a.session?.cookie?.secure??"true"===process.env.AUTH0_COOKIE_SECURE,sameSite:a.session?.cookie?.sameSite??process.env.AUTH0_COOKIE_SAME_SITE??"lax",path:a.session?.cookie?.path??process.env.AUTH0_COOKIE_PATH??k??"/",transient:a.session?.cookie?.transient??"true"===process.env.AUTH0_COOKIE_TRANSIENT,domain:a.session?.cookie?.domain??process.env.AUTH0_COOKIE_DOMAIN},m={prefix:a.transactionCookie?.prefix??"__txn_",secure:a.transactionCookie?.secure??!1,sameSite:a.transactionCookie?.sameSite??"lax",path:a.transactionCookie?.path??k??"/",maxAge:a.transactionCookie?.maxAge??3600};if(e){const{protocol:a}=new URL(e);"https:"===a&&(l.secure=!0,m.secure=!0)}this.routes={login:process.env.NEXT_PUBLIC_LOGIN_ROUTE||"/auth/login",logout:"/auth/logout",callback:"/auth/callback",backChannelLogout:"/auth/backchannel-logout",profile:process.env.NEXT_PUBLIC_PROFILE_ROUTE||"/auth/profile",accessToken:process.env.NEXT_PUBLIC_ACCESS_TOKEN_ROUTE||"/auth/access-token",connectAccount:"/auth/connect",...a.routes},this.transactionStore=new eX({secret:f,cookieOptions:m,enableParallelTransactions:a.enableParallelTransactions??!0}),this.sessionStore=a.sessionStore?new eV({...a.session,secret:f,store:a.sessionStore,cookieOptions:l}):new eW({...a.session,secret:f,cookieOptions:l}),this.authClient=new eN({transactionStore:this.transactionStore,sessionStore:this.sessionStore,domain:b,clientId:c,clientSecret:d,clientAssertionSigningKey:g,clientAssertionSigningAlg:h,authorizationParameters:a.authorizationParameters,pushedAuthorizationRequests:a.pushedAuthorizationRequests,appBaseUrl:e,secret:f,signInReturnToPath:a.signInReturnToPath,logoutStrategy:a.logoutStrategy,includeIdTokenHintInOIDCLogoutUrl:a.includeIdTokenHintInOIDCLogoutUrl,beforeSessionSaved:a.beforeSessionSaved,onCallback:a.onCallback,routes:this.routes,allowInsecureRequests:a.allowInsecureRequests,httpTimeout:a.httpTimeout,enableTelemetry:a.enableTelemetry,enableAccessTokenEndpoint:a.enableAccessTokenEndpoint,noContentProfileResponseWhenUnauthenticated:a.noContentProfileResponseWhenUnauthenticated,enableConnectAccountEndpoint:a.enableConnectAccountEndpoint,useDPoP:a.useDPoP||!1,dpopKeyPair:a.dpopKeyPair||i,dpopOptions:a.dpopOptions||j})}middleware(a){return this.authClient.handler.bind(this.authClient)(eQ(a))}async getSession(a){if(a){if(a instanceof Request){let b=eQ(a);return this.sessionStore.get(b.cookies)}return this.sessionStore.get(this.createRequestCookies(a))}return this.sessionStore.get(await (0,E.cookies)())}async getAccessToken(a,b,c){let d,e,f={refresh:!1},g={};if(a&&(a instanceof Request||"object"==typeof a.headers)){if(d=a,e=b,g={...f,...c??{}},!e)throw TypeError("getAccessToken(req, res): The 'res' argument is missing. Both 'req' and 'res' must be provided together for Pages Router or middleware usage.")}else{if(void 0!==b||void 0!==c)throw TypeError("getAccessToken: Invalid arguments. Valid signatures are getAccessToken(), getAccessToken(options), or getAccessToken(req, res, options).");g={...f,...a??{}}}return this.executeGetAccessToken(d,e,g)}async executeGetAccessToken(a,b,c){let d=a?await this.getSession(a):await this.getSession();if(!d)throw new S(r.MISSING_SESSION,"The user does not have an active session.");let[e,f]=await this.authClient.getTokenSet(d,c);if(e)throw e;let{tokenSet:g,idTokenClaims:h}=f,i=b5(d,g,{scope:eZ(this,D,"f").authorizationParameters?.scope??X,audience:eZ(this,D,"f").authorizationParameters?.audience});if(i){h&&(d.user=h);let c=await this.authClient.finalizeSession({...d,...i},g.idToken);await this.saveToSession(c,a,b)}return{token:g.accessToken,scope:g.scope,expiresAt:g.expiresAt,token_type:g.token_type,audience:g.audience}}async getAccessTokenForConnection(a,b,c){let d=b instanceof Request?eQ(b):b,e=d?await this.getSession(d):await this.getSession();if(!e)throw new T(s.MISSING_SESSION,"The user does not have an active session.");let f=e.connectionTokenSets?.find(b=>b.connection===a.connection),[g,h]=await this.authClient.getConnectionTokenSet(e.tokenSet,f,a);if(null!==g)throw g;if(h&&(!f||h.accessToken!==f.accessToken||h.expiresAt!==f.expiresAt||h.scope!==f.scope)){let b;b=f?e.connectionTokenSets?.map(b=>b.connection===a.connection?h:b):[...e.connectionTokenSets||[],h],await this.saveToSession({...e,connectionTokenSets:b},d,c)}return{token:h.accessToken,scope:h.scope,expiresAt:h.expiresAt}}async updateSession(a,b,c){if(a instanceof Request&&!(a instanceof F.NextRequest)&&(a=eQ(a)),b&&b instanceof Response&&!(b instanceof F.NextResponse)&&(b=function(a){if(a instanceof F.NextResponse)return a;let b=new Headers(a.headers),c=new F.NextResponse(a.body,{status:a.status,statusText:a.statusText,headers:b});try{"url"in a&&a.url&&(c.url=a.url)}catch{}return c}(b)),b){let d=a;if(!c)throw Error("The session data is missing.");if(d instanceof F.NextRequest&&b instanceof F.NextResponse){let a=await this.getSession(d);if(!a)throw Error("The user is not authenticated.");await this.sessionStore.set(d.cookies,b.cookies,{...c,internal:{...a.internal}})}else{let a=await this.getSession(d);if(!a)throw Error("The user is not authenticated.");let e=new Headers,f=new ek(e),g=this.createRequestCookies(d),h=b;await this.sessionStore.set(g,f,{...c,internal:{...a.internal}});let i=[],j={};for(let[a,b]of e.entries())"set-cookie"===a.toLowerCase()?i.push(b):j[a]=b;for(let[a,b]of(i.length>0&&h.setHeader("set-cookie",i),Object.entries(j)))h.setHeader(a,b)}}else{let b=await this.getSession();if(!b)throw Error("The user is not authenticated.");let c=a;if(!c)throw Error("The session data is missing.");await this.sessionStore.set(await (0,E.cookies)(),await (0,E.cookies)(),{...c,internal:{...b.internal}})}}createRequestCookies(a){let b=new Headers;for(let c in a.headers)if(Array.isArray(a.headers[c]))for(let d of a.headers[c])b.append(c,d);else b.append(c,a.headers[c]??"");return new ej(b)}async startInteractiveLogin(a={}){return this.authClient.startInteractiveLogin(a)}async getTokenByBackchannelAuth(a){let[b,c]=await this.authClient.backchannelAuthentication(a);if(b)throw b;return c}async connectAccount(a){if(!await this.getSession())throw new W({code:u.MISSING_SESSION,message:"The user does not have an active session."});let b={audience:`${this.issuer}/me/`,scope:"create:me:connected_accounts"},c=await this.getAccessToken(b),[d,e]=await this.authClient.connectAccount({...a,tokenSet:{accessToken:c.token,expiresAt:c.expiresAt,scope:b.scope,audience:c.audience}});if(d)throw d;return e}withPageAuthRequired(b,c){let d,e,f={loginUrl:this.routes.login},g=(d=this,(b,c={})=>async e=>{let g=await d.getSession();if(!g?.user){let b="function"==typeof c.returnTo?await c.returnTo(e):c.returnTo,{redirect:d}=await a.A(502583);d(`${f.loginUrl}${b?`?returnTo=${encodeURIComponent(b)}`:""}`)}return b(e)}),h=(e=this,({getServerSideProps:a,returnTo:b}={})=>async c=>{let d=await e.getSession(c.req);if(!d?.user)return{redirect:{destination:`${f.loginUrl}?returnTo=${encodeURIComponent(b||c.resolvedUrl)}`,permanent:!1}};let g={props:{}};if(a&&(g=await a(c)),g.props instanceof Promise){let a=await g.props;return{...g,props:{user:d.user,...a}}}return{...g,props:{user:d.user,...g.props}}});return"function"==typeof b?g(b,c):h(b)}withApiAuthRequired(a){let b,c,d=(b=this,a=>async(c,d)=>{let e=await b.getSession(c);e&&e.user?await a(c,d):d.status(401).json({error:"not_authenticated",description:"The user does not have an active session or is not authenticated"})}),e=(c=this,a=>async(b,d)=>{let e=b instanceof Request?eQ(b):b,f=await c.getSession();if(!f||!f.user)return F.NextResponse.json({error:"not_authenticated",description:"The user does not have an active session or is not authenticated"},{status:401});let g=await a(e,d);return g instanceof F.NextResponse?g:new F.NextResponse(g.body,g)});return(b,c)=>b instanceof Request||b.headers instanceof Headers||"boolean"==typeof b.bodyUsed?e(a)(b,c):d(a)(b,c)}async saveToSession(a,b,c){if(b&&c)if(b instanceof F.NextRequest&&c instanceof F.NextResponse)await this.sessionStore.set(b.cookies,c.cookies,a);else{let d=new Headers,e=new ek(d);for(let f of(await this.sessionStore.set(this.createRequestCookies(b),e,a),d.getSetCookie()))c.appendHeader("set-cookie",f);for(let[a,b]of d.entries())"set-cookie"!==a.toLowerCase()&&c.setHeader(a,b)}else try{await this.sessionStore.set(await (0,E.cookies)(),await (0,E.cookies)(),a)}catch(a){}}validateAndExtractRequiredOptions(a){let b={domain:a.domain??process.env.AUTH0_DOMAIN,clientId:a.clientId??process.env.AUTH0_CLIENT_ID,appBaseUrl:a.appBaseUrl??process.env.APP_BASE_URL,secret:a.secret??process.env.AUTH0_SECRET},c=a.clientSecret??process.env.AUTH0_CLIENT_SECRET,d=a.clientAssertionSigningKey??process.env.AUTH0_CLIENT_ASSERTION_SIGNING_KEY,e=Object.entries(b).filter(([,a])=>!a).map(([a])=>a);if(c||d||e.push("clientAuthentication"),e.length){let a={domain:"AUTH0_DOMAIN",clientId:"AUTH0_CLIENT_ID",appBaseUrl:"APP_BASE_URL",secret:"AUTH0_SECRET"},b="WARNING: Not all required options were provided when creating an instance of Auth0Client. Ensure to provide all missing options, either by passing it to the Auth0Client constructor, or by setting the corresponding environment variable.\n";e.forEach(c=>{"clientAuthentication"===c?b+=`Missing: clientAuthentication: Set either AUTH0_CLIENT_SECRET env var or AUTH0_CLIENT_ASSERTION_SIGNING_KEY env var, or pass clientSecret or clientAssertionSigningKey in options
`:a[c]?b+=`Missing: ${c}: Set ${a[c]} env var or pass ${c} in options
`:b+=`Missing: ${c}
`}),console.error(b.trim())}return{...b,clientSecret:c,clientAssertionSigningKey:d}}async createFetcher(a,b){let c=a instanceof Request?eQ(a):a,d=c?await this.getSession(c):await this.getSession();if(!d)throw new S(r.MISSING_SESSION,"The user does not have an active session.");let e=async a=>{let[b,c]=await this.authClient.getTokenSet(d,a||{});if(b)throw b;return c.tokenSet};return await this.authClient.fetcherFactory({...b,getAccessToken:e})}get issuer(){return this.domain.startsWith("http://")||this.domain.startsWith("https://")?this.domain:`https://${this.domain}`}};a.s(["auth0",0,e$],157377)}];

//# sourceMappingURL=_f807bb83._.js.map